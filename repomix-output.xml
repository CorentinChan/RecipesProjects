This file is a merged representation of a subset of the codebase, containing specifically included files, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: RecipeProjectjsreact/backend/app.js, recipeProjectHTML/frontend/script.js, recipeProjectHTML/frontend/contact.html, recipeProjectHTML/frontend/home.html, recipeProjectHTML/frontend/login.html, recipeProjectHTML/frontend/recipe.html, recipeProjectHTML/frontend/recipeForm.html, recipeProjectHTML/frontend/searchtool.html, recipe-reactnode-app/src/App.css, recipe-reactnode-app/src/styleResp.css, recipe-reactnode-app/src/components/nav.jsx, recipe-reactnode-app/src/components/recipe/commentaires.jsx, recipe-reactnode-app/src/test/test-card.test.jsx, recipe-reactnode-app/src/test/test-nav.test.jsx, recipe-reactnode-app/src/components/signup.jsx, recipe-reactnode-app/src/components/account/modalPassword.jsx, recipe-reactnode-app/src/components/account/profil.jsx, recipe-reactnode-app/src/components/account/recipesList.jsx, recipe-reactnode-app/src/components/home/homeNav.jsx, recipe-reactnode-app/src/components/home/subscribe.jsx, RecipeProjectjs/backend/node1.js, RecipeProjectjs/frontend/account.ejs, RecipeProjectjs/frontend/contact.ejs, RecipeProjectjs/frontend/home.ejs, RecipeProjectjs/frontend/login.ejs, RecipeProjectjs/backend/copyDBMeal.js, recipe-reactnode-app/src/components/signin.jsx
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
recipe-reactnode-app/src/App.css
recipe-reactnode-app/src/components/account/modalPassword.jsx
recipe-reactnode-app/src/components/account/profil.jsx
recipe-reactnode-app/src/components/account/recipesList.jsx
recipe-reactnode-app/src/components/home/homeNav.jsx
recipe-reactnode-app/src/components/home/subscribe.jsx
recipe-reactnode-app/src/components/nav.jsx
recipe-reactnode-app/src/components/recipe/commentaires.jsx
recipe-reactnode-app/src/components/signin.jsx
recipe-reactnode-app/src/components/signup.jsx
recipe-reactnode-app/src/styleResp.css
recipe-reactnode-app/src/test/test-card.test.jsx
recipe-reactnode-app/src/test/test-nav.test.jsx
recipeProjectHTML/frontend/contact.html
recipeProjectHTML/frontend/home.html
recipeProjectHTML/frontend/login.html
recipeProjectHTML/frontend/recipe.html
recipeProjectHTML/frontend/recipeForm.html
recipeProjectHTML/frontend/script.js
recipeProjectHTML/frontend/searchtool.html
RecipeProjectjs/backend/copyDBMeal.js
RecipeProjectjs/frontend/account.ejs
RecipeProjectjs/frontend/contact.ejs
RecipeProjectjs/frontend/home.ejs
RecipeProjectjs/frontend/login.ejs
RecipeProjectjsreact/backend/app.js
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="recipe-reactnode-app/src/components/account/modalPassword.jsx">
import { useState } from "react";

  import { useNavigate } from "react-router-dom";
  import axios from 'axios';


export default function ModalPassword({ user, userRole }) {
  const [currentPassword,setCurrentPassword]=useState("");
  const [newPassword,setNewPassword]=useState("");
  const [newPassword2,setNewPassword2]=useState("");
  const [message,setMessage]=useState("");

  
  async function handleSubmit(){
    console.log(currentPassword);
    let passwordNew=newPassword;
    let passwordNew2=newPassword2;
    let passwordCurrent=currentPassword;

    try {
        const { data } = await axios.post(
          import.meta.env.VITE_API_URL + "/changePassword",
          {
            passwordNew,
            passwordNew2,
            passwordCurrent,
          },
          {
            headers: {"Content-Type": "application/json",},
            withCredentials: true,
          }
        );

        setMessage(data.message);
        console.log("Réponse backend :", data);

        // if (data.succeed) {
        //   //setUser(data.pseudo);
        //   console.log("succed")
        //   navigate("/account"); 
        // }
      } catch (error) {
        console.error("Erreur lors de la connexion :", error);
         setMessage(error.response?.data?.message || "Erreur réseau");
      }
    }
  

  return (
    <div>
                <button type="button" className=" bg-transparent border-0" data-bs-toggle="modal" 
                data-bs-target="#passwordModal">
              
                  <div className="logo1  p-3  px-lg-3 align-items-center text-center border-end">
                    <i className="fa-solid fa-key fs-3"></i>
                    <p className="m-0 p-0">Change password</p>
                  </div>
              
                </button>
      {/* Modal */}
      <div className="modal fade mt-5" id="passwordModal" tabIndex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div className="modal-dialog">
          <div className="modal-content">
            <div className="modal-header">
              <h5 className="modal-title" id="exampleModalLabel">Modify your password</h5>
              <button type="button" className="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="changePasswordForm" onSubmit={handleSubmit}>
              <div className="modal-body d-flex flex-column align-items-center">
                {/* current password */}
                <label className="form-label">Current password</label>
                <input type="password" className="form-control form-control-sm mb-5 p-2 w-75" minLength="4" 
                name="passwordCurrent" value={currentPassword} onChange={(e)=>setCurrentPassword(e.target.value)} />
                {/* new password */}
                <label className="form-label">New password</label>
                <input type="password" className="form-control form-control-sm mb-5 p-2 w-75" minLength="4" 
                name="passwordNew" value={newPassword} onChange={(e)=>setNewPassword(e.target.value)}/>
                {/* check password */}
                <label className="form-label">Retype password</label>
                <input type="password" className="form-control form-control-sm mb-5 p-2 w-75" minLength="4" 
                name="passwordNew2" value={newPassword2} onChange={(e)=>setNewPassword2(e.target.value)}/>
              </div>
            </form>
                    <p className="text-center  text-info">{message}</p>
            <div className="modal-footer">
              <button type="button" className="btn btn-secondary" data-bs-dismiss="modal" >Close</button>
              <button type="button" className="btn btn-primary" 
              id="changePasswordButton" onClick={handleSubmit}>Change password</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="recipe-reactnode-app/src/components/home/subscribe.jsx">
export default function  Subscribe() {

return ( 
  <div className="subscribeSection">

        <div className="container p-2 p-lg-5 border rounded-4 shadow-sm bg-danger mx-2 w-lg-100 ">

          <h4 className="mx-0 py-2 px-0 mx-lg-5 px-lg-5 text-white text-center">
            Be the first to know about the latest deal, receive new trending recipes & more
          </h4>

    <form className="d-flex   content-center ">
      <div className=" d-lg-flex w-100 w-lg-75 mx-auto">

              <input type="text" className="form-control rounded-pill bg-danger border border-white text-white"  id="mail"
                placeholder="e-mail address" />

              <button  type="button"  className="btn mx-3 fs-5 px-3 rounded-pill"  >
                Subscribe
              </button>

            </div>
          </form>
        </div>
      </div>
)
 }
</file>

<file path="recipe-reactnode-app/src/components/signup.jsx">
import { useState,useRef } from "react";
import { useNavigate } from "react-router-dom";
import { useStore } from "../store/store";

import axios from 'axios';

export default function Signup({setShowSignup}) {
const navigate=useNavigate();
const [message,setMessage]=useState("");
let mailInput= useRef("");
let passwordInput= useRef("");
let pseudoInput=useRef('');
function overlayClick() {
setShowSignup(false);
}

async function handleSubmit(e){
e.preventDefault();
console.log(mailInput.current.value);

let  mail=mailInput.current.value;
let pseudo=pseudoInput.current.value;
let password=passwordInput.current.value;

      try {
        const { data } = await axios.post(
          import.meta.env.VITE_API_URL + "/signup",
          {
            mail,
            pseudo,
            password,
          },
          {
            headers: {"Content-Type": "application/json",},
            withCredentials: true,
          }
        );

        setMessage(data.message);
        console.log("Réponse backend :", data);

        if (data.succeed) {
          //setUser(data.pseudo);
          console.log("succed")
          navigate("/account"); 
        }
      } catch (error) {
        console.error("Erreur lors de la connexion :", error);
         setMessage(error.response?.data?.message || "Erreur réseau");
      }
      

}

  return (
<div class="overlay" id="overlay2" onClick={overlayClick}>
    <div className="container signup"   >
      
      <button
        type="button"
        className="btn btnAc text-center btn-danger border p-1 btnClose2"
        aria-label="Close"
        onClick={()=>setShowSignup(false)}    >
        X
      </button>

      <div className="p-4 bg-danger border text-white rounded-5" onClick={(e) => e.stopPropagation()}>

        <form className="contactForm" onSubmit={handleSubmit}>
          <div className="mx-auto text-center text-grey formAlign">

            <h2 className="text-center m-3 fw-bold pt-2">Sign up</h2>

            <a href="/signin" className="text-center m-3">
              Have already an account? Click here to connect!
            </a>

            <h5 className="text-center m-3">
              Join us and add your own recipes and many more!
            </h5>

            {/* Email */}
            <label htmlFor="signupMail" className="form-label text-grey fs-4 me-3">
              Email
            </label>
            <input
              type="email"  id="signupMail"   placeholder="tom@company.com" ref={mailInput} 
              className="form-control rounded-pill text-black bg-white border border-grey text-center"
            />

            {/* Pseudo */}
            <label htmlFor="signupPseudo" className="form-label text-grey fs-4 me-3 mt-3">
              Pseudo
            </label>
            <input
              type="text"   id="signupPseudo"  placeholder="JohnDoe" ref={pseudoInput} 
              className="form-control text-center text-black w-50 rounded-pill bg-white border border-grey"            
            />

            {/* Password */}
            <label htmlFor="signupPassword" className="form-label fs-4 me-3 mt-3"> 
              Password
            </label>
            <input
              type="password" id="signupPassword"  placeholder="Min 4 characters" ref={passwordInput} 
              minLength={4}
              className="form-control text-center text-black w-50 rounded-pill bg-white border border-grey"
            />
          </div>

          <div className="text-center">
            <button type="submit" className="btn btnAc mx-3 fs-5 px-3 mt-3 btn-warning rounded-pill">
              Sign up!
            </button>
          </div>

        </form>
                    <p className="text-center mt-2 text-info">{message}</p>

      </div>
    </div>
</div>
  );
}
</file>

<file path="recipe-reactnode-app/src/test/test-card.test.jsx">
import { describe, it, expect, vi } from 'vitest';
import { render, screen } from "@testing-library/react";
import React from 'react';

import "@testing-library/jest-dom";
import Card from "../components/Card";

global.React = React; 

const mockNavigate = vi.fn();
vi.mock("react-router-dom", () => ({
  useNavigate: () => mockNavigate,
}));

it("affiche le titre, l'image et l'id", () => {
  render(<Card id="10" title="Hello World" img="test.jpg" />);

  // test title
  expect(screen.getByText("Hello World")).toBeInTheDocument();

  // Image (alt="Card 1" )
  const img = screen.getByAltText("Card 1");
  expect(img).toBeInTheDocument();
  expect(img).toHaveAttribute("src", "test.jpg");

  // ID via testid
  expect(screen.getByTestId("card-10")).toBeInTheDocument();
});

it("navigate click", () => {
  render(<Card id="10" title="Hello World" img="test.jpg" />);

  const card = screen.getByTestId("card-10");
  card.click();

  expect(mockNavigate).toHaveBeenCalledWith("/recipe?id=10");
});
</file>

<file path="recipe-reactnode-app/src/test/test-nav.test.jsx">
import { describe, it, expect, vi, beforeEach } from 'vitest';
import { render, screen, fireEvent, waitFor } from "@testing-library/react";
import React from 'react';
import { MemoryRouter } from 'react-router-dom';
import Nav from "../components/Nav"; // Vérifie bien le chemin
import "@testing-library/jest-dom";

// 1. Mock de window.matchMedia (indispensable pour la ligne 20 de ton composant)
Object.defineProperty(window, 'matchMedia', {
  writable: true,
  value: vi.fn().mockImplementation(query => ({
    matches: false,
    media: query,
    onchange: null,
    addListener: vi.fn(),
    removeListener: vi.fn(),
    addEventListener: vi.fn(),
    removeEventListener: vi.fn(),
    dispatchEvent: vi.fn(),
  })),
});

// 2. Mock de Zustand (le store)
const mockSetUser = vi.fn();
vi.mock("../store/store", () => ({
  useStore: vi.fn((selector) => {
    const state = {
      user: "Jean", // On simule un utilisateur connecté par défaut
      setUser: mockSetUser
    };
    return selector(state);
  }),
}));

// Mock de useNavigate et import.meta.env
const mockNavigate = vi.fn();
vi.mock("react-router-dom", async () => {
  const actual = await vi.importActual("react-router-dom");
  return {
    ...actual,
    useNavigate: () => mockNavigate,
  };
});

// Mock de fetch global
global.fetch = vi.fn();

describe("Composant Nav", () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  it("affiche les liens de navigation principaux", () => {
    render(
      <MemoryRouter>
        <Nav />
      </MemoryRouter>
    );

    // Vérifie les titres issus de ton tableau pathTab
    expect(screen.getByText("Home")).toBeInTheDocument();
    expect(screen.getByText("Recipe")).toBeInTheDocument();
    expect(screen.getByText("Search")).toBeInTheDocument();
    expect(screen.getByText("Contact")).toBeInTheDocument();
  });

  it("affiche le nom de l'utilisateur quand il est connecté", () => {
    render(
      <MemoryRouter>
        <Nav />
      </MemoryRouter>
    );

    // On a mocké l'utilisateur "Jean" dans Zustand
    expect(screen.getByText("Jean")).toBeInTheDocument();
    expect(screen.queryByText("Sign in")).not.toBeInTheDocument();
  });

  it("appelle la fonction logout et redirige lors du clic sur Sign out", async () => {
    // Mock de la réponse fetch réussie
    fetch.mockResolvedValueOnce({
      json: async () => ({ succeed: true }),
    });

    render(
      <MemoryRouter>
        <Nav />
      </MemoryRouter>
    );

    const logoutBtn = screen.getByRole('button', { name: /logout/i });
    fireEvent.click(logoutBtn);

    await waitFor(() => {
      // Vérifie que fetch a été appelé vers la bonne URL (mock import.meta.env géré par Vitest)
      expect(fetch).toHaveBeenCalled();
      // Vérifie que l'utilisateur est réinitialisé dans le store
      expect(mockSetUser).toHaveBeenCalledWith("");
      // Vérifie la redirection
      expect(mockNavigate).toHaveBeenCalledWith("/");
    });
  });

  
});
</file>

<file path="recipeProjectHTML/frontend/recipeForm.html">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="styleResp.css"> 
    <link rel="stylesheet" href="animation.css"> 

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Home</title>
</head>
<body>

<!--Recipe Description-->
<section class="recipeTitle gx-0">

  <div class=" container justify-content-center   ">

<h1 class=" m-5 p-3 text-center bg-danger rounded-4 text-white">  Write your own recipe!</h1>
        <!--img-->
        <label for="" class="form-label">Recipe Picture</label>
        <input class="form-control form-control-sm mb-5 p-2 w-75" type="text" placeholder="enter picture url" >
        <!--description-->
        
            <!--title-->
            <label for="" class="form-label"> Recipe Title</label>
    <input class="form-control form-control-sm  mb-5 p-2 w-75" type="text" placeholder="enter title recipe" >

            <label for="" class="form-label">Recipe Description</label>
    <input class="form-control form-control-sm  mb-5 p-2 w-75" type="text" placeholder="enter description recipe" >

    <!--Recipe info-->
    <div class="d-flex text-center  descriptionLogos border">
        <div class="logo1  p-2 mx-2  m-lg-3 px-lg-5 text-center border-end">
       <i class="fa-regular fa-clock fs-3 rotatec"></i>
           <input class="form-control form-control-sm" type="text" placeholder="enter active time" >
        </div>
        <div class="logo2  p-2 mx-2 m-lg-3 px-lg-5 text-center border-end">  
        <i class="fa-solid fa-clock-rotate-left fs-3 rotatec"></i>
           <input class="form-control form-control-sm" type="text" placeholder="enter total time" >

        </div>
        <div class="logo3 p-2 mx-2 m-lg-3 px-lg-5 text-center">        
        <i class="fa-solid fa-users fs-3"></i>
           <input class="form-control form-control-sm" type="text" placeholder="enter yield" >

        </div>
    </div>


    <div class="d-flex mt-5 bottomDescription">
    
    <div class="container">
     <label for="" class="form-label">Recipe Author</label>
    <input class="form-control form-control-sm mb-5 p-2  w-75" type="text" placeholder="enter name author" >

    </div>
    
    </div>
    
   
  </div>
</section>

  <section class="m-1 p-1 m-lg-5 p-lg-3 makeRecipe-container">

        <!--left section with instructions and  comments-->
<div class="recipeLeft">
    <div class="recipeSteps">
        <h2 class=" mt-5  my-lg-0">How to make it</h2>
    <ol class="mt-lg-4 list-group instructionsList"  >
        <li class=" d-flex border-0 " > <i class="fa-regular fa-circle-check fs-2 me-3 "></i> 
          <h4 class="text-danger pt-1">1.STEP</h4><div class="container-fluid border-top m-3 me-5"></div> </li>
        <li class="list-group-item border-0 border-bottom-1 mx-5  text-black-50 fs-5" >           
           <input class="form-control form-control-sm  m-3 p-3 w-75" type="text" placeholder="write step 1" >
</li>

       
    </ol>


    </div>

    <i class="fa-regular fa-plus fs-3 mx-3  clickable  " onclick='addStep()'><span  class="fs-6 ">Add more steps</span></i>

     
    </div>

<!-- right section with ingredients&co-->
<div class="recipeRight">

    <!--ingredients tab-->
    <div class="d-lg-flex mt-5 mt-lg-0 recipeIngredients">
      <div class="">
    <h2>Ingredients</h2>
    <ul class="list-group ingredientsList" >
          <input class="form-control form-control-sm  m-2 p-2 w-75" type="text" placeholder="write ingredient 1" >
      
    </ul>

        <i class="fa-regular fa-plus fs-3 mx-3  clickable " onclick='addIngredient()' ><span  class="fs-6 ">Add more ingredients</span></i>

        </div>

       <div class="">
        <h2>Measure</h2>
    <ul class="list-group measureList" >
          <input class="form-control form-control-sm  m-2 p-2 w-75" type="text" placeholder="write measure 1" >
      
    </ul>


       </div>

    </div>

    <!--tags tab-->
    <div class=" pt-3 mt-3">
      <h3 >Tags</h3>
      <div class="dflex tags">
    <input class="form-control form-control-sm  m-2 p-2 w-75" type="text" placeholder="write TAGS" >

          </div>  


    <i class="fa-regular fa-plus fs-3 mx-3  clickable " onclick='addTags()' ><span  class="fs-6 ">Add more tags</span></i>

          </div>

      </div>

    

</div>  

  </section>

    <div class="d-flex justify-content-center">
    <button  type="submit" class=" text-center btn btn-danger p-3 px-5 mb-5 fs-4 rounded-pill">Submit</button>
    </div>


<script>  //form page 
    //add steps

    function addStep(){
      console.log('addstep');
      let liste=document.querySelector('.instructionsList');
      
      liste.innerHTML+=` <li class=" d-flex border-0 " > <i class="fa-regular fa-circle-check fs-2 me-3 "></i> 
          <h4 class="text-danger pt-1">STEP</h4><div class="container-fluid border-top m-3 me-5"></div> </li>
        <li class="list-group-item border-0 border-bottom-1 mx-5  text-black-50 fs-5" >           
           <input class="form-control form-control-sm  m-3 p-3 w-75" type="text" placeholder="write step " >
</li>`}

      function addIngredient(){
      let liste=document.querySelector('.ingredientsList');
      let measureList=document.querySelector('.measureList');

      liste.innerHTML+='           <input class="form-control form-control-sm  m-2 p-2 w-75" type="text" placeholder="write ingredient " >';
      measureList.innerHTML+='           <input class="form-control form-control-sm  m-2 p-2 w-75" type="text" placeholder="write measure " >';

    
    }
let tags =1;

         function addTags(){

          if (tags >=4 ) {alert("maximum 4 tags") }
      else {let liste=document.querySelector('.tags');
      
      liste.innerHTML+='     <input class="form-control form-control-sm  m-2 p-2 w-75" type="text" placeholder="enter TAGS" >';
    }
    tags++;
  }

    </script>

</body>
</html>
</file>

<file path="recipeProjectHTML/frontend/script.js">
document.addEventListener('DOMContentLoaded', () => {
  const links = document.querySelectorAll('nav a');
  const currentPath = window.location.pathname;
  console.log("url actuel : " + currentPath);
  links.forEach(link => {
    const linkPath = new URL(link.href).pathname;
    if (linkPath === currentPath) {
      link.classList.add('urlActive');
      console.log("url active : " + linkPath);
    } else {
      link.classList.remove('urlActive');
    }
  });
});


searchButton = document.getElementById('searchButton');
searchWindow = document.getElementById('searchWindow');
let windowStatus= "none";
searchButton.addEventListener('click', () => {

  if(windowStatus=="none")
 { searchWindow.style.display = 'block';  

  //add animation
  searchButton.classList.add('rotatec');
  searchWindow.classList.add('slide-in-blurred-left');


  /*
  document.querySelector(".btnCustom").style.width="5em";
  document.querySelector(".btnCustom2").style.width="5em";
  */
  windowStatus="block";
 }
 else{

  sendSearch();
 /* windowStatus="none";
  searchWindow.style.display = "none";
  
  //document.querySelector(".btnCustom").style.width = "5em";
  //document.querySelector(".btnCustom2").style.width = "5em";
  */
 }

});


 searchWindow.addEventListener("keydown", (event) => {
  if (event.key === "Enter") {
      sendSearch();
   }
});

function sendSearch(){
      let mot = searchWindow.value;
    localStorage.setItem('searchKey',mot);
    console.log(mot);
    window.location.href = 'search.html';
}


function searchClose() {
  searchWindow.style.display = 'none';
  
}

//display signin page
signinButton = document.getElementById('signinButton');
signWindow = document.getElementById('signWindow');
overlay = document.getElementById('overlay1');

signinButton.addEventListener('click', () => {
  signWindow.style.display = 'block';
  overlay.style.display = 'block';
});

function displaySignin(){
  signWindow.style.display = 'block';
  overlay.style.display = 'block';
}

//close signin window
function signinClose() {
  document.getElementById('signWindow').style.display = 'none';
  document.getElementById('overlay1').style.display = 'none';
  
}



//display signup div


function displaySignup (){
     document.getElementById("overlay2").style.display = "block"; 
     
     
}

// close window with button
function signupClose() {
  document.getElementById('overlay2').style.display = 'none';
}
//close window with click outside the window

document.querySelectorAll('.overlay').forEach(overlay => {
  overlay.addEventListener('click', function(event) {
    if (event.target === overlay) {
      overlay.style.display = 'none';
    }
  });
});

overlay2= document.getElementById('overlay2');

  overlay2.addEventListener('click', function(event) {
    if (event.target === overlay2) {
      overlay2.style.display = 'none';
    }
  });


  //form page 
    //add steps

    function addStep(){
      console.log('addstep')
      let liste=document.querySelector('.instructionsList');
      
      liste.innerHTML+=' <li class="list-group-item border-0 border-bottom" > <input class="form-control form-control-sm  m-3 p-2 w-75" type="text" placeholder="write ingredient" ></li>';
    }

//print page
document.getElementById("print").addEventListener("click", function() {
window.print();
});
</file>

<file path="recipeProjectHTML/frontend/searchtool.html">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
   <link rel="stylesheet" href="style.css"> 
      <link rel="stylesheet" href="styleResp.css"> 
  <script src="script.js" defer></script>
    <script src="search.js" defer></script>


<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Home</title>
</head>
<body>



<div class="recipe-container">

  <!--recipe  search form-->
<section class="d-lg-flex recipeForm mx-lg-5 ">

  <div class="container mt-3">
  <div class="d-lg-flex mx-lg-5" role="search">
    <div class="input-group w-lg-50">
            <span class="input-group-text btnSearch" id="basic-addon1">
        <i class="fa-solid fa-magnifying-glass " onclick="recipeSearch_start();" ></i>
      </span>   
      <input type="text" class="form-control w-lg-50" placeholder="Search" id="textSearch" aria-label="Search" aria-describedby="basic-addon1">
    </div>
  </div>
</div>
<!--
 <form class="d-flex">
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
 </form>
 -->
<div class="searchList mt-2">
  <select class="form-select fs-5 rounded-pill form-select-lg mx-2 mx-lg-5"  id="recipeFilter">
    <option selected disabled>Sort by : </option>
    <option value="recipeDate">Sort by : date</option>
    <option value="recipeAlpha">Sort by : A to Z</option>
    <option value="recipeNote">Sort by : note </option>
  </select>
</div>  

</section>
<!--recipe results on caroussel( with bootstrap)  -->
    <section class="recipeList2 ">

                <div class="container py-3">
<div id="cardCarousel" class="carousel slide" data-bs-ride="false">
  <div class="carousel-inner">
    <!-- Slide 1 -->
    <div class="carousel-item active">
      <div class="row g-3">
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=2" class="card-img-top" alt="Card 2">
            <div class="card-body">
              <h5 class="card-title">Card 2</h5>
              <p class="card-text">Description carte 2.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="Card 3">
            <div class="card-body">
              <h5 class="card-title">Card 3</h5>
              <p class="card-text">Description carte 3.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 2 -->
    <div class="carousel-item">
      <div class="row g-3">
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=4" class="card-img-top" alt="Card 4">
            <div class="card-body">
              <h5 class="card-title">Card 4</h5>
              <p class="card-text">Description carte 4.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=5" class="card-img-top" alt="Card 5">
            <div class="card-body">
              <h5 class="card-title">Card 5</h5>
              <p class="card-text">Description carte 5.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=6" class="card-img-top" alt="Card 6">
            <div class="card-body">
              <h5 class="card-title">Card 6</h5>
              <p class="card-text">Description carte 6.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 3 -->
    <div class="carousel-item">
      <div class="row g-3">
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=7" class="card-img-top" alt="Card 7">
            <div class="card-body">
              <h5 class="card-title">Card 7</h5>
              <p class="card-text">Description carte 7.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=8" class="card-img-top" alt="Card 8">
            <div class="card-body">
              <h5 class="card-title">Card 8</h5>
              <p class="card-text">Description carte 8.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Indicators-->
  <div class="carousel-indicators position-static mt-3 justify-content-center" href="#cardCarousel">
        <button class="btn btn-outline-primary bg-white " type="button" data-bs-target="#cardCarousel" data-bs-slide="prev">
      ⬅️ 
    </button>
    <div class="d-flex numeroButton" id="numeroButton">
    <button type="button" data-bs-target="#cardCarousel" data-bs-slide-to="0" class="active bg-white text-black-50" href="#cardCarousel">1</button>
    <button type="button" class=" bg-white text-black-50" data-bs-target="#cardCarousel" data-bs-slide-to="1"  href="#cardCarousel">2</button>
    <button type="button" class=" bg-white text-black-50" data-bs-target="#cardCarousel" data-bs-slide-to="2">3</button>
    </div>
     <button class="btn btn-outline-primary bg-white" type="button" data-bs-target="#cardCarousel" data-bs-slide="next">
       ➡️
    </button>
  </div>

  <!-- arrow-->
  <div class="d-flex justify-content-center mt-4 gap-3">

        </section>

  </div>
</div>




</body>
</html>
</file>

<file path="RecipeProjectjs/backend/copyDBMeal.js">
var http = require('http');
let url = require('url');
const fsp = require('fs').promises;
let express=require("express");
const bcrypt = require('bcryptjs');
let app=express();
let ejs = require('ejs');
const cookieParser = require('cookie-parser');
const path = require('path'); 
const bodyParser = require('body-parser')
var mysql      = require('mysql2'); 

let count=0;

app.use(cookieParser());
app.use(bodyParser.urlencoded({extended:true}));
app.use(express.json());

 let pseudo = "";
  

var connection = mysql.createConnection({
  host     : 'localhost',
  user     : 'root',
  password : '',
  database : 'recipeproject3'
});
 
connection.connect(err => {
  if (err) {
    console.error('❌ Erreur de connexion à MySQL :', err.message);
  } else {
    console.log('✅ Connecté à la base MySQL !');
  }
});


app.set('view engine', 'ejs');
app.set('views', path.join(__dirname, '..', 'frontend'));

 app.use(express.static(path.join(__dirname, '..', 'frontend')));



const axios = require('axios');


copyAllCat(); //copy all category
//getcategory();

//getID("Breakfast"); //copy one cat



async function copyMealByID(mealID,categoryID) {
  
  const url = `https://www.themealdb.com/api/json/v1/1/lookup.php?i=${mealID}`;

    try {
    const response = await axios.get(url);
    console.log(response.data.meals[0]);
    recipe=response.data.meals[0];

       
       let post  = {
        title: recipe.strMeal,
        image:  recipe.strMealThumb,
        description : recipe.strYoutube,
        auteur : "Meal DB",
        categoryID: categoryID,
    }; 
     let tag= [recipe.strArea, recipe.strCategory]

        let fin = false;let ingredient=[];let measure=[];
    for(let i=1; i<20  && fin===false; i++){
     ingredient[i] = recipe[`strIngredient${i}`];
     measure[i] = recipe[`strMeasure${i}`];

    if (ingredient === "") {
          fin = true;
        }

    }

    var query = connection.query('select * FROM recipe where title=? && auteur = ? and image =? ', [post.title,post.auteur,post.image],
       function (error, resultCheck, fields) {
    if (error) throw error;     
        console.log('result checl'+resultCheck[0]);
    check=false;
        if(resultCheck){
            let filtered = ingredient
              .map((ing, index) => ({ ingredient: ing, measure: measure[index] }))
              .filter(item => item.ingredient && item.ingredient.trim() !== ""); // garde seulement si ingredient non vide

            // Puis on sépare à nouveau :
            ingredient = filtered.map(item => item.ingredient);
            measure = filtered.map(item => item.measure);

            console.log(ingredient);console.log(measure);
    
    let cleanInstructions = recipe.strInstructions
  .replace(/\r?\n\r?\n/g, "\n")  // remplace les doubles/triples sauts par un seul
  .trim();

    const step = cleanInstructions
    .split(/\r?\n+/)       // coupe chaque ligne
    .map(step => step.trim()) // nettoie
    .filter(step => step);    // enlève les lignes vides



        if(resultCheck){ 
          var query = connection.query('INSERT INTO recipe SET ?', post,
            function (error, results, fields) {
              if (error) throw error;
              const recipeID = results.insertId;  // ← récupère l’ID auto-incrémenté
              console.log('Dernier recipeID inséré =', recipeID);

              const stepPost = step.map(txt => [txt, recipeID]);
              /*  const ing = ingredient.map(txt=> [ txt, recipeID ]);
                const ingPost= measure.map(txt=> [ txt, ing ]);*/
              const ingPost = ingredient.map((ingTexte, index) => {
                const measureTexte = measure[index];      // correspondante
                return [ingTexte, measureTexte, recipeID];
              });
              const tagPost = tag.map(txt => [txt, recipeID]);



              if (stepPost) {
                connection.query('INSERT INTO instructions (instruction, recipeID) VALUES ?', [stepPost], (err2) => {
                  console.log("instructions insert");
                  if (err2) throw err2;
                });
              }
              if (ingPost) {
                connection.query('INSERT INTO liste_ingredients ( ingredient, measure, recipeID) VALUES ?', [ingPost], (err3) => {
                  console.log("ingredients insert");

                  if (err3) throw err3;
                });
              }

              if (tagPost) {
                connection.query('INSERT INTO tagslist (tag, recipeID) VALUES ?', [tagPost], (err4) => {
                  console.log("tag insert");

                  if (err4) throw err4;
                });
              }
            

            });
          }
        }
  });
    console.log(query.sql); // INSERT INTO contact SET `id` = 1, `title` = 'Hello MySQL'



  } catch (error) {
    console.error(error);
  }

}





async function getcategory() {
  const url = `https://www.themealdb.com/api/json/v1/1/list.php?c=list`;

    try {
    const response = await axios.get(url);

    console.log(response.data.meals);

    recipe=response.data.meals;
    let category=[];
    
// Récupère les catégories
recipe.forEach(element => {
  if (element.strCategory) {
    category.push(element.strCategory.trim());
  }
});

// Supprime les doublons
category = [...new Set(category)];

// Prépare les valeurs sous forme de tableau de tableaux
const categoryValues = category.map(name => [name]);

console.log("Catégories à insérer :", categoryValues);

if (categoryValues.length > 0) {
  const sql = 'INSERT IGNORE INTO category (name) VALUES ?';
  connection.query(sql, [categoryValues], (err2, result) => {
    if (err2) throw err2;});
   }

  } catch (error) {
    console.error(error);
  }
}


let categoryID;
async function copyAllCat() {
  const url = `https://www.themealdb.com/api/json/v1/1/list.php?c=list`;

    try {
    const response = await axios.get(url);

    console.log(response.data.meals);

    recipe=response.data.meals;
    let category=[];


    
// Récupère les catégories
recipe.forEach(element => {
  if (element.strCategory) {
    console.log(element.strCategory);
   getID(element.strCategory);
  }
});

// Supprime les doublons

  } catch (error) {
    console.error(error);
  }
}



async function getID(cat) {
    
    console.log(cat);
  const url = `https://www.themealdb.com/api/json/v1/1/filter.php?c=${cat}`;
    console.log(url);
    
    try {
    const response = await axios.get(url);

    console.log(response.data.meals);

    recipe=response.data.meals;

    connection.query('SELECT id FROM category WHERE name = ?',[cat], function (error, result, fields) {
    if (error) throw error;

    console.log('la categorie est '+result[0].id)
    let categoryID=result[0].id;
    
    recipe.forEach(element => {
       copyMealByID(element.idMeal,categoryID);
       count++;
     console.log(element.idMeal); 
        });
        console.log("count = "+count);
    
                });
// Récupère les catégories


// Supprime les doublons

  } catch (error) {
    console.error(error);
  }
    
}
</file>

<file path="RecipeProjectjs/frontend/account.ejs">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="styleResp.css"> 
    <link rel="stylesheet" href="animation.css"> 

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title><%=title%></title>
</head>
<body>

    <!--navigation bar -->
        <%- include('part/nav', { user: user }) %>

<!--Recipe Description-->
<section class="recipeTitle row gx-0">

  <div class="d-lg-flex container mx-lg-5 px-lg-5 ">

        <!--description-->
         <div class="col-lg-6 justify-content-center " >
    <div class=" mx-lg-5 pt-3 descriptionRecipe">
            <!--title-->
    <h1 class="fade-in fs-1 text-center mx-lg-5 mt-3 my-lg-5  mb-4">Bonjour, <%if(userRole==="admin"){%> <span class="text-warning">Master</span> <%}%> <%=user%> !</h1>

    <!--change password-->
  
      <!-- Button trigger modal -->

              <div class="d-flex text-center  descriptionLogos border-bottom border-top">
              
                <button type="button" class=" bg-transparent border-0" data-bs-toggle="modal" data-bs-target="#passwordModal">
              
                  <div class="logo1  p-3  px-lg-3 align-items-center text-center border-end">
                    <i class="fa-solid fa-key fs-3"></i>
                    <p class="m-0 p-0">Change password</p>
                  </div>
              
                </button>

      
      <!-- Modal -->
      <div class="modal fade mt-5" id="passwordModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Modify your password</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
             <form  id="changePasswordForm">
              <div class="modal-body d-flex flex-column align-items-center">
        
            <!--current password-->
            <label for="" class="form-label"> Current password</label>
    <input  type="password" class="form-control form-control-sm  mb-5 p-2 w-75" minlength="8" type="text" placeholder=""  name="passwordCurrent" >

      <!--new password-->
            <label for="" class="form-label"> new password</label>
    <input  type="password" class="form-control form-control-sm  mb-5 p-2 w-75" minlength="8" type="text" placeholder=""  name="passwordNew" >

      <!--check password-->
            <label for="" class="form-label"> retape password</label>
    <input  type="password" class="form-control form-control-sm  mb-5 p-2 w-75" minlength="8" type="text" placeholder="" name="passwordNew2" >
              </div>
                            </form>

             <div id="responseMessage"></div>

              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="changePasswordButton">Change password</button>
              </div>

            </div>
        </div>
      </div>



      <!-- Modify parameters -->
                <!-- Button trigger modal -->
        <script>
        var myModal = new bootstrap.Modal(document.getElementById('profilModal'));
        myModal.show();
        </script>
     
        <button type="button" class="bg-transparent border-0 p-0 m-0" data-bs-toggle="modal" data-bs-target="#profilModal">
                  <div class="  logo3 p-3 px-4  px-lg-5   text-center border-end">
        <i class="fa-solid fa-users fs-3"></i>
        <p class="m-0 p-0" >Modify profil</p>
        </div>  
        </button>

        <!-- Modal -->
        <div class="modal fade  mt-5" id="profilModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modify Profil</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <form method="post" action="modifyProfil">
              <div class="modal-body d-flex flex-column align-items-center">
               
            <label for="" class="form-label"> Pseudo</label>
    <input class="form-control form-control-sm  mb-5 p-2 w-75" type="text" placeholder="" value="<%=userInfo.pseudo%>" name="pseudo" >

     <label for="" class="form-label">Your Picture</label>
        <input class="form-control form-control-sm mb-5 p-2 w-100" type="text" placeholder="" value="<%=userInfo.image%>" name="image" >
       
            <label for="" class="form-label"> Description</label>
    <textarea class=" form-control mb-5 p-2 w-100 " type="text" placeholder="" value="" name="description" ><%=userInfo.description%></textarea>

                  <p class="text-center text-info"><%if(message==="pseudoExist"){%>Pseudo already exist, choose another one<%}%></p>


              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Save changes</button>
              </div>
            </div>
                            </form>
          </div>
        </div>
        <% if (openDiv==="profil"){%>
           <script>
        var myModal = new bootstrap.Modal(document.getElementById('profilModal'));
        myModal.show();
        </script>
        <%}%>

              <!-- create recipe -->
                    <button type="button" class="bg-transparent border-0 p-0 m-0" data-bs-toggle="modal" data-bs-target="#modalCreateRecipe">
                      <div class="logo3 p-3 px-lg-5 text-center">
                        <i class="fa-solid  fa-utensils fs-3"></i>
                        <p class="m-0 p-0">Create recipe</p>
                      </div>
                    </button>

                    <!-- Modal -->
                    <div class="modal fade" id="modalCreateRecipe" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                      <div class="modal-dialog modal-fullscreen">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Create your Recipe</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>
                          <div class="modal-body">
                            <iframe src="/recipeForm" width="100%" height="100%" 
                                class="border-0 rounded-3 shadow-sm" title="Exemple de page" allowfullscreen></iframe>
                          </div>

                        </div>
                      </div>
                    </div>
    </div>

      <div class=" text-center fst-italic m-3 py-lg-4 px-lg-5">   <%=userInfo.description%> </div>

          
              </div>
              </div>
     

            <!--img-->
        <div class="col-lg-6">
        <div class=" justify-content-center  image-container">
        <img src="<%=userInfo.image %>" class=" tilt1  pt-3 rounded-5 recipePhoto" alt="image">
        </div>
          </div>

      </div>


</div>  

<!--see and delete comments and note-->

<div class="d-flex justify-content-center m-2 m-lg-5" id="comment"> 
  <div class="accordion accordion-flush bg-light   w-75 w-sm-100 justify-content-center mt-3 text-center mx-2 me-4" id="accordionFlushExample">
  <div class="accordion-item text-center w-100">
    <h2 class="accordion-header" id="flush-headingOne" >
      <button class="accordion-button collapsed"  type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
       My Comments
      </button>
    </h2>
    <div id="flush-collapseOne"  class="accordion-collapse <%if(openDiv==='comments'){%>
      show <%}else{%>collapse<%}%> " aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
      <div class="accordion-body">
        <ul class="list-unstyled  "> 
      <%commentaires.forEach(commentaire => { console.log("recipe ID in : "+commentaire.recipeID) %>
        <li class="d-lg-flex flex-column bg-warning-subtle mb-2 p-1 rounded-pill border"> <p> <%=commentaire.title%> : </p> 
          <p><%=commentaire.commentaire%></p>
        <form method="post" action="deleteComm">
          <input hidden name="recipeIDComm" value="<%=commentaire.recipeID%>">
          <button type="submit" class="rounded-5 bg-danger" >Delete</button>
        </form>
        </li>
        <% }); %>
        </ul>
    </div>
  </div>
  <div class="accordion-item w-100">
    <h2 class="accordion-header" id="flush-headingTwo">
      <button class="accordion-button collapsed text-center" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
        My notes
      </button>
    </h2>
    <div id="flush-collapseTwo" class="accordion-collapse <%if(openDiv==='note'){%>
      show <%}else{%>collapse<%}%> " aria-labelledby="flush-headingTwo" data-bs-parent="#accordionFlushExample">
      <div class="accordion-body">
         <ul class="list-unstyled"> 
      <%notes.forEach(note => { %>
        <li class="d-flex justify-content-center bg-warning-subtle mb-2 p-1 rounded-pill border"> <p class="text-center me-1"> <%=note.title%> : </p> 
          <p> <%=note.note%> / 5</p>
        <form method="post" action="deleteNote">
          <input hidden name="recipeIDnote" value="<%=note.recipeID%>">
          <button class="btn-danger bg-danger border-1 rounded-5 mx-2 mx-lg-5" type="submit" >Delete</button>
        </form>
        </li>
        <% }); %>
        </ul>
    </div>
  </div>

  </div>



  </section>

 

<!--favorites recipes-->
<section class="videoSection2 container-fluid  py-5   " id="fav">

  <div class="videoTitle m-3 m-lg-5 justify-content-center">
<h2 class=" bg-danger-subtle text-danger border rounded-pill p-2 ">Your favorites recipes</h2>

  </div>

  <div class="videos-container2 m-lg-5 flex-nowrap " id="videos-container">
  
    <% recipes.forEach((recipe, index)=> { if(recipe.image===null)recipe.image="https://www.akteos.com/fileadmin/mediatheque/blog/2021/02/Article-Chine-diner.jpeg"; %>
  
        <div class="cardExt">
        <div class="card">
                    <form method="post" action="/goRecipe" id="myForm" >
             <button type="submit" class="p-0 border-0 bg-transparent w-100">
        <input hidden name="recipeID" value="<%=recipe.id%>">
          <img src="<%= recipe.image %>" class="card-img-top" alt="<%= recipe.title %>">
          <div class="card-body">
            <h5 class="card-title">
              <%= recipe.title %>
            </h5>
            <div class="d-flex justify-content-between"> 
           <span><%=recipe.note%><i class=" pb-1 ms-1 fa-solid fa-star"></i></span>
            <span class="card-text">
              <%= recipe.auteur %>
            </span></div>
          </div>         
         </button></form>
        </div>
          <form method="post" action="deleteFav">
          <button class="btn  text-center rounded-pill bg-danger border-black border m-lg-1" value="<%=recipe.id%>" name="deleteFav">Delete</button></form>
        </div>

  <%  });%>





</div>

</section>

 <!--own recipes-->
<section class="videoSection2 bg-light  container-fluid py-5  " >

  <div class="videoTitle m-3 mx-lg-5 justify-content-center ">
    <h2 class="bg-danger-subtle text-danger border rounded-pill p-2 ">Your own recipes</h2>

  </div>
  <div id="ownrecipe" class="videos-container2 m-lg-5  flex-nowrap" >

    <% ownRecipes.forEach((recipe, index)=> {
      if(!recipe.image)recipe.image="https://www.akteos.com/fileadmin/mediatheque/blog/2021/02/Article-Chine-diner.jpeg";
      %>

      <div class="cardExt">
        <div class="card">
          <form method="post" action="/goRecipe" id="myForm">
            <button type="submit" class="p-0 border-0 bg-transparent w-100">
              <input hidden name="recipeID" value="<%=recipe.id%>">
              <img src="<%= recipe.image %>" class="card-img-top" alt="<%= recipe.title %>">
              <div class="card-body">
                <h5 class="card-title">
                  <%= recipe.title %>
                </h5>
                <div class="d-flex justify-content-between">
                  <span>
                    <%=recipe.note%><i class=" pb-1 ms-1 fa-solid fa-star"></i>
                  </span>
                  <span class="card-text">
                    <%= recipe.auteur %>
                  </span>
                </div>
              </div>
            </button>
          </form>
        </div>

        <div class="d-flex justify-content-around mt-1">
        <form method="post" action="modifyForm?recipe=<%=recipe.id%>">
          <button class="btn  text-center rounded-pill mx-1 bg-primary border border-black" name="modifyOwn" value="<%=recipe.id%>">Modify</button></form>
          <form method="post" action="deleteOwn">
          <button class="btn  text-center rounded-pill mx-1 bg-danger border border-black" name="deleteOwn" value="<%=recipe.id%>">Delete</button></form>
        </div>
      </div>        
  <%  });%>
</div>
</div>
      <p  class="text-center text-warning"><%if(message==="recipeModified"){%> The recipe have been modified
         <% }  if (message === "recipeDeleted") { %>The recipe have been deleted  <% }  if (message === "noPseudo") { %> User doesn't exist
         <% }  if (message === "ban") { %>User have been banned<% } else if (message === "unban") { %>User have been unbanned
         <% }  if (message === "giveAdmin") { %>Admin right have been given <% }  if (message === "removeAdmin") { %>Admin right have been removed<%}%></p>

</section>

<% if(userRole==="admin"){ %>
<section class=" container-fluid  py-5   " >

  <div class="videoTitle m-3 m-lg-5 justify-content-center">
  <h2 class=" bg-danger-subtle text-danger border rounded-pill p-2 ">Admin Zone</h2>
</div>

      <div class="d-flex justify-content-around">
          <div class="">
                <h3>BAN/UNBAN User :</h3>
                <form method="post" action="ban">
                  <input type="text" placeholder="enter pseudo name " minlength="4" name="pseudo"> 
                  <button type="submit" class="btn-warning bg-warning" name="act" value="ban">BAN</button>
                  <button type="submit" class="btn-warning bg-primary" name="act" value="unban">UNBAN</button>
                </form>
              </div>

                <div class="">
                  <h3>Give Admin Right :</h3>
                <form method="post" action="giveAdmin">
                  <input type="text" placeholder="enter pseudo name" minlength="4" name="pseudo"> 
                  <button type="submit" class="btn-warning bg-primary" name="act" value="giveAdmin">Give</button>
                  <button type="submit" class="btn-warning bg-warning" name="act" value="removeAdmin">Remove</button>
                </form>
                </div>

                         
      </div>

</section>
<%}%>

<footer>
<!--footer with logos and links -->

<!--logos with fontawesome-->
  <div class="logos me-5 pe-lg-5">
<i class="fa-brands fa-facebook fa-2x p-3" ></i>
<i class="fa-brands fa-instagram fa-2x p-3"></i>
<i class="fa-brands fa-twitter fa-2x p-3"></i>

  </div>

  <div class="container mt-3">           
  <div class="table-perso">

      <ul>
        <li><a href="">Presentations</a></li>
        <li><a href="">Profesionals</a></li>
        <li><a href="">Stores</a></li>
      </ul>
              <ul>
         <li><a href="">Webinars      </a></li>
          <li ><a href="">Workshops</a></li>
         <li><a href="">Local Meetups</a></li>
      </ul>
        <ul>
         <li><a href="">Ours initiative</a></li>
          <li><a href="">Giving Back</a></li>
         <li><a href="">Communities</a></li>
      </ul>
        <ul>
        <li><a href="">Contact Form</a></li>
        <li><a href="">Work with us</a></li>
        <li><a href="">Visit us</a></li>
      </ul>
             

</div>

  <p class="textTab">Made by C.C</p> 


</footer>



<!--Signin Div-->
<% user='';console.log(user); if( !user || user===""){ %>
<div class="overlay" id="overlay1">
  <div class="signWindow" id="signWindow">
    <button type="button" class="btn btnAc border text-center btn-danger btnClose" aria-label="Close" id="closeSignWindow" onclick="signinClose()">X</button>
    <iframe src="login " width="100%" height="100%" style="border:none;"></iframe>
  </div>
</div>
<% } %>
<!-- sign up div -->

<div class="overlay3" id="overlay2">

  <div class=" container signup  ">
      <button type="button" class="btn btnAc text-center btn-danger border p-1  btnClose2" aria-label="Close" id="closeSignupWindow" onclick="signupClose()">X</button>

  <div class="p-4  bg-danger border  rounded-5">

       <form class=" contactForm  "  action="/signup" method="post">
      <div class="  mx-auto text-center text-grey formAlign">
        <h2 class="text-center m-4 fw-bold pt-2">Sign up</h2>
            
        <h5 class="text-center m-3 text-white">Join us and add your own recipes and many more! </h5>
        
        <label for="pseudo" class="form-label  text-center text-grey fs-4 me-3 ">Pseudo</label>
        <input type="text" class="form-control text-center   w-50 rounded-pill bg-white border border-grey text-center text-black"  name="pseudo" id="pseudo" placeholder="pseudo" required>
        

        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="text" class="form-control text-center  w-50 rounded-pill bg-white border border-grey text-center text-black" name="password" id="password" placeholder="pseudo" required >
      
        <label for="mail" class="form-label text-center text-grey fs-4 me-3 mt-3">Email</label>
        <input type="text" class="form-control w-75 rounded-pill bg-white border border-grey text-center text-black " name="mail"  id="mail" placeholder="cor@ind.com" requires>

      </div>


      <div class=" text-center">
       <button type="submit" class="btn mx-3 fs-5 px-3 mt-3 mb-4 btn-warning  rounded-pill">Sign up</button>
    </div>

    </form>

  </div>
</div>

</div>
</div>

  <script src="script.js" defer></script>

</body>
</html>
</file>

<file path="RecipeProjectjs/frontend/contact.ejs">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
   <link rel="stylesheet" href="style.css"> 
    <link rel="stylesheet" href="styleResp.css"> 
    <link rel="stylesheet" href="animation.css"> 

  <script src="script.js" defer></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Home</title>
</head>
<body>

  
  <!--navigation bar -->
 <%- include('part/nav', { user: user }) %>


<!--presentation section with text and link-->
      <div class = "d-lg-flex contactGroup  " >

<section class=" contactText py-3 ">

  <div class=" container py-5">
    <div class="p-3 ms-lg-5  text-black">
    <h1>Hello, What's on your mind?</h1>
    <h4 class="mb-3 text-black-50"> Credibly administrate market positioning deliverables rather than clicks-and-mortars methodologies. Proactiverly formulate out-of-the-box technology with click-and-mortar testing procedures. Uniquely promote leveraged web readiness for standart compliant value. Rapidiously ponctifate cooperative mindshare via maintenable applications
    </h4>
        <button type="button" class="btn  fs-5 px-3  btn-danger rounded-pill">Schedule a call</button>

    </div>
  </div>

</section>


<!--subscribe email form  -->
<section class="contactForm-container p-lg-5">

  <div class=" container ">
  <div class="p-4 border rounded-4 shadow-sm text-white bg-danger">

    <form class=" contactForm " method="post" action="/sendMailContact" >
      <div class="  w-100 w-lg-75 mx-auto">
        <label for="name" class="form-label fs-4 me-3">name</label>
        <input type="text" class="form-control rounded-pill bg-danger border border-white text-white" name="name" id="name" >
        
        <label for="mail" class="form-label fs-4 me-3 mt-3">Email</label>
        <input type="text" class="form-control rounded-pill bg-danger border border-white text-white" name="mail" id="mail" >
      
        <label for="message" class="form-label fs-4 me-3 mt-3 ">message</label>
        <textarea class="form-control rounded-4 bg-danger border border-white text-white  messageForm" name="message" id="message"></textarea>
  
   
      </div>
      <div class=" text-center">
        <%if(messageCheck!="Mail sent!"){ %>
       <button type="submit" class="btn mx-3 fs-5 px-3 mt-3 btn-warning  rounded-pill">Send message</button>
       <%}%>
    </div>

    </form>
    <div class="text-center text-white"><%=messageCheck%></div>
  </div>
</div>

</section>
</div>

 <%- include('part/footer', { user: user }) %>

 <%- include('part/sign', { user: user}) %>


</body>
</html>
</file>

<file path="RecipeProjectjs/frontend/home.ejs">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js" defer></script>


  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="styleResp.css"> 
  <link rel="stylesheet" href="animation.css"> 

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Home</title>
</head>
<body>

  <!--navigation bar -->
 <%- include('part/nav', { user: user }) %>

<!--presentation section with text and link-->
<section class="signup-container tilt1 ">

  <div class=" container-fluid ms-2 ms-lg-5 my-5 " >
  <div class="p-4 border rounded-4 shadow-sm text-white background-perso">
    <div class="signup-text">
    <h1>CHOOSE FROM THOUSANDS OF RECIPES</h1>
    <% if(!user){ %>
    <h3 class="mb-3 "> sign up to acess to a lot of recipes, add your own recipes, and many more</h3>
    <a  class =" d-flex text-decoration-none text-white" onclick="displaySignup()" ><h3>Sign up today </h3> <i class="fa-solid fa-arrow-right m-2 p-2 fa-lg" ></i> </a>
   <% } %> </div>
  </div>
</div>

</section>

<!--recipe search and result -->
<div class="recipeGroup ms-lg-5" id="searchResults">

  <!-- navnar on the left  -->
    <section class="recipeMenu">
      <h1 class="ms-2"> Recipes</h1>
      
    <div class="container-fluid mt-3 ">

     <div class="accordion" id="menuAccordion">

    <!-- Menu 1 -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button fs-4" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true">
          Dishes
        </button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#menuAccordion">
        <div class=" accordion-body">
          <form method="post"  action="searchRecipeHome" class="d-flex flex-column align-items-start text-black-50">
            <button type="submit" class="bg-transparent my-lg-1 py-lg-1   border-0" name="textSearch" value="">All</button>
            <button type="submit" class="bg-transparent my-lg-1 py-lg-1   border-0" name="textSearch" value="Breakfast">Breakfast</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="pasta">Pasta</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="beef">Beef</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Chicken">Chicken</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Seafood">Sea food</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Side">Side</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="dessert">Dessert</button>
          </form>
 


        </div>
      </div>
    </div>

    <!-- Menu 2 -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false">
         World Food
        </button>
      </h2>
      <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#menuAccordion">
        <div class="accordion-body">
          <form method="post"  action="searchRecipeHome" class="d-flex flex-column align-items-start text-black-50">
            <button type="submit" class="bg-transparent my-lg-1 py-lg-1   border-0" name="textSearch" value="chinese">Chinese</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Turkish">Turkish</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Indian">Indian</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Thai">Thai</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Moroccan">Moroccan</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Mexican">Mexican</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="Japanese">Japanese</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Menu 3 -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false">
          Vegan & Vegetarian
        </button>
      </h2>
      <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#menuAccordion">
        <div class="accordion-body">
          <form method="post"  action="searchRecipeHome" class="d-flex flex-column align-items-start text-black-50">
            <button type="submit" class="bg-transparent my-lg-1 py-lg-1   border-0" name="textSearch" value="vegan">Vegan</button>
            <button type="submit" class="bg-transparent border-0 my-lg-1 py-lg-1  " name="textSearch" value="vegetarian">Vegetarian</button>
            </form>
        </div>
      </div>
    </div>

  </div>


    </div>
</section>

<div class="recipe-container container-fluid">

  <!--recipe  search form-->
<section class=" recipeSearch  ">

  <div class=" container-fluid mt-3">
   <form method="post" action="/searchRecipeHome"> 

  <div class="d-flex " role="search">
    <div class="input-group slide-in-blurred-left">
      <span class="input-group-text btnSearch" id="basic-addon1">
       <button type="submit" style="border: none; background: none;"><i class="fa-solid fa-magnifying-glass "  ></i></button> 
      </span>      
      <input type="text" class="form-control-home " name="textSearch" placeholder="Search" id="textSearch" aria-label="Search" aria-describedby="basic-addon1">
    </div>
  </div>
      </form>

</div>


<div class="searchList mt-2 ">
  <form action="/searchRecipeHome" method="POST">
   <input hidden name="formSelect" value="true">
  <select class=" form-select fs-5  rounded-pill mt-1 mx-3 .form-select-lg form-select2" name="searchFilter" onchange="this.form.submit()"   >
    <option selected disabled>Sort by : </option>
      <option value="date">Sort by : date</option>
      <option value="title">Sort by : A to Z</option>
      <option value="note">Sort by : note </option>
  </select>
  </form>
</div>
</section>
<!--recipe results on caroussel( with bootstrap)  -->
    <section class="recipeList2 ">

                  <div class="container-fluid py-3">
  <div id="cardCarousel" class="carousel slide" data-bs-ride="false">
    <div class="carousel-inner">

      <% let count = 0; let nbSlide=1; if(recipes){  %>
      <% recipes.forEach((recipe, index) => {
        console.log("recipeid : "+recipe.id);
     if(!recipe.image)recipe.image="https://www.akteos.com/fileadmin/mediatheque/blog/2021/02/Article-Chine-diner.jpeg";
 %>

        <% if (count === 0) { %>
          <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
            <div class="row g-3">
        <% } %>

        <div class="col-6 col-lg-4">
          
          <form method="post" action="/goRecipe" id="myForm" >
                <button type="submit" class="p-0 border-0 bg-transparent w-100">
            <input hidden name="recipeID" value ="<%=recipe.id%>" >
          <div class="card shadow-sm h-100" >
            <img src="<%= recipe.image %>" class="card-img-top" alt="<%= recipe.title %>">
            <div class="card-body pb-0">
              <h5 class="card-title"><%= recipe.title %></h5>
              <div class="d-flex justify-content-between pt-3 pb-0 mb-0">
                <span><%=recipe.note%><i class=" pb-1 ms-1 fa-solid fa-star"></i></span>
                <span class="card-text"><%= recipe.auteur %></span>
              </div>
            </div>
          </div>
        </div>
      </button>
        </form>
        <% count++; %>
        <% if (count >= 12 || index === recipes.length - 1) { %>
            </div>
          </div>
          <% 
          if (count >= 12){nbSlide++;count = 0;} }console.log(recipes.length) %>
       

      <%  }); }%>

    </div>
     <!-- Indicators-->
  <div class="carousel-indicators  position-static mt-3 justify-content-center" href="#cardCarousel">
        <button class="btn btn-outline-primary bg-white " type="button" data-bs-target="#cardCarousel" data-bs-slide="prev">
      ⬅️ 
    </button>
    <div class="d-flex numeroButton " id="numeroButton">
    <button type="button" data-bs-target="#cardCarousel" data-bs-slide-to="0" class="active bg-white text-black-50" href="#cardCarousel">1</button>
     <% if(recipes){  console.log(nbSlide);  for (let i = 1; i < nbSlide; i++) { console.log(i); %>
     
 <button type="button" class=" bg-white text-black-50" data-bs-target="#cardCarousel" data-bs-slide-to="<%=i%>"  href="#cardCarousel" value=""><%=(i+1)%></button>   
    <% }  }%> 
          </div>
     <button class="btn btn-outline-primary bg-white" type="button" data-bs-target="#cardCarousel" data-bs-slide="next">
       ➡️
    </button>
  </div>

        </section>

  </div>
</div>



<!--4 videos recommanded -->
<section class=" container videoSection my-5 m-lg-5   ">

  <div class=" container-fluid ms-lg-5 videoTitle   ">
<h2>VIDEOS</h2>
  <form action="/searchVideos" method="POST">
  <select class="form-select fs-5 rounded-pill  .form-select-video form-select2"  id="videosFilter">
    <option selected disabled>Sort by : </option>
    <option value="recipeDate">Featured</option>
    <option value="recipeAlpha">Featured</option>
    <option value="recipeNote">featured </option>
  </select>
  </form>

  </div>

<div class="videos-container container-fluid m-lg-5" id="videos-container">

  <% recipesRecommanded.forEach(recipe => { %>
  <div class="card" >
      <!--
  const embedUrl = (recipe.description || '').match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]+)/);
  const url = embedUrl ? `https://www.youtube.com/embed/${embedUrl[1]}` :  null;
  console.log("url yt " +url)
-->
<form method="post" action="/goRecipe" id="myForm">
      <button type="submit" class="p-0 border-0 bg-transparent ">
        <input hidden name="recipeID" value="<%=recipe.id%>">
        <% if(!recipe.image)recipe.image='https://cdn-s-www.dna.fr/images/60C1C7EF-628F-4C3E-B452-A807BA5B8749/NW_raw/photo-shutterstock-1660556772.jpg'; %>
        <img src="<%= recipe.image %>" class="card-img-top" alt="<%= recipe.title %>">
        <div class="card-body pb-0">
          <h5 class="card-title text-black-50">
            <%= recipe.title %>
          </h5>
          <div class="d-flex justify-content-between pt-3 pb-0 mb-0">
            <span><%=recipe.note%><i class=" pb-1 ms-1 fa-solid fa-star"></i></span>
            <span class="card-text">
              <%= recipe.auteur %>
            </span>
          </div>

  </div>
        </button>
    </form>
  </div>

  <%});%>
  
</div>
</section>

<!--subscribe email form  -->
<section class="subscribeSection">

  <div class="container-fluid  ">
  <div class="p-5 border rounded-4 shadow-sm bg-danger">
    <h1 class="fs-1 mx-0 px-0 mx-lg-5 px-lg-5 text-white text-center">Be the first to know about the latest deal, receive new trending recipes & more</h3>
    <p class="text-muted"></p>

    <form class="d-flex   content-center ">
      <div class=" d-lg-flex w-100 w-lg-75 mx-auto">
        <input type="text" class="form-control rounded-pill bg-danger border border-white text-white" id="mail" placeholder="e-mail adress">

        <button type="button" class="btn mx-3 fs-5 px-3   rounded-pill" onclick="displaySignup()">Subscribe</button>
              </div>

    </form>
  </div>
</div>

</section>

 <%- include('part/footer', { user: user }) %>

 <%- include('part/sign', { user: user}) %>


</body>
</html>
</file>

<file path="RecipeProjectjs/frontend/login.ejs">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
   <link rel="stylesheet" href="style.css"> 
      <link rel="stylesheet" href="styleResp.css"> 
    
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
   <title>Recipe Sign in</title>
</head>
<body>

       <!--navbar--> 
    <div class="mobile">
 <!--button to hide and show menu on mobile -->

    <nav class="navbar navbar-expand-sm navbar-white bg-white"> 
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
      <!--text to collapse -->
    <div class="collapse navbar-collapse" id="mynavbar">
      <ul class="navbar-nav me-auto">
          <li class="nav-item  ">
          <a class="nav-link fs-5 urlActive" href="home ">Home</a>
        </li>
        <li class="nav-item  ">
          <a class="nav-link text-black fs-5" href="recipe ">Recipe</a>
        </li>
        <li class="nav-item ">
          <a class="nav-link text-black fs-5" href="search ">Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-black fs-5 " href="contact ">Contact</a>
        </li>
           <li class="nav-item">
            <% console.log(user); if(!user||user==='') { %>
          <a class="nav-link text-black fs-5 mb-2 urlCustom2" href="login">Sign in</a>
                   <% }else{  %>
          <a class="nav-link text-black fs-5 mb-2 urlCustom2" href="account">My account</a>
                    <% } %>
        </li>
      </ul>
      <form class="d-flex">
         <a class="nav-link fs-5 urlCustom" href="javascript:void(0)"></a>
        <!--
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
        !-->
    
      </form>    

    </div>
      
          
          </div>
  
        </div>
  </div>
</nav>
    </div>
  

<!--presentation section with text and link-->
      <div class = "d-lg-flex contactGroup  "  >

      
<section class="contactForm-container p-lg-5 " >

  <div class=" container " >
  <div class="p-4  bg-white">

    <% if(!user){  %>
   
    
    <form class=" contactForm needs-validation " id="signinForm" method="post" action="/signin ">
      <div class="  w-100 w-lg-75 mx-auto text-center text-grey">
        <h2 class="text-center m-4 text-black fw-bold pt-5">Sign in</h2>
            <div class="logosLogin text-center d-flex justify-content-center">
    
            <i class="fa-brands fa-facebook fa-2x p-3"  ></i>
            <i class="fa-brands fa-instagram fa-2x p-3"></i>
            <i class="fa-brands fa-twitter fa-2x p-3"></i>

              </div>

        <h5 class="text-center m-4 text-grey">Or use your email account : </h5>
        <label for="mail" class="form-label text-center text-grey fs-4 me-3">Email</label>
        <input type="email" class="form-control rounded-pill bg-white border border-grey text-center text-black" id="mail" name="mail" placeholder="tom@company.com" required>
        
        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="password" class="form-control rounded-pill bg-white border border-grey text-center text-black" id="password"
         name="password" placeholder="Min 8 characters" minlength="8" required>
           <% if(erreur=='mdp'){ %> <p class="text-danger">password incorrect</p> <% } %>
           <div class="" id="responseMessage"></div>
      </div>
      <div class=" text-center my-3">
        <!-- Button trigger modal -->
<button type="button" class="btn bg-light border" data-bs-toggle="modal" data-bs-target="#exampleModal">
  <a>Forget your password?</a>
</button>
   <% ; if(erreur==="mailSent"){  %> <p class="text-warning">A new password have been sent, check your mail!</p> <%}%>
            <div class=" text-center">
       <button type="button" id="signinSubmit" class="btn mx-3 fs-5 px-3 mt-3 btn-warning  rounded-pill">Sign in</button>
    </div>

    </form>



<!-- Modal -->
<div class="modal fade mt-5 " id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Get your password</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form method="post" action="getPasswordMail">
      <div class="modal-body justify-content-center">
        <p>You can receive your password by mail </p>
        <input type="email" class="form-control text-center  w-100 rounded-3 border border-grey " required name="mail" placeholder="type your e-mail">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">Send Mail</button>
      </div>
      </form>
    </div>
  </div>
</div>
        
      </div>



  </div>
</div>


</section>


<section class=" signupSection py-3 " id="overlayb1">

  <div class=" container py-5">
  <div class="p-4 border rounded-4 shadow-sm text-white text-center background-perso">
  <div class="  addMargin">
    <h2 class="m-3 p-3 fw-bold ">Hello there, joins us</h2>
    <h5 class="m-3 p-3 ">Enter your personal details, and join the cooking community</h5>
        <button type="button" class="btn  fs-5 p-3 m-3  bg-white rounded-pill " id="signupButton">Sign Up</button>
  </div>
    </div>
  </div>


</section>
      

<!--signup div -->
  
  <div class=" container signup2 mt-5 text-white" id="overlayb2" >

  <div class="p-4  bg-danger rounded-5 my-5">

    <form class=" contactForm  "  action="/signup" method="post">
      <div class="  mx-auto text-center text-grey formAlign">
        <h2 class="text-center m-4 fw-bold pt-2">Sign up</h2>
            
        <h5 class="text-center m-3 text-white">Join us and add your own recipes and many more! </h5>
        
        <label for="pseudo" class="form-label  text-center text-grey fs-4 me-3 ">Pseudo</label>
        <input type="text" class="form-control text-center   w-50 rounded-pill bg-white border border-grey text-center text-grey"
         minlength="4"  name="pseudo" id="pseudo" placeholder="pseudo" required>
        

        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="password" class="form-control text-center  w-50 rounded-pill bg-white border border-grey text-center text-grey"
          minlength="8" name="password" id="password" placeholder="min 8 characters" required >
            <div class="invalid-feedback">
            Minimum 8 characters
          </div>

        <label for="mail" class="form-label text-center text-grey fs-4 me-3 mt-3">Email</label>
        <input type="email" class="form-control w-75 rounded-pill bg-white border border-grey text-center text-grey " name="mail"  id="mail" placeholder="cor@ind.com" required>
            <div class="invalid-feedback">
            Please enter a valid email address.
          </div>
      </div>

      <div class=" text-center">
       <button type="submit" id="signupSubmit" class="btn mx-3 fs-5 px-3 mt-3 mb-4 btn-warning  rounded-pill">Sign up</button>
    </div>

    </form>
  </div>
</div>
</div>

      </div>
</div>

<% }else{ %>
  
  <p>connection réussi!</p>
  <% } %>


  <script >
//fetch for signin check
if(document.getElementById('signinSubmit')){ 
  const buttonSignin = document.getElementById('signinSubmit');
  buttonSignin.addEventListener('click', async (e) => {
  e.preventDefault(); // empêche le rechargement de la page
   let formSignin = document.getElementById('signinForm');
   console.log('fetch function after submit');
   // const form = e.target;
    const password = formSignin.password.value;
    const mail = formSignin.mail.value;

    try {
        const res = await fetch('/signin', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                password,
                mail
            })
        });

        const data = await res.json();

        const message = document.getElementById('responseMessage');
        if (data.succeed) {
            message.style.color = 'green';
                  let i = 4;
            const interval = setInterval(function () {
              message.textContent = "You are connected, redirect in " + i + 's';
              i -= 1;
              if (i < 0) {
                clearInterval(interval);
                location.reload(); // ou window.location.href = '/'; selon ton besoin
              }
            }, 100); 
        } else {
            message.style.color = 'red';
            message.textContent = data.message;
        }

    } catch (err) {
        console.error(err);
        document.getElementById('responseMessage').textContent = 'Erreur de connexion au serveur.';
    }
    });

  }



//display signin page


//display signup div
document.getElementById("signupButton").addEventListener("click", function() {
  document.getElementById("overlayb2").style.display = "block";
        document.getElementById("overlayb1").style.display = 'none';

});

function signupClose() {
  document.getElementById('overlayb2').style.display = 'none';
}



</script>


</body>
</html>
</file>

<file path="recipe-reactnode-app/src/components/account/profil.jsx">
import { useState,useEffect } from "react";
  import axios from 'axios';

  
  import ModalPassword from './modalPassword'
  import ModalProfil from './modalProfil'
  import CreateRecipe from './createRecipe'
  import imgProfil from '../images/dimsumtransp.png'

 
 export default function  Profil({user,userRole}) {
  const [profil,setProfil]=useState("");
  const [message,setMessage]=useState("");

   useEffect(() => {
          
         async function getProfil(){ 
          const response = await axios.get(import.meta.env.VITE_API_URL+"/getProfil", {
          headers: {
            "Content-Type": "application/json",
          },
        withCredentials: true,    
             });
          const data = response.data;
        console.log("Réponse backend cat :", data);
       setProfil(data.user);
       if(!data.user.image||data.user.image==="")data.user.image="https://picsum.photos/400/250?random=1";
    
            }
          getProfil();
      }, []);

return ( 
<div className="d-lg-flex container mx-lg-5 px-lg-5">

{profil&&user&&<>
  {/* description */}
  <div className="col-lg-6 justify-content-center">
    <div className="mx-lg-5 pt-3 descriptionRecipe">
      
      {/* title */}
      <h1 className="fade-in fs-1 text-center mx-lg-5 mt-3 my-lg-5 mb-4">
        Bonjour,
        {userRole === "admin" && <span className="text-warning"> Master</span>} {user} !
      </h1>

      {/* change password / modal buttons */}
      <div className="d-flex text-center descriptionLogos border-bottom border-top">
        <ModalPassword />
        <ModalProfil profilParent={profil} setProfilParent={setProfil} />

        {/* create recipe button */}
        <button
          type="button"
          className="bg-transparent border-0 p-0 m-0"
          data-bs-toggle="modal"
          data-bs-target="#modalCreateRecipe"
        >
          <div className="logo3 p-3 px-lg-5 text-center">
            <i className="fa-solid fa-utensils fs-3"></i>
            <p className="m-0 p-0">Create recipe</p>
          </div>
        </button>

        {/* create recipe modal */}
        <div
          className="modal fade"
          id="modalCreateRecipe"
          tabIndex={-1}
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
        >
          <div className="modal-dialog modal-fullscreen">
            <div className="modal-content">
              <div className="modal-header">
                <h5 className="modal-title" id="exampleModalLabel">Create your Recipe</h5>
                <button type="button" className="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div className="modal-body">
                <CreateRecipe />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div className="text-center fst-italic m-3 py-lg-4 px-lg-5">
        {profil?.description}
      </div>

    </div>
  </div>

  {/* img */}
  <div className="col-lg-6">
    <div className="justify-content-center image-container">
      <img src={profil?.image} className="tilt1 pt-3 rounded-5 recipePhoto" alt="image" />
    </div>
  </div>
</>}
</div>


);
 }
</file>

<file path="recipe-reactnode-app/src/components/signin.jsx">
import { useState } from "react";
import { useNavigate } from "react-router-dom";
import { useStore } from "../store/store";
import Signup from './signup'
import ForgetPassword from './forgetPassword'
 import { NavLink } from 'react-router-dom';


import axios from 'axios';


export default function Signin() {
  const [showSignup, setShowSignup] = useState(false);
  const [mail, setmail] = useState("");
  const [password, setPassword] = useState("");
  const [message, setMessage] = useState("");
    const navigate=useNavigate();

    const user = useStore((state) => state.user);
   const setUser = useStore((state) => state.setUser)
   const setUserRole = useStore((state) => state.setUserRole)

  
  async function handleSubmit(e) {
    e.preventDefault();

      try {
        const { data } = await axios.post(
          import.meta.env.VITE_API_URL + "/signin",
          {
            mail,
            password,
          },
          {
            headers: {"Content-Type": "application/json",},
            withCredentials: true,
          }
        );

        setMessage(data.message);
        console.log("Réponse backend :", data);

        if (data.succeed) {
          setUser(data.pseudo);
          navigate("/"); 
        }
      } catch (error) {
        console.error("Erreur lors de la connexion :", error);
        setMessage(error.response?.data?.message || "Erreur réseau");
      }
  }


  return (
    <div className="d-lg-flex contactGroup">

      {/* SIGN IN SECTION */}
      
          <div className="contactForm-container p-lg-5">
            <div className="container">
              <div className="p-4 bg-white">
                <form className="contactForm" onSubmit={handleSubmit}>
                  <div className="w-100 w-lg-75 mx-auto text-center text-grey">
                    <h2 className="text-center m-4 text-black fw-bold pt-5">Sign in</h2>

                    <div className="logosLogin text-center d-flex justify-content-center">
                  <a href={`${import.meta.env.VITE_API_URL}/auth/google`}>
                       <i className="fa-brands fa-google fa-2x p-3"></i></a>
                      <i className="fa-brands fa-facebook fa-2x p-3"  ></i>
                      <i className="fa-brands fa-instagram fa-2x p-3"></i>
                    </div>

                    <h5 className="text-center m-4 text-grey">Or use your email account :</h5>

                    <label htmlFor="mail" className="form-label text-center text-grey fs-4 me-3">
                      Email
                    </label>
                    <input type="email" className="form-control rounded-pill bg-white border border-grey text-center"
                      id="mail" value={mail} onChange={(e) => setmail(e.target.value)} />


                    <label htmlFor="password" className="form-label fs-4 me-3 mt-3">
                      Password
                    </label>
                    <input  type="password"  className="form-control rounded-pill bg-white border border-grey text-center"
                      id="password" value={password} 
                      onChange={(e) => setPassword(e.target.value)} placeholder="Min 4 characters" />
                  </div>


                  <div className="text-center">
                    <button type="submit" className="btn mx-3 fs-5 px-3 mt-4 btn-warning rounded-pill">
                      Sign in
                    </button>
                  </div>
                </form>
              </div>
                    <p className="text-center">{message}</p>

                    
                  <div className="text-center my-3">
                    {/* <a href="">forget your password?</a> */}
                    <ForgetPassword/>
                  </div>

            </div>
          </div>

          {/* OPEN SIGN UP */}
          {!showSignup && (
        <>
          <div className="signupSection py-3">
            <div className="container py-5">
              <div className="p-4 border rounded-4 shadow-sm text-white text-center background-perso">
                <div className="addMargin">
                  <h2 className="m-3 p-3 fw-bold">Hello there, join us</h2>
                  <h5 className="m-3 p-3">Enter your personal details, and join the cooking community</h5>

                  <button
                    type="button"
                    onClick={() => setShowSignup(true)}
                    className="btn fs-5 p-3 m-3 bg-white rounded-pill"
                  >
                    Sign Up
                  </button>
                </div>
              </div>
            </div>
          </div>

        </>
      )}

      {/* SIGN UP SECTION */}
      {showSignup && (<> <Signup setShowSignup={setShowSignup} />
             </>)}

    </div>
  );
}
</file>

<file path="recipeProjectHTML/frontend/contact.html">
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Encodage -->
    <meta charset="UTF-8">
    <!-- Responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- secu -->
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <!-- SEO -->
    <meta name="description" content="site de recettes collaboratif">
    <meta name="keywords" content="recettes, cuisine, recipes,cook">
    <meta name="author" content="corentin">

    <link rel="icon" href="favicon.webp">

        <!-- Open Graph -->
    <meta property="og:title" content="Recipes App">
    <meta property="og:description" content="See, and create recipes">
    <meta property="og:type" content="website">
    <meta property="og:image" content="favicon.webp">
    <meta property="og:url" content="https://corenchan.de">

      <!-- Performance -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <!-- Fonts (chargement optimisé) -->
  <link rel="preload" href="/fonts/Inter.woff2" as="font" type="font/woff2" crossorigin>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="script.js" defer></script>
  <script src="search.js" defer></script>


  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="styleResp.css"> 
  <link rel="stylesheet" href="animation.css"> 

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title> Contact </title>
</head>
<body>

  
  <!--navigation bar -->
    <!--button to hide and show menu on mobile -->

    <nav class="navbar navbar-expand-sm navbar-white bg-white"> 
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
      <!--text to collapse -->
    <div class="collapse navbar-collapse" id="mynavbar">
      <ul class="navbar-nav me-auto">
          <li class="nav-item  ">
          <a class="nav-link fs-5 urlActive" href="home.html">Home</a>
        </li>
        <li class="nav-item  ">
          <a class="nav-link text-black fs-5" href="recipe.html">Recipe</a>
        </li>
        <li class="nav-item ">
          <a class="nav-link text-black fs-5" href="search.html">Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-black fs-5 " href="contact.html">Contact</a>
        </li>
           <li class="nav-item">
          <a class="nav-link text-black fs-5 urlCustom2" href="login.html">Sign in</a>
        </li>
      </ul>
      <form class="d-flex">
         <a class="nav-link fs-5 urlCustom" href="javascript:void(0)"></a>
        <!--
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
        !-->
    
      </form>    

    </div>
      <!--right side of nav with button and link always visible-->
          <div class="rightNav">
            <input type="text" class="form-control searchWindow mt-2 " placeholder="Search" id="searchWindow" aria-label="Search"
              aria-describedby="basic-addon1">
          
            <i class="fa-solid fa-magnifying-glass fa-lg m-4 mx-3  clickable " id="searchButton"></i>
            <!--
                  <a class="nav-link fs-5 urlCustom" href=""  >Sign in</a>
                  -->
            <button class="btn  fs-5 rounded-pill mx-2 btnCustom2" id="signinButton" type="button">Sign in</button>
            <button class="btn btn-primary fs-5 rounded-pill mx-2 btnCustom  " type="button">Sign up</button>
          
          
          </div>
  
        </div>
  </div>
</nav>


<!--presentation section with text and link-->
      <div class = "d-lg-flex contactGroup  " >

<section class=" contactText py-3 ">

  <div class=" container py-5">
    <div class="p-3 ms-lg-5  text-black">
    <h1>Hello , What's on your mind?</h1>
    <h4 class="mb-3 text-black-50"> Credibly administrate market positioning deliverables rather than clicks-and-mortars methodologies. Proactiverly formulate out-of-the-box technology with click-and-mortar testing procedures. Uniquely promote leveraged web readiness for standart compliant value. Rapidiously ponctifate cooperative mindshare via maintenable applications
    </h4>
        <button type="button" class="btn  fs-5 px-3  btn-danger rounded-pill">Schedule a call</button>

    </div>
  </div>

</section>


<!--subscribe email form  -->
<section class="contactForm-container p-lg-5">

  <div class=" container ">
  <div class="p-4 border rounded-4 shadow-sm text-white bg-danger">

    <form class=" contactForm ">
      <div class="  w-100 w-lg-75 mx-auto">
        <label for="name" class="form-label fs-4 me-3">name</label>
        <input type="text" class="form-control rounded-pill bg-danger border border-white text-white" id="name" >
        
        <label for="mail" class="form-label fs-4 me-3 mt-3">Email</label>
        <input type="text" class="form-control rounded-pill bg-danger border border-white text-white" id="mail" >
      
        <label for="message" class="form-label fs-4 me-3 mt-3 ">message</label>
        <input type="text" class="form-control rounded-4 bg-danger border border-white text-white  messageForm" id="message">
  
   
      </div>
      <div class=" text-center">
       <button type="submit" class="btn mx-3 fs-5 px-3 mt-3 btn-warning  rounded-pill">Send message</button>
    </div>

    </form>
  </div>
</div>

</section>
</div>


<footer>
<!--footer with logos and links -->

<!--logos with fontawesome-->
  <div class="logos me-5 pe-lg-5">
<i class="fa-brands fa-facebook fa-2x p-3" ></i>
<i class="fa-brands fa-instagram fa-2x p-3"></i>
<i class="fa-brands fa-twitter fa-2x p-3"></i>

  </div>

  <div class="container mt-3">           
  <div class="table-perso">

      <ul>
        <li><a href="">Presentations</a></li>
        <li><a href="">Profesionals</a></li>
        <li><a href="">Stores</a></li>
      </ul>
              <ul>
         <li><a href="">Webinars      </a></li>
          <li ><a href="">Workshops</a></li>
         <li><a href="">Local Meetups</a></li>
      </ul>
        <ul>
         <li><a href="">Ours initiative</a></li>
          <li><a href="">Giving Back</a></li>
         <li><a href="">Communities</a></li>
      </ul>
        <ul>
        <li><a href="">Contact Form</a></li>
        <li><a href="">Work with us</a></li>
        <li><a href="">Visit us</a></li>
      </ul>
             

</div>

  <p class="textTab">Made by C.C</p> 


</footer>

<!--sign in window hidden by default -->
<div class="overlay" id="overlay">
  <div class="signWindow" id="signWindow">
    <button type="button" class="btn btn-danger btnClose" aria-label="Close" id="closeSignWindow" onclick="signinClose()">X</button>
    <iframe src="login.html" width="100%" height="100%" style="border:none;"></iframe>
  </div>
</div>


</body>
</html>
</file>

<file path="recipeProjectHTML/frontend/login.html">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
   <link rel="stylesheet" href="style.css"> 
      <link rel="stylesheet" href="styleResp.css"> 
    
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Sign in</title>
</head>
<body>

  

<!--presentation section with text and link-->
      <div class = "d-lg-flex contactGroup  "  >

      

<section class="contactForm-container p-lg-5 " >

  <div class=" container " >
  <div class="p-4  bg-white">

    <form class=" contactForm ">
      <div class="  w-100 w-lg-75 mx-auto text-center text-grey">
        <h2 class="text-center m-4 text-black fw-bold pt-5">Sign in</h2>
            <div class="logosLogin text-center d-flex justify-content-center">
    
            <i class="fa-brands fa-facebook fa-2x p-3"  ></i>
            <i class="fa-brands fa-instagram fa-2x p-3"></i>
            <i class="fa-brands fa-twitter fa-2x p-3"></i>

              </div>

        <h5 class="text-center m-4 text-grey">Or use your email account : </h5>
        <label for="mail" class="form-label text-center text-grey fs-4 me-3">Email</label>
        <input type="text" class="form-control rounded-pill bg-white border border-grey text-center text-white" id="name" placeholder="tom@company.com" >
        
        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="text" class="form-control rounded-pill bg-white border border-grey text-center text-white" id="password" placeholder="Min 8 characters" >
      
      </div>

      <div class=" text-center my-3">
        <a href="" >forget your password?</a>
      </div>

      <div class=" text-center">
       <button type="submit" class="btn mx-3 fs-5 px-3 mt-3 btn-warning  rounded-pill" aria-label="submit login">Sign in</button>
    </div>

    </form>

  </div>
</div>


</section>


<section class=" signupSection py-3 " id="overlay1">

  <div class=" container py-5">
  <div class="p-4 border rounded-4 shadow-sm text-white text-center background-perso">
  <div class="  addMargin">
    <h2 class="m-3 p-3 fw-bold ">Hello there, joins us</h2>
    <h5 class="m-3 p-3 ">Enter your personal details, and join the cooking community</h5>
        <button type="button" class="btn  fs-5 p-3 m-3  bg-white rounded-pill " id="signupButton" aria-label="signup">Sign Up</button>
  </div>
    </div>
  </div>


</section>
      

<!--singup div -->
  
  <div class=" container signup2 mt-5 text-white" id="overlay2" >

  <div class="p-4  bg-danger rounded-5 my-5">

    <form class=" contactForm  ">
      <div class="  mx-auto text-center text-grey formAlign">
        <h2 class="text-center m-4 fw-bold pt-2">Sign up</h2>
            
        <h5 class="text-center m-3 text-white">Join us and add your own recipes and many more! </h5>
        
        <label for="pseudo" class="form-label  text-center text-grey fs-4 me-3 ">Pseudo</label>
        <input type="text" class="form-control text-center   w-50 rounded-pill bg-white border border-grey text-center text-white" id="name" placeholder="tom@company.com" >
        

        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="text" class="form-control text-center  w-50 rounded-pill bg-white border border-grey text-center text-white" id="password" placeholder="Min 8 characters" >
      
        <label for="mail" class="form-label text-center text-grey fs-4 me-3 mt-3">Email</label>
        <input type="text" class="form-control w-75 rounded-pill bg-white border border-grey text-center text-white " id="name" placeholder="tom@company.com" >

      </div>

      <div class=" text-center my-3">
      </div>

      <div class=" text-center">
       <button type="submit" class="btn mx-3 fs-5 px-3 mt-3 mb-4 btn-warning  rounded-pill" aria-label="signup">Sign up</button>
    </div>

    </form>
  </div>
</div>
</div>

      </div>


          
  

</div>



  <script >
//display signin page


//display signup div
document.getElementById("signupButton").addEventListener("click", function() {
  document.getElementById("overlay2").style.display = "block";
        document.getElementById("overlay1").style.display = 'none';

});

function signupClose() {
  document.getElementById('overlay2').style.display = 'none';
}



</script>


</body>
</html>
</file>

<file path="recipeProjectHTML/frontend/recipe.html">
<!DOCTYPE html>
<html lang="en">
<head>
     <!-- Encodage -->
    <meta charset="UTF-8">
    <!-- Responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- secu -->
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <!-- SEO -->
    <meta name="description" content="site de recettes collaboratif">
    <meta name="keywords" content="recettes, cuisine, recipes,cook">
    <meta name="author" content="corentin">

    <link rel="icon" href="favicon.webp">

        <!-- Open Graph -->
    <meta property="og:title" content="Recipes App">
    <meta property="og:description" content="See, and create recipes">
    <meta property="og:type" content="website">
    <meta property="og:image" content="favicon.webp">
    <meta property="og:url" content="https://corenchan.de">

      <!-- Performance -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <!-- Fonts (chargement optimisé) -->
  <link rel="preload" href="/fonts/Inter.woff2" as="font" type="font/woff2" crossorigin>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="script.js" defer></script>
  <script src="search.js" defer></script>


  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="styleResp.css"> 
  <link rel="stylesheet" href="animation.css"> 

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Home</title>
</head>
<body>

    <!--navigation bar -->
    <!--button to hide and show menu on mobile -->

    <nav class="navbar navbar-expand-sm navbar-white bg-white"> 
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
      <!--text to collapse -->
    <div class="collapse navbar-collapse" id="mynavbar">
      <ul class="navbar-nav  me-auto mb-3  ">
          <li class="nav-item  ">
          <a class="nav-link fs-5 urlActive" href="home.html">Home</a>
        </li>
        <li class="nav-item  ">
          <a class="nav-link text-black fs-5" href="recipe.html">Recipe</a>
        </li>
        <li class="nav-item ">
          <a class="nav-link text-black fs-5" href="search.html">Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-black fs-5 " href="contact.html">Contact</a>
        </li>
           <li class="nav-item ">
          <a class="nav-link text-black fs-5  pb-1 mb-2 pb-lg-0 mb-lg-0 border-0 urlCustom2" onclick="displaySignin();signupClose();">Sign in</a>
        </li>
      </ul>
      <form class="d-flex">
         <a class="nav-link fs-5 urlCustom" href="javascript:void(0)"></a>
        <!--
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
        !-->
    
      </form>    

    </div>
      <!--right side of nav with button and link always visible-->
          <div class="rightNav">
            <input type="text" class="form-control searchWindow mt-2 " placeholder="Search" id="searchWindow" aria-label="Search"
              aria-describedby="basic-addon1">
          
            <i class="fa-solid fa-magnifying-glass fa-lg m-4 mx-3 clickable " id="searchButton"></i>
            <!--
                  <a class="nav-link fs-5 urlCustom" href=""  >Sign in</a>
                  -->
            <button type="button" class="btn btnAc fs-5 rounded-pill mx-2 btnCustom2 " id="signinButton" onclick="displaySignin();signupClose();" >Sign in</button>
            <button type="button" class="btn  btnAc btn-primary fs-5 rounded-pill mx-2 btnCustom " id ="signupButton" onclick="displaySignup()" >Sign up</button>
          
          
          </div>
  </div>
</nav>

<!--Recipe Description-->
<section class="recipeTitle row gx-0">

  <div class="d-lg-flex container ">
        <!--img-->
        <div class="col-lg-6">
        <div class=" justify-content-center  image-container">
        <img src="https://picsum.photos/400/250?random=6" class=" tilt1  pt-3 rounded-5 recipePhoto" alt="image">
        </div>
          </div>
        <!--description-->
         <div class="col-lg-6" >
    <div class=" pt-3 descriptionRecipe">
            <!--title-->
    <h1 class="fade-in">Your favorite recipe</h1>
    <p class="text-black-50  fs-4">un magnigique plat avec des pommes de terre riches en féculents</p>

    <!--Recipe info-->
    <div class="d-flex text-center  descriptionLogos border-bottom">
        <div class="logo1  p-3 mx-2  m-lg-3 px-lg-5 text-center border-end">
       <i class="fa-regular fa-clock fs-3 rotatec"></i>
       <p class="m-0 p-0" >Active time</p>
        <p class="m-0 p-0 text-black-50 " id="activeTime">20mn</p>
        </div>
        <div class="logo2  p-3 mx-2 m-lg-3 px-lg-5 text-center border-end">  
        <i class="fa-solid fa-clock-rotate-left fs-3 rotatec"></i>
        <p class="m-0 p-0" >Total time</p>
        <p class="m-0 p-0 text-black-50 " id="totalTime">40mn</p>
        </div>
        <div class="logo3 p-3 mx-2 m-lg-3 px-lg-5 text-center">        
        <i class="fa-solid fa-users fs-3"></i>
        <p class="m-0 p-0" >Yield</p>
        <p class="m-0 p-0 text-black-50" id="yield"> Serves 2</p>
        </div>
    </div>


    <div class="d-flex mt-5 bottomDescription">
    
    <div class="container">
    <p class="m-0 p-0">Created by <span class="text-danger" id="author">Corentin CHAN</span> </p>
    <p class="m-0 p-0 text-black-50" id="nbRecipes">21recipes </p>
    </div>
    
       <div class="d-flex justify-content-center ">
         <i class="fa-regular fa-plus fs-3 mx-3 clickable"></i>
        <i class="fa-solid fa-cart-arrow-down fs-3 mx-3 clickable"></i>
        <i class="fa-solid fa-print fs-3 mx-3 clickable" id="print"></i>
    </div>
    </div>
    
         </div>


    </div>
  </div>
</section>

  <section class="m-1 p-1 m-lg-5 p-lg-3 makeRecipe-container">

        <!--left section with instructions and  comments-->
<div class="recipeLeft">
    <div class="recipeSteps">
        <h2 class=" mt-5  my-lg-0">How to make it</h2>
    <ol class="mt-lg-4 list-group instructionsList"  >
        <li class=" d-flex border-0 " > <i class="fa-regular fa-circle-check fs-2 me-3 "></i> <h4 class="text-danger pt-1">1.STEP</h4><div class="container-fluid border-top m-3 me-5"></div> </li>
        <li class="list-group-item border-0 border-bottom-1 mx-5  text-black-50 fs-5" >  couper les oignons Puis couper les oignon couper les oignons Puis couper les oignons couper les oignons Puis couper les oignons couper les oignons Puis couper les oignons couper les oignons Puis couper les oignonss</li>

        <li class=" d-flex border-0" > <i class="fa-regular fa-circle-check fs-2 me-3 "></i> <h4 class="text-danger pt-1">2.STEP</h4><div class="container-fluid border-top m-3 me-5"></div> </li>
        <li class="list-group-item border-0 mx-5  text-black-50 fs-5" >  couper les oignons Puis couper les oignon couper les oignons Puis couper les oignons couper les oignons Puis couper les oignons couper les oignons Puis couper les oignons couper les oignons Puis couper les oignonss</li>
        
        <li class=" d-flex border-0" > <i class="fa-regular fa-circle-check fs-2 me-3 "></i> <h4 class="text-danger pt-1">3.STEP</h4><div class="container-fluid border-top m-3 me-5"></div> </li>
        <li class="list-group-item border-0 mx-5  text-black-50 fs-5" >  couper les oignons Puis couper les oignon couper les oignons Puis couper les oignons couper les oignons Puis couper les oignons couper les oignons Puis couper les oignons couper les oignons Puis couper les oignonss</li>

    </ol>
    </div>

        <!--comms tab-->
     <div class="comments mt-lg-5 pt-5  ">
      <h3>Comments</h3>

      <div class="list-group p-lg-3">
          <div class="list-group-item" aria-current="true">
            <div class=" w-100 justify-content-between">
              <img src="">
              <h5 class="mb-1">CHAN Corentin</h5>
              <small class="text-black-50">3 days ago</small>
              <div><span class=""><i class="fa-solid fa-star">  </i> <i class="fa-solid fa-star">  </i> <i class="fa-solid fa-star">  </i> <i class="fa-solid fa-star">  </i>
              <i class="fa-regular fa-star"></i></span></div>
            </div>
            <p class="my-1 py-3">Ce plat est vraiment bon et riche en patate</p>
          </div>
      </div>

      <div class="list-group p-lg-3 com-container2" >
          <div class="list-group-item  bg-danger-subtle" aria-current="true">
            <div class=" w-100 justify-content-between">
              <img src="">
              <h5 class="mb-1">CHAN Corentin</h5>
              <small class="text-black-50">3 days ago</small>
              <div><span class=""><i class="fa-solid fa-star">  </i> <i class="fa-solid fa-star">  </i> <i class="fa-solid fa-star">  </i> <i class="fa-solid fa-star">  </i>
              <i class="fa-regular fa-star"></i></span></div>
            </div>
            <p class="my-1 py-3">Ce plat est vraiment bon et riche en patate</p>
          </div>
      </div>
  
 

      <div class="list-group p-lg-3">
          <div class="list-group-item" aria-current="true">
            <div class=" d-flex w-100 justify-content-between">
              <div class="d-flex"><i class="fa-solid fa-star p-3"></i> <select class="form-select form2" >
  <option selected disabled>Give a note</option>
       <option>1</option>
     <option>2</option>
     <option>3</option>
     <option>4</option>
      <option>5</option>
   </select>
            </div>
            </div>
            <p class="my-1 py-3">  <form action="">
    <div class=" ">
      <label for="comment">Comments:</label>
      <textarea class="form-control" rows="5" id="commentForm" name="text"></textarea>
    </div>
    <button type="submit" class="btn mt-3 btn-primary ">Submit</button>
  </form></p>
          </div>
      </div>
      

    </div>

</div>

<!-- right section with ingredients&co-->
<div class="recipeRight">

    <!--ingredients tab-->
    <div class="mt-5 mt-lg-0 recipeIngredients">
    <h2>Ingredients</h2>
    <ul class="list-group ingredientsList" >
        <li class="list-group-item border-0 border-bottom" > 3kg oignons</li>
        <li class="list-group-item border-0 border-bottom" > 3kg patates</li>
        <li class="list-group-item border-0 " > 3kg ingredient1</li>
           <li class="list-group-item border-0 border-bottom" > 3kg oignons</li>
        <li class="list-group-item border-0 border-bottom" > 3kg patates</li>
        <li class="list-group-item border-0 " > 3kg ingredient1</li>
           <li class="list-group-item border-0 border-bottom" > 3kg oignons</li>
        <li class="list-group-item border-0 border-bottom" > 3kg patates</li>
        <li class="list-group-item border-0 " > 3kg ingredient1</li>
    </ul>
    </div>

    <!--tags tab-->
    <div class=" pt-3 mt-3">
      <h3 >Tags</h3>
      <div class="tags">
      <span class="badge text-bg-primary m-2 fs-5">Primary</span>
      <span class="badge text-bg-primary m-2 fs-5">Primary</span>
      <span class="badge text-bg-primary m-2 fs-5">Primary</span>
      <span class="badge text-bg-primary m-2 fs-5">Primary</span>
      </div>  

    </div>

        <!--share recipe tab-->
    <div class="shareRecipe pt-3 mt-3">
      <h3 >Share recipes</h3>
  <div class="d-flex justify-content-center me-5 pe-lg-5">
<i class="fa-brands fa-facebook fa-2x p-3" ></i>
<i class="fa-brands fa-instagram fa-2x p-3"></i>
<i class="fa-brands fa-twitter fa-2x p-3"></i>

  </div>
    </div>


</div>  

  </section>

<!--4 videos recommanded -->
<section class="videoSection2 container-fluid py-5   ">

  <div class="videoTitle m-3 m-lg-5 ">
<h2>Others videos you may like</h2>

  </div>

<div class="videos-container m-lg-5"  id="videos-container">
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text text-black-50">By Corentin Chan</p>
    </div>
  </div>
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>

</div>


<div class="videos-container m-lg-5" id="videos-container2" >
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
    <div class="d-flex justify-content-between"><span class=""><i class="fa-solid fa-star"></i>5</span><span class="card-text">By Corentin Chan</p> </div>
    </div>
  </div>

  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
    <div class="d-flex justify-content-between"><span class=""><i class="fa-solid fa-star"></i>5</span><span class="card-text">By Corentin Chan</p> </div>
    </div>
  </div>

  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
    <div class="d-flex justify-content-between"><span class=""><i class="fa-solid fa-star"></i>5</span><span class="card-text">By Corentin Chan</p> </div>
    </div>
  </div>

    <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
    <div class="d-flex justify-content-between"><span class=""><i class="fa-solid fa-star"></i>5</span><span class="card-text">By Corentin Chan</p> </div>
    </div>
  </div>

</div>

</section>


<footer>
<!--footer with logos and links -->

<!--logos with fontawesome-->
  <div class="logos me-5 pe-lg-5">
<i class="fa-brands fa-facebook fa-2x p-3" ></i>
<i class="fa-brands fa-instagram fa-2x p-3"></i>
<i class="fa-brands fa-twitter fa-2x p-3"></i>

  </div>

  <div class="container mt-3">           
  <div class="table-perso">

      <ul>
        <li><a href="">Presentations</a></li>
        <li><a href="">Profesionals</a></li>
        <li><a href="">Stores</a></li>
      </ul>
              <ul>
         <li><a href="">Webinars      </a></li>
          <li ><a href="">Workshops</a></li>
         <li><a href="">Local Meetups</a></li>
      </ul>
        <ul>
         <li><a href="">Ours initiative</a></li>
          <li><a href="">Giving Back</a></li>
         <li><a href="">Communities</a></li>
      </ul>
        <ul>
        <li><a href="">Contact Form</a></li>
        <li><a href="">Work with us</a></li>
        <li><a href="">Visit us</a></li>
      </ul>
             

</div>

  <p class="textTab">Made by C.C</p> 


</footer>



<!--Signin Div-->
<div class="overlay" id="overlay1">
  <div class="signWindow" id="signWindow">
    <button type="button" class="btn btnAc border text-center btn-danger btnClose" aria-label="Close" id="closeSignWindow" onclick="signinClose()">X</button>
    <iframe src="login.html" width="100%" height="100%" style="border:none;"></iframe>
  </div>
</div>

<!-- sign up div -->
<div class="overlay3" id="overlay2">

  <div class=" container signup  ">
      <button type="button" class="btn btnAc text-center btn-danger border p-1  btnClose2" aria-label="Close" id="closeSignupWindow" onclick="signupClose()">X</button>

  <div class="p-4  bg-danger border text-white rounded-5">

    <form class=" contactForm  ">
      <div class="  mx-auto text-center text-grey formAlign">
        <h2 class="text-center m-3  fw-bold pt-2">Sign up</h2>
        <a class="text-center m-3 " onclick="displaySignin();signupClose();">Have already an account? Click here to connect!</a>
   
        <h5 class="text-center m-3 ">Join us and add your own recipes and many more! </h5>
        <label for="mail" class="form-label text-center text-grey fs-4 me-3">Email</label>
        <input type="text" class="form-control rounded-pill text-black bg-white border border-grey text-center " id="name" placeholder="tom@company.com" >

        <label for="mail" class="form-label  text-center text-grey fs-4 me-3 mt-3">Pseudo</label>
        <input type="text" class="form-control text-center text-black  w-50 rounded-pill bg-white border border-grey text-center " id="name" placeholder="tom@company.com" >
        

        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="text" class="form-control text-center text-black  w-50 rounded-pill bg-white border border-grey text-center " id="password" placeholder="Min 8 characters" >
      
      </div>

      <div class=" text-center my-3">
      </div>

      <div class=" text-center">
       <button type="submit" class="btn btnAc mx-3 fs-5 px-3 mt-3 btn-warning  rounded-pill">Sign up!</button>
    </div>

    </form>
  </div>
</div>

</div>
</div>


</body>
</html>
</file>

<file path="recipe-reactnode-app/src/components/home/homeNav.jsx">
export default function  HomeNav({keyword,setKeyword}) {

return ( 
  
    <div className="recipeMenu my-4">
      <h2 className="ms-4 "> Recipes</h2>
      
    <div className="container mt-3 ">

     <div className="accordion" id="menuAccordion">

    <div className="accordion-item">
      <h2 className="accordion-header">
        <button className="accordion-button bg-light fs-4" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true">
          Dishes
        </button>
      </h2>
      <div id="collapseOne" className="accordion-collapse collapse show" data-bs-parent="#menuAccordion">
        <div className="accordion-body">
          <a className="textSearchMenu" onClick={()=>setKeyword('breakfast')}>Breakfast</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('pasta')}>Pasta</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('beef')}>Beef</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('chicken')}>Chicken</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('seafood')}>Sea Food</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('side')}>Side</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('dessert')}>Dessert</a>


        </div>
      </div>
    </div>

    <div className="accordion-item">
      <h2 className="accordion-header">
        <button className="accordion-button bg-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false">
         World Food
        </button>
      </h2>
      <div id="collapseTwo" className="accordion-collapse collapse" data-bs-parent="#menuAccordion">
        <div className="accordion-body">
          <a className="textSearchMenu" onClick={()=>setKeyword('chinese')}>Chinese</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('Turkish')}>Turkish</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('Indian')}>Indian</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('Thai')}>Thai</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('Moroccan')}>Moroccan</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('Mexican')}>Mexican</a>
          <a className="textSearchMenu" onClick={()=>setKeyword('japanese')}>Japanese</a>

        </div>
      </div>
    </div>

    <div className="accordion-item">
      <h2 className="accordion-header">
        <button className="accordion-button bg-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false">Others
        </button>
      </h2>
      <div id="collapseThree" className="accordion-collapse collapse" data-bs-parent="#menuAccordion">
        <div className="accordion-body">
           <a className="textSearchMenu" onClick={()=>setKeyword('vegan')}>Vegan</a>
           <a className="textSearchMenu" onClick={()=>setKeyword('Vegetarian')}>Vegetarian</a>
        </div>
      </div>
    </div>

  </div>



    </div>
</div>
)
 }
</file>

<file path="recipe-reactnode-app/src/components/account/recipesList.jsx">
import { useState,useEffect } from 'react';
  import CardUser from '../cardUser'
  import imgCard from '../images/background1.png'

  import axios from 'axios';
  import { useLocation } from "react-router-dom";
import { useNavigate } from "react-router-dom";


 export default function  RecipesList() {
  // const location=useLocation();
   const navigate=useNavigate();
const [recipes,setRecipes]=useState([]);

         async function getRecipes(){ 
          const response = await axios.get(import.meta.env.VITE_API_URL+"/getRecipesList", {
          headers: {
            "Content-Type": "application/json",
          },
        withCredentials: true,    
             });
          const data = response.data;
        console.log("Réponse backend account:", data);
             setRecipes(data.recipesList);
    
            }

   useEffect(() => {         
          getRecipes();
      }, []);

       async function deleteSubmit(recipeID){
          //let recipeID = e.target.value;
          let type = "favoris";
          console.log(recipeID);
                try {

        const { data } = await axios.post(
          import.meta.env.VITE_API_URL + "/deleteRecipeList",
          {
            recipeID,
            type,
          },
          {
            headers: {"Content-Type": "application/json",},
            withCredentials: true,
          }
        );

        //setMessage(data.message);
        console.log("Réponse backend delete list :", data);

        if (data.check) {
          console.log("delete recipelist")
        getRecipes();

        }
      } catch (error) {
        console.error("Erreur lors de la connexion :", error);
         //setMessage(error.response?.data?.message || "Erreur réseau");
      }
  

      }


return ( 
 <div className=" container-fluid py-5" id="fav">

  <div className="videoTitle m-3 m-lg-5 justify-content-center">
    <h2 className="bg-danger-subtle text-danger border rounded-pill p-2">
      Your favorites recipes
    </h2>
  </div>

    <div className=" m-lg-5 d-flex flex-nowrap  overflow-x z-5" id="videos-container">

      {recipes&&recipes.map( (recipe,index)=> {
                  const recipeID = String(recipe.id);
       return( <div key={`recipeList ${recipeID}`} className="cardExt">
        <CardUser  id={recipeID} title={recipe.title} 
        img={recipe.image?recipe.image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRwAdnj607fkyztZ3TkKVTdEy-FG-tD-gEGJQ&s"}
         />
        <div className="d-flex flex-column flex-lg-row justify-content-around ">
        
      <button className="btn  text-center rounded-pill mx-1  mb-2 bg-danger border border-black" 
          name="deleteOwn" onClick={() => deleteSubmit(recipeID)}>Delete</button>
          </div>
      </div>   )  
      })}
</div>
</div>

)
 }
</file>

<file path="recipe-reactnode-app/src/components/recipe/commentaires.jsx">
import favicon from '../images/favicon.png';
import { useNavigate } from "react-router-dom";
import { createContext, useState, useEffect } from "react";
import axios from 'axios';


export default function Commentaires({recipeID,udpateForm,userRole}){
const [comments,setComments]=useState([])
const navigate=useNavigate();



async function fetchComment() {

  
      try {
        const { data } = await axios.post(
          import.meta.env.VITE_API_URL + "/getComment",
          {
            recipeID,
          },
          {
            headers: {"Content-Type": "application/json",},
            withCredentials: true,
          }
        );
        setComments(data.comment);
        console.log("Réponse backend comm :", data);

 
      } catch (error) {
        console.error("error axios :", error);
      }
    }

    useEffect(() => {
      console.log(recipeID);
    fetchComment();
  }, [recipeID]);

      useEffect(() => {
    fetchComment();
  }, [udpateForm]);

  async function deleteCom(e){
    e.preventDefault();
    const recipeID= e.target.recipeID.value;
    const pseudoID = e.target.pseudoID.value;

    try {
        const { data } = await axios.post(
          import.meta.env.VITE_API_URL + "/deleteCommAdmin",
          {
            recipeID,pseudoID
          },
          {
            headers: {"Content-Type": "application/json",},
            withCredentials: true,
          }
        );
        console.log("Réponse backend comm :", data);
        if(data.check) fetchComment();
 
      } catch (error) {
        console.error("error axios :", error);
      }


  }

    return(
 <div className="comments mt-lg-5 pt-5 noprint" id='commentPart'   >
      <h3>Comments</h3>

   {comments&& comments.map((comment,index) => (

 <div key={comment.index} className={index%2?"list-group p-lg-3 com-container2": "list-group p-lg-3"}>

          <div className= {index%2?'list-group-item  bg-danger-subtle':'list-group-item '} aria-current="true">

            <div className=" w-100 justify-content-between">

              <div className="d-flex ">

              <img className="imageComm fs-1 mx-lg-0 me-2 me-lg-3 py-1   rounded-circle" 
              src={comment.image?comment.image:'https://picsum.photos/400/250?random=1'}/>
               
               <div className="d-flex flex-column mt-2 mt-lg-3">
              <h5 className={`mb-1 ${userRole === 'admin' ? 'text-info' : ''}`}>{comment.pseudo}</h5> 
              {userRole==="admin"&&(<p>id : {comment.userID} , {comment.mail} </p>) }
              <small className="text-black-50">{comment.date}</small>
              <div> <span className="">
                { comment.note&&[...Array(5)].map((_, i) => (
                      comment.note > i ? (
                        <i key={i} className="fa-solid fa-star"></i>
                      ) : (
                        <i key={i} className="fa-regular fa-star"></i>
                      )
                    ))}

                </span></div>
            </div>          
            </div>

            <p className="my-1 py-3">{comment.commentaire}</p>
      </div>

        {  userRole==="admin"&&(
                      <form class="justify-content-center" method="post" onSubmit={deleteCom}>
                      <button type="submit" class="btn bg-danger text-center rounded-pill border-black border-1" >Delete comment</button>
                      <input hidden name="pseudoID" value={comment.userID } />
                      <input hidden name="recipeID" value={recipeID} />
                      </form>     
                        )}
        </div>
      </div>

              ))
            }
      
     


      

    </div>

    );
}
</file>

<file path="recipeProjectHTML/frontend/home.html">
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Encodage -->
    <meta charset="UTF-8">
    <!-- Responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- secu -->
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <!-- SEO -->
    <meta name="description" content="site de recettes collaboratif">
    <meta name="keywords" content="recettes, cuisine, recipes,cook">
    <meta name="author" content="corentin">

    <link rel="icon" href="favicon.webp">

        <!-- Open Graph -->
    <meta property="og:title" content="Recipes App">
    <meta property="og:description" content="See, and create recipes">
    <meta property="og:type" content="website">
    <meta property="og:image" content="favicon.webp">
    <meta property="og:url" content="https://corenchan.de">

    <meta name="google-site-verification" content="_TG0jasIOQXxC9VKWXacxzHbftuBUvYGZokNdFhZJu8" />

      <!-- Performance -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <!-- Fonts (chargement optimisé) -->
  <link rel="preload" href="/fonts/Inter.woff2" as="font" type="font/woff2" crossorigin>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="script.js" defer></script>
  <script src="search.js" defer></script>


  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="styleResp.css"> 
  <link rel="stylesheet" href="animation.css"> 

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title>Recipe Home</title>
</head>
<body>

  <!--navigation bar -->
    <!--button to hide and show menu on mobile -->

    <nav class="navbar navbar-expand-sm navbar-white bg-white"> 
  <div class="container-fluid">
    <button aria-label="mobile navnar" class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
      <!--text to collapse -->
    <div class="collapse navbar-collapse" id="mynavbar">
      <ul class="navbar-nav  me-auto mb-3  ">
          <li class="nav-item  ">
          <a class="nav-link fs-5 urlActive" href="home.html">Home</a>
        </li>
        <li class="nav-item  ">
          <a class="nav-link text-black fs-5" href="recipe.html">Recipe</a>
        </li>
        <li class="nav-item ">
          <a class="nav-link text-black fs-5" href="search.html">Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-black fs-5 " href="contact.html">Contact</a>
        </li>
           <li class="nav-item ">
          <a class="nav-link text-black fs-5  pb-1 mb-2 pb-lg-0 mb-lg-0 border-0 urlCustom2" onclick="displaySignin();signupClose();">Sign in</a>
        </li>
      </ul>
      <form class="d-flex">
         <a class="nav-link fs-5 urlCustom" href="javascript:void(0)"></a>
        <!--
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
        !-->
    
      </form>    

    </div>
      <!--right side of nav with button and link always visible-->
          <div class="rightNav">
            <input type="text" class="form-control searchWindow mt-2 " placeholder="Search" id="searchWindow" aria-label="Search"
              aria-describedby="basic-addon1">
          
            <i class="fa-solid fa-magnifying-glass fa-lg m-4 mx-3 clickable " id="searchButton"></i>
            <!--
                  <a class="nav-link fs-5 urlCustom" href=""  >Sign in</a>
                  -->
            <button type="button" class="btn btnAc fs-5 rounded-pill mx-2 btnCustom2 " id="signinButton" aria-label="sihnin"
             onclick="displaySignin();signupClose();" >Sign in</button>
            <button type="button" class="btn  btnAc btn-primary fs-5 rounded-pill mx-2 btnCustom " aria-label="signup"
            id ="signupButton" onclick="displaySignup()" >Sign up</button>
          
          
          </div>
  </div>
</nav>

<!--presentation section with text and link-->
<section class="signup-container tilt1 ">

  <div class=" container-fluid ms-2 ms-lg-5 my-5 " >
  <div class="p-4 border rounded-4 shadow-sm text-white background-perso">
    <div class="signup-text">
    <h1>CHOOSE FROM THOUSANDS OF RECIPES</h1>
    <h3 class="mb-3 "> sign up to acess to a lot of recipes, add your own recipes, and many more</h3>
    <a  class =" d-flex text-decoration-none text-white" onclick="displaySignup()" ><h3>Sign up today </h3> <i class="fa-solid fa-arrow-right m-2 p-2 fa-lg" ></i> </a>
    </div>
  </div>
</div>

</section>

<!--recipe search and result -->
<div class="recipeGroup ms-lg-5">

  <!-- navnar on the left  -->
    <section class="recipeMenu">
      <h1 class="ms-2"> Recipes</h1>
      
    <div class="container mt-3 ">

     <div class="accordion" id="menuAccordion">

    <!-- Menu 1 -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button fs-4" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true">
          Dishes
        </button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#menuAccordion">
        <div class="accordion-body">
          <a class="textSearchMenu" onclick="searchRecipeGen('c=breakfast')">Breakfast</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('c=pasta')">Pasta</a>
          <a class="textSearchMenu" onclick="searchRecipeAll('beef')">Beef</a>
          <a class="textSearchMenu" onclick="searchRecipeAll('chicken')">Chicken</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('c=seafood')">Sea Food</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('c=side')">Side</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('c=dessert')">Dessert</a>


        </div>
      </div>
    </div>

    <!-- Menu 2 -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false">
         World Food
        </button>
      </h2>
      <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#menuAccordion">
        <div class="accordion-body">
          <a class="textSearchMenu" onclick="searchRecipeGen('a=chinese')">Chinese</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('a=Turkish')">Turkish</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('a=Indian')">Indian</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('a=Thai')">Thai</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('a=Moroccan')">Moroccan</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('a=Mexican')">Mexican</a>
          <a class="textSearchMenu" onclick="searchRecipeGen('a=japanese')">Japanese</a>

        </div>
      </div>
    </div>

    <!-- Menu 3 -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false">
          Vegan & Vegetarian
        </button>
      </h2>
      <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#menuAccordion">
        <div class="accordion-body">
           <a class="textSearchMenu" onclick="searchRecipeGen('c=vegan')">Vegan</a>
           <a class="textSearchMenu" onclick="searchRecipeGen('c=Vegetarian')">Vegetarian</a>
        </div>
      </div>
    </div>

  </div>

<!--
  <ul class="nav flex-column">

    
    <li class="nav-item dropdown nav-item2">
    <a class="nav-link  nav-link2"  data-bs-toggle="collapse" data-bs-target="#mynavbar2" href="#" role="button" aria-expanded="false"><h2 class="pt-4">Dishes</h2></a>
    <ul class="dropdown-menu collapse show" id="mynavbar2">
      <li><a class="dropdown-item" href="#">Action</a></li>
      <li><a class="dropdown-item" href="#">Another action</a></li>
      <li><a class="dropdown-item" href="#">Something else here</a></li>
    </ul>
  </li>
      <li class="nav-item dropdown nav-item2">
    <a class="nav-link  nav-link2"  data-bs-toggle="collapse" data-bs-target="#mynavbar21" href="#" role="button" aria-expanded="false">
      <h2 class="pt-4">Dishes</h2></a>
    <ul class="dropdown-menu" id="mynavbar21">
      <li><a class="dropdown-item" href="#">Action</a></li>
      <li><a class="dropdown-item" href="#">Another action</a></li>
      <li><a class="dropdown-item" href="#">Something else here</a></li>
    </ul>
  </li>


  </ul>

-->

    </div>
</section>

<div class="recipe-container">

  <!--recipe  search form-->
<section class="recipeSearch me-lg-5 ">

  <div class="container mt-3">
  <div class="d-flex ms-lg-5" role="search">
    <div class="input-group slide-in-blurred-left">
      <span class="input-group-text btnSearch" id="basic-addon1">
        <i class="fa-solid fa-magnifying-glass " onclick="recipeSearch_start();" ></i>
      </span>      
      <input type="text" class="form-control w-lg-50" placeholder="Search" id="textSearch" aria-label="Search" aria-describedby="basic-addon1">
    </div>
  </div>
</div>
<!--
 <form class="d-flex">
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
 </form>
 -->
<div class="searchList mt-2">
  <select class="form-select fs-5 rounded-pill form-select-lg mx-3"  aria-label="search filter" id="recipeFilter">
    <option selected disabled>Sort by : </option>
    <option value="recipeDate">Sort by : date</option>
    <option value="recipeAlpha">Sort by : A to Z</option>
    <option value="recipeNote">Sort by : note </option>
  </select>
</div>

</section>

<!--recipe results on caroussel( with bootstrap)  -->
    <section class="recipeList2 ">

                <div class="container py-3">
<div id="cardCarousel" class="carousel slide" data-bs-ride="false">
  <div class="carousel-inner">
    <!-- Slide 1 -->
    <div class="carousel-item active">
      <div class="row g-3">
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=1" class="card-img-top" alt="Card 1">
            <div class="card-body">
              <h5 class="card-title">Card 1</h5>
              <p class="card-text">Description carte 1.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=2" class="card-img-top" alt="Card 2">
            <div class="card-body">
              <h5 class="card-title">Card 2</h5>
              <p class="card-text">Description carte 2.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="Card 3">
            <div class="card-body">
              <h5 class="card-title">Card 3</h5>
              <p class="card-text">Description carte 3.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 2 -->
    <div class="carousel-item">
      <div class="row g-3">
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=4" class="card-img-top" alt="Card 4">
            <div class="card-body">
              <h5 class="card-title">Card 4</h5>
              <p class="card-text">Description carte 4.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=5" class="card-img-top" alt="Card 5">
            <div class="card-body">
              <h5 class="card-title">Card 5</h5>
              <p class="card-text">Description carte 5.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=6" class="card-img-top" alt="Card 6">
            <div class="card-body">
              <h5 class="card-title">Card 6</h5>
              <p class="card-text">Description carte 6.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 3 -->
    <div class="carousel-item">
      <div class="row g-3">
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=7" class="card-img-top" alt="Card 7">
            <div class="card-body">
              <h5 class="card-title">Card 7</h5>
              <p class="card-text">Description carte 7.</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-lg-4">
          <div class="card shadow-sm h-100">
            <img src="https://picsum.photos/400/250?random=8" class="card-img-top" alt="Card 8">
            <div class="card-body">
              <h5 class="card-title">Card 8</h5>
              <p class="card-text">Description carte 8.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Indicators-->
  <div class="carousel-indicators position-static mt-3 justify-content-center" href="#cardCarousel">
        <button class="btn btn-outline-primary bg-white " type="button" data-bs-target="#cardCarousel" data-bs-slide="prev">
      ⬅️ 
    </button>
    <div class="d-flex numeroButton" id="numeroButton">
    <button type="button" data-bs-target="#cardCarousel" data-bs-slide-to="0" class="active bg-white text-black-50" href="#cardCarousel">1</button>
    <button type="button" class=" bg-white text-black-50" data-bs-target="#cardCarousel" data-bs-slide-to="1"  href="#cardCarousel">2</button>
    <button type="button" class=" bg-white text-black-50" data-bs-target="#cardCarousel" data-bs-slide-to="2">3</button>
    </div>
     <button class="btn btn-outline-primary bg-white" type="button" data-bs-target="#cardCarousel" data-bs-slide="next">
       ➡️
    </button>
  </div>

  <!-- arrow-->
  <div class="d-flex justify-content-center mt-4 gap-3">

        </section>

  </div>
</div>



<!--4 videos recommanded -->
<section class="videoSection my-5 m-lg-5   ">

  <div class="videoTitle m-3 m-lg-5 ">
<h2>VIDEOS</h2>
  <select class="form-select fs-5 rounded-pill  .form-select-video"  aria-label="videos filter" id="videosFilter">
    <option selected disabled>Sort by : </option>
    <option value="recipeDate">featured</option>
    <option value="recipeAlpha">featured</option>
    <option value="recipeNote">featured </option>
  </select>
  </div>

<div class="videos-container m-lg-5" id="videos-container">
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>
  <div class="card" >
    <img src="https://picsum.photos/400/250?random=3" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">By Corentin Chan</p>
    </div>
  </div>

</div>
</section>

<!--subscribe email form  -->
<section class="subscribeSection">

  <div class="container  ">
  <div class="p-5 border rounded-4 shadow-sm bg-danger">
    <h1 class="mx-0 px-0 mx-lg-5 px-lg-5 text-white text-center">Be the first to know about the latest deal, receive new trending recipes & more</h3>
    <p class="text-muted"></p>

    <form class="d-flex   content-center ">
      <div class=" d-lg-flex w-100 w-lg-75 mx-auto">
        <input type="text" class="form-control rounded-pill bg-danger border border-white text-white" id="mail" placeholder="e-mail adress">

        <button type="button" class="btn mx-3 fs-5 px-3   rounded-pill" onclick="displaySignup()">Subscribe</button>
              </div>

    </form>
  </div>
</div>

</section>
<footer>
<!--footer with logos and links -->

<!--logos with fontawesome-->
  <div class="logos me-5 pe-lg-5">
<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fexample.com" target="_blank">             
  <i class="fa-brands fa-facebook fa-2x p-3" ></i>       </a>
<a  href="https://api.whatsapp.com/send?text=Découvrez%20ce%20site%20:%20https%3A%2F%2Fexample.com"   target="_blank">
<i class="fa-brands fa-instagram fa-2x p-3"></i> </a>

<a  href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fexample.com&text=Découvrez%20ce%20site%20!" target="_blank">
<i class="fa-brands fa-twitter fa-2x p-3"></i></a>

  </div>

  <div class="container mt-3">           
  <div class="table-perso">

      <ul>
        <li><a href="">Presentations</a></li>
        <li><a href="">Profesionals</a></li>
        <li><a href="">Stores</a></li>
      </ul>
              <ul>
         <li><a href="">Webinars      </a></li>
          <li ><a href="">Workshops</a></li>
         <li><a href="">Local Meetups</a></li>
      </ul>
        <ul>
         <li><a href="">Ours initiative</a></li>
          <li><a href="">Giving Back</a></li>
         <li><a href="">Communities</a></li>
      </ul>
        <ul>
        <li><a href="">Contact Form</a></li>
        <li><a href="">Work with us</a></li>
        <li><a href="">Visit us</a></li>
      </ul>
             

</div>

  <p class="textTab">Made by C.C</p> 


</footer>



<!--Signin Div-->
<div class="overlay" id="overlay1">
  <div class="signWindow" id="signWindow">
    <button type="button" class="btn btnAc border text-center btn-danger btnClose " aria-label="Close" id="closeSignWindow" onclick="signinClose()">X</button>
    <iframe src="login.html" width="100%" height="100%" style="border:none;"></iframe>
  </div>
</div>

<!-- sign up div -->
<div class="overlay3" id="overlay2">

  <div class=" container signup  ">
      <button type="button" class="btn btnAc text-center btn-danger border p-1  btnClose2" aria-label="Close" id="closeSignupWindow" onclick="signupClose()">X</button>

  <div class="p-4  bg-danger border text-white rounded-5">

    <form class=" contactForm  ">
      <div class="  mx-auto text-center text-grey formAlign">
        <h2 class="text-center m-3  fw-bold pt-2">Sign up</h2>
        <a class="text-center m-3 " onclick="displaySignin();signupClose();">Have already an account? Click here to connect!</a>
   
        <h5 class="text-center m-3 ">Join us and add your own recipes and many more! </h5>
        <label for="mail" class="form-label text-center text-grey fs-4 me-3">Email</label>
        <input type="text" class="form-control rounded-pill text-black bg-white border border-grey text-center " id="name" placeholder="tom@company.com" >

        <label for="mail" class="form-label  text-center text-grey fs-4 me-3 mt-3">Pseudo</label>
        <input type="text" class="form-control text-center text-black  w-50 rounded-pill bg-white border border-grey text-center " id="name" placeholder="tom@company.com" >
        

        <label for="password" class="form-label fs-4 me-3 mt-3">Password</label>
        <input type="text" class="form-control text-center text-black  w-50 rounded-pill bg-white border border-grey text-center " id="password" placeholder="Min 8 characters" >
      
      </div>

      <div class=" text-center my-3">
      </div>

      <div class=" text-center">
       <button type="submit" class="btn btnAc mx-3 fs-5 px-3 mt-3 btn-warning  rounded-pill">Sign up!</button>
    </div>

    </form>
  </div>
</div>

</div>
</div>


</body>
</html>
</file>

<file path="recipe-reactnode-app/src/components/nav.jsx">
import SearchBarNav from './searchBarNav'
  import Signup from './signup'
  import { useState } from "react";

 import { NavLink } from 'react-router-dom';
import { useStore } from "../store/store";
import { useNavigate } from "react-router-dom";



 
 export default function  Nav({}) {
    const [searchDisplay, setSearchDisplay] = useState(false);
  const [showSignup, setShowSignup] = useState(false);
    const user = useStore((state) => state.user);
      const setUser = useStore((state) => state.setUser);
      const pathTab= [{path:'',title:"Home"},{path:'recipe',title:"Recipe"},
        {path:'search',title:"Search"},{path:'contact',title:"Contact"}]

        const isMobile = window.matchMedia("(max-width: 768px)").matches;


    let navigate=useNavigate();

      console.log('user:'+user);

async function logout(e) {
    //e.preventDefault();
      console.log("signout")
    const response = await fetch(import.meta.env.VITE_API_URL+"/logout", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },

      credentials: "include",
    });

    const data = await response.json();
    console.log("Réponse backend :", data);

    if (data.succeed) {
      setUser("")
       navigate("/"); // redirection SPA
  }
  }

 return( 
<>
  
 <nav className="navbar navbar-expand-sm navbar-white bg-white"> 
  <div className="container-fluid">
    <button className="navbar-toggler mt-2" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span className="navbar-toggler-icon"></span>
    </button>

    <div className="collapse navbar-collapse" id="mynavbar">
      <ul className="navbar-nav  me-auto mb-3 mt-2  ">


        { pathTab.map((path,index)=>(   
            <li key={`nav ${index}`} className="nav-item  ">
              <NavLink to={`/${path.path}`} aria-label=" link"  className={({ isActive }) => "nav-link fs-5" + (isActive ? " urlActive" : "") }> {path.title}</NavLink>
        </li>     
        ))}
         
           {/* <li className="nav-item ">
             <NavLink to="/signin"className={({ isActive }) => "nav-link text-black fs-5  pb-1 mb-2 pb-lg-0 mb-lg-0 border-0 urlCustom2"
              + (isActive ? " urlActive" : "") }> Sign in</NavLink>
        </li> */}
      </ul>
      <form className="d-flex">
         <a className="nav-link fs-5 urlCustom" href="javascript:void(0)"></a>
       
      
    
      </form>    

    </div>
          <div className={`rightNav flex-row ${searchDisplay?"searchNav  ":"flex-row"}`}>
          
           <SearchBarNav setSearchDisplay={setSearchDisplay}/>     
              <div className={`d-flex  mt-1  flex-row ${searchDisplay?"  ":""}`}>       
            {!user?!searchDisplay&&(<>
            {/* <button type="button" className="btn btnAc fs-5 rounded-pill mx-2 btnCustom2 " id="signinButton"  >Sign in</button> */}
             <NavLink to="/signin" aria-label="signin in link" className={({ isActive }) => " pt-2 mx-2 nav-link fs-5" + (isActive ? " urlActive" : "") }>Sign in</NavLink>
            <button type="button" className="btn  btnAc btn-primary fs-5 rounded-pill mx-2 btnCustom " onClick={()=>setShowSignup(true)} aria-label="display signup" >Sign up</button>
            </>): (!searchDisplay&& <>  <NavLink to="/account" className={({ isActive }) => " pt-2 mx-2 nav-link fs-5" + (isActive ? " urlActive" : "") }>{user}</NavLink>
               
            { !searchDisplay?<button type="button" onClick={()=>logout()} className="btn btn-primary bg-danger fs-5 rounded-pill mx-2 btnCustom " aria-label="logout">Sign out</button>
               :undefined }</>  )}
              </div>   
          
          </div>
  </div>
</nav>
{showSignup&&( <Signup  setShowSignup={setShowSignup} />)}


</>
 );}
</file>

<file path="recipe-reactnode-app/src/styleResp.css">
@media (max-width: 768px) {

      .nomobile{display: none;}

      /*classes du nav*/
      .navbar {
        margin: 0rem 0rem;
        padding: 0rem;
      }

      .navbar .container-fluid {
        flex-direction: row-reverse;
        justify-content: flex-start;

      }

      .rightNav {
        margin-top: 0.2rem;
      }

      .navbar .btnCustom {
        padding: 0em 0rem;
        width: 8rem;
        margin: 0rem 1rem;
        height: 3rem;
        background-color: orangered;
        border-style: none;
      }

      .nav-item {
        padding: 0em 0rem;
        border-bottom: 1px solid #ccc;
      }

      .navbar .btnCustom2 {
        display: none;

      }

      .navbar .urlCustom {
        display: none;
        margin-left: 0rem;
        padding: 00em 0rem;
      }

      .navbar .urlCustom2 {
        display: block;
        margin-left: 0rem;
        padding: 00em 0rem;
        border-style: none!important;

      }

      .signup-text {
        width: 100%;
      }

      .searchWindow {
        display: none;
        width: 6em;
      }

     .searchBar {
        width: 80%;
      }

      /* nav search for mobile*/
      .searchNav{
        position: relative;
        padding-top: 0em;
        margin-top: 0; 
      }

      /*classe de la recherche et liste des recette*/
  

      .searchHome .search-select{
        margin-right: 0.5rem ;
        }
   

      .recipeMenu {
        display: flex;
        flex-direction: column;
      }

      .signup-text h1 {
        font-size: xx-large;
      }

      .recipeGroup {
        display: flex;
        flex-direction: column;

      }

      .recipe-container {

        display: flex;
        flex-direction: column;

      }

    .card-img-top  {
      max-height: 150px;  
     width: 150px;
        object-fit: contain;
      }

      .card-title{
        min-height: 3em;
      }

     .noteCard{
        width: 4em;
      }
      
      
   



    

      .card {
        max-width: 90%;
        margin-left: 10px;
      }
      /* .recipeList .card {
        max-width: 90%;
        margin-left: 10px;
      } */



      /* videos container 2 par ligne*/
      .videos-container {
        /* flex-wrap: wrap; */
          overflow-x: auto;
        gap: 0em;
          scroll-snap-type: x mandatory;

      }


      .videos-container .card {
       min-width: 90%;
        scroll-snap-align: center;
        width:50em ;
      }
      .videos-container .iframe {
        width:50em ;
      }

      .videos-container2 .card {
        width: 40% !important;

      }


      .videoSection .form-select {
        width: 7em;
        height: 2em;
        margin-top: 0em;
        padding-top: 0.2em;
        font-size: 1em !important;
        color: white;
      }


      /*subribe section */
      .subscribeSection .btn {
        height: 2.5em;
        font-size: medium;
        margin-top: 1em;
        width: 8em;
      }

      .videos-container .card {
        margin-top: 0.5em;

      }

    .recipeForm form {
    width: 100%;}


      /*footer : tableau 2 par lignes */

      .table-perso {
        flex-direction: column;

        margin-bottom: 5rem;
      }

      .table-perso ul {
        gap: 1rem;
        display: flex;
        flex-direction: column;
        margin-top: 1em;
        text-align: left;
        font-size: 1.3em;

      }

      .table-perso li {
        list-style-type: none;
        text-decoration: none;
        color: black;
        padding: 0rem;
      }


      .textTab {
        text-decoration: none;
        color: grey;
        margin-left: 7rem;
      }

      /*recipe page*/


      .recipteTitle {
        max-width: 100%;
        justify-content: center;
      }

      .image-container {
        width: 100%;
        display: block;
        justify-content: center;
      }

      .recipePhoto {
        width: 100%;
        height: auto;
      }

      .descriptionLogos {
        flex-direction: row;
        justify-content: center;
      }

      .descriptionRecipe {
        align-items: center;
        display: block;
        max-width: 100%;
      }

      .makeRecipe-container {
        display: flex;
        flex-direction: column-reverse;

      }

      .recipeLeft {
        width: 100%;
      }

      .recipeRight {
        width: 100%;
      }

      .nbStep {
        width: 8em;
        font-size: medium;
      }

      .card-text {
        margin-left: 1em;
        margin-right: 0em;
        padding-right: 0;
      }

      .comments {
        width: 100%;
      }

      .com-container2 {
        margin-left: 0%;
        width: 100%;
      }


      .videoSection2 .card {
        width: auto;
        object-fit: cover;
      }

      .videoSection2 .card-img-top {
        height: auto;
        width: auto;
        object-fit: cover;
      }

            .videoSection .card-img-top {
        height: auto;
        width: auto;
        object-fit: cover;
      }

      


      .videos-container .card-title {
        height: 3em;
      }



      /*Contact Page*/

      .contactGroup {
        flex-direction: column;
        justify-content: center;
      }

      .contactText {
        width: 100%;
      }

      .contactForm-container {
        width: 100%;
      }

      /*login page*/

      .signupSection {
        width: 100%;
      }

      /* signup div */

          .signWindow .btnClose{

      top:  1% ;
    }

    

 .signup2{
    position: relative;
    width: 100%;
    z-index: 20;
   }

        .signup{
      width: 100%;
      left : 0;
      top:3em;
    }

 .btnClose2{
      
      left: 80%;
      top: 3em;    }

      /*Account Page */
.cardExt{
    display: flex;
   }
 

       .cardExt .card {
     width:10em;
    height:auto;  

             object-fit: cover;

      }

      
   .cardExt  .card-img-top  {
      width: 100%;
      height: 100%;
      object-fit: cover; 
      display: block;
      }

          /* .card iframe {
  width: 100%;
  aspect-ratio: 4/3;

    } */

    }




/*responsive for print page*/
@media print {

    .noprint{
      display: none;
    }

    .navbar {
      display: none;
    }

    img{
      display: none;
    }

    .comments{
      display: none;

    }

      .tags{

          display: none;

      }

      .shareRecipe{

      display: none;

      }
    .videoSection2{
      display: none;
    }

    footer{
      display: none;
    }
     a{
      display: none;
    }
     h3{
      display: none;
    }
     .clickable{
      display: none;
    }


  
    body {
      background: white;
      margin: 0;
    }

    @page {
      margin: 20mm;
    }
  }
</file>

<file path="RecipeProjectjsreact/backend/app.js">
var http = require('http');
let url = require('url');
const fsp = require('fs').promises;
let express = require("express");
const bcrypt = require('bcryptjs');
const crypto = require('crypto');
let ejs = require('ejs');
const cookieParser = require('cookie-parser');
const path = require('path');
const bodyParser = require('body-parser')
var mysql = require('mysql2');
const mysql2 = require('mysql2/promise');
const session = require('express-session');
const nodemailer = require('nodemailer');
const passport = require("passport");
require("./passportConfig");
require('dotenv').config();
var cors = require('cors')

let app = express();

app.use(session({
	secret: process.env.DB_SECRET,      // clé pour signer la session (change-la)
	resave: false,              // ne pas sauvegarder si rien n’a changé
	saveUninitialized: true,    // sauvegarder les nouvelles sessions même si vides
	cookie: { maxAge: 3600000 } // durée de vie du cookie en ms (ici 1h)
}));


app.use(passport.initialize());
app.use(passport.session());


app.use(cors({
  origin: "http://37.27.248.236:3001", // ton frontend React
  credentials: true                // permet d’envoyer/recevoir les cookies
}));



const pool = mysql2.createPool({
    host: process.env.DB_HOST,
    user: process.env.DB_USER,
    password: process.env.DB_PASSWORD,
    database: process.env.DB_NAME,
	waitForConnections: true, // wait for others
	connectionLimit: 10, // pool reuse connection already existed limit 10 
	queueLimit: 0
});


var connection = mysql.createConnection({
    host: process.env.DB_HOST,
    user: process.env.DB_USER,
    password: process.env.DB_PASSWORD,
    database: process.env.DB_NAME,
	multipleStatements: true
});



app.use(cookieParser());
app.use(bodyParser.urlencoded({ extended: true }));
app.use(express.json());


const reactBuildPath = path.join(__dirname, '../frontend/dist');
app.use('/assets', express.static(path.join(reactBuildPath, 'assets')));

// 2. Ensuite, on sert le reste du dossier dist (pour favicon.ico, etc.)
app.use(express.static(reactBuildPath));



let pseudo = '';


app.post('/setRecipeID', async (req, res) => {


		const pseudo = req.cookies.pseudo;
		const pseudoID = req.cookies.pseudoID;
		let recipeID;
		if (req.body.recipeID){ 
            recipeID =req.body.recipeID;
			res.cookie('recipeID', recipeID, {
				maxAge: 60 * 60 * 1000, // 1 jour
				httpOnly: true,              // inaccessible en JS client
				secure: false,               // mettre true si HTTPS
				sameSite: 'lax'              // protection CSRF basique
			});        
        
			
		} 
		else if (req.cookies.recipeID){ recipeID = req.cookies.recipeID; //req.session.recipeID = recipeID;   
			}
		 else{
			const [recipeIDres] = await pool.execute('SELECT id FROM recipe ORDER BY RAND() LIMIT 1;');
			 recipeID = recipeIDres[0].id ;


			res.cookie('recipeID', recipeID, {
				maxAge: 60 * 60 * 1000, // 1 jour
				httpOnly: true,              // inaccessible en JS client
				secure: false,               // mettre true si HTTPS
				sameSite: 'lax'              // protection CSRF basique
			});



		} 

		 res.json({response : "cookie updated", recipeID : recipeID})

});

app.post('/getRecipeReco', async (req, res) => {


		const pseudo = req.cookies.pseudo;
		const pseudoID = req.cookies.pseudoID;
		let recipeID=req.body.recipeID;
		
	const [recipeReco] = await pool.execute(`SELECT r.*
											FROM recipe r
											JOIN tagslist t ON t.recipeID = r.id
											WHERE r.id != ?
											AND (
													r.categoryID = (SELECT categoryID FROM recipe WHERE id = ?)
													OR t.tag IN (SELECT tag FROM tagslist WHERE recipeID = ?)
												)
											GROUP BY r.id
											ORDER BY RAND()
											LIMIT 8;
											`, [recipeID,recipeID,recipeID]); 
	//select recipe ID with left join and join

		console.log(`${pseudo} : ${pseudoID} (recipeID = ${recipeID})`);

		 res.json({response : "cookie updated", recipeReco : recipeReco})

});




app.post('/recipeDescription', async (req, res) => {
	try {
		// Connect to the database using promises
		//const pool = await connectMysql2();
		recipeID = req.body.recipeID;
		const [recipeResult] = await pool.execute('SELECT * FROM recipe WHERE id = ?', [recipeID]);	
		const [notes] = await pool.execute('SELECT note FROM notes where  recipeID = ?',[recipeID]);
		const [nbRecipes] = await pool.execute('SELECT count(id) as total FROM recipe where  auteur = ?',[recipeResult[0].auteur]);
		
		//  {let notes=[];}
		res.json({recipe : recipeResult,nbNotes:notes.length,nbRecipes:nbRecipes[0].total});
		
	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json(err);
	}
});

app.post('/getSteps', async (req, res) => {
	try {
		// Connect to the database using promises
		let recipeID=req.body.recipeID;
		//const pool = await connectMysql2();
		const [steps] = await pool.execute('SELECT * FROM instructions WHERE recipeID = ?', [recipeID]);
		res.json({instructions : steps});

	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});

app.post('/getIngredients', async (req, res) => {
	try {
		// Connect to the database using promises
				let recipeID=req.body.recipeID;

		//const pool = await connectMysql2();
const [ingredients] = await pool.execute('SELECT * FROM liste_ingredients WHERE recipeID = ?', [recipeID]);
		res.json({ingredients : ingredients});

	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});


app.post('/getTags', async (req, res) => {
	try {
		// Connect to the database using promises
				let recipeID=req.body.recipeID;

		//const pool = await connectMysql2();
		const [tags] = await pool.execute('SELECT * FROM tagslist WHERE recipeID = ?', [recipeID]);
		res.json({tags : tags});

	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});

app.post('/getComment', async (req, res) => {
	try {
		console.log(req.body.recipeID);
		const recipeID = req.body.recipeID;
		console.log(recipeID);
		//const pool = await connectMysql2();
		const [comment] = await pool.execute('SELECT commentaires.*,users.pseudo,users.image,users.mail,notes.note FROM commentaires LEFT JOIN notes  ON commentaires.userID = notes.userID AND notes.recipeID = commentaires.recipeID  JOIN users ON commentaires.userID = users.id WHERE commentaires.recipeID = ? ORDER BY commentaires.date DESC ;', [recipeID]);
		console.log('comment'+comment);
		res.json({comment : comment});


	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});



app.post('/ban', async(req, res) => {
	act = req.body.act;
	console.log(act);
	let sql;
	const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	if (!regex.test(req.body.pseudo))sql='UPDATE users SET role =? where pseudo= ? ';
	else sql='UPDATE users SET role =? where mail= ? ';

	if(act==="ban")role="ban";
	else role='user';
	try{ 
	const [result] = await pool.execute(sql,[role,req.body.pseudo]);
		console.log(result);
		
		if(result.affectedRows)	res.json({message:"user is now "+role});
		else res.json({message:"user not found "});
	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}

});

app.post('/giveAdmin', async(req, res) => {
	act = req.body.act;
	console.log(act);

	const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	let sql;
	if (!regex.test(req.body.pseudo))sql='UPDATE users SET role =? where pseudo= ? ';
	else sql='UPDATE users SET role =? where mail= ? ';

	if(act==="giveAdmin")role="admin";
	else role='user';
	try{ 
	const [result] = await pool.execute(sql,[role,req.body.pseudo]);
		console.log(result);
	
	
		if(result.affectedRows)res.json({message:'user is now '+role});
		else res.json({message:'user not found'});
		//res.render('recipeForm', { title: 'Recipe page', user: pseudo, category: result });
	
	}catch (err){
		res.json(err);
	}

});


let recipeModID;
app.post('/getRecipeMod', async(req, res) => {
	try {


		const pseudo = req.cookies.pseudo;
		const pseudoID = req.cookies.pseudoID;
		let recipeID=req.body.recipeID;

		console.log(`${pseudo} : ${pseudoID} (recipeID = ${recipeID})`);
		const [check] = await pool.execute('SELECT * FROM recipe_list WHERE recipeID = ? and userID=? and type="ownrecipe"', [recipeID,pseudoID]);
		if(check.length===0 && req.cookies.userRole !="admin") res.send('No access role');
		const [recipeResult] = await pool.execute('SELECT * FROM recipe WHERE id = ?', [recipeID]);
		const [steps] = await pool.execute('SELECT * FROM instructions WHERE recipeID = ?', [recipeID]);
		const [ingredients] = await pool.execute('SELECT * FROM liste_ingredients WHERE recipeID = ?', [recipeID]);
		const [tags] = await pool.execute('SELECT * FROM tagslist WHERE recipeID = ?', [recipeID]);
		const [comment] = await pool.execute('SELECT commentaires.*,users.pseudo,users.image FROM commentaires JOIN users ON commentaires.userID = users.id WHERE commentaires.recipeID = ? ;', [recipeID]);
		const [notes] = await pool.execute('SELECT * FROM notes WHERE recipeID = ?', [recipeID]);
		const [category] = await pool.execute('SELECT * FROM category');

		const recipe = recipeResult[0];
		let recipesID = [];
		if (tags.length > 0) {
			for (const tagObj of tags) {
				const [recipesIDres] = await pool.execute('SELECT recipeID FROM tagslist WHERE tag = ? && recipeID!=?',
					[tagObj.tag, recipeID]);
				recipesID.push(...recipesIDres.map(r => r.recipeID));
			}
			console.log("recipefromtaf" + recipesID);
		}
			
		res.json( {
			 user: pseudo, recipe: recipe,instructions: steps, 
			ingredients: ingredients, tags: tags, commentaires: comment, notes: notes, 
			message : req.query.message, category : category
		});


	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}

});

app.post('/modifyRecipe', (req, res) => {

	if (req.cookies.pseudo) {
	recipeModID=req.body.recipeID;
	var query = connection.query(`DELETE FROM instructions WHERE recipeID= ?;DELETE FROM liste_ingredients WHERE recipeID= ?;
				DELETE FROM tagslist WHERE recipeID= ?;`
			, [recipeModID, recipeModID, recipeModID], function (error, results, fields) {
				if (error) console.log(error);

				console.log("supprimée :", results)

		let post = {
			title: req.body.title,
			description: req.body.description,
			image: req.body.image,
			totalTime: req.body.totalTime,
			yield: req.body.nbPerson,
			activeTime: req.body.activeTime,
			auteur: req.body.author,
			categoryID: req.body.categoryID,
		};
		console.log('step :', req.body.steps);
		console.log('ingredient :', req.body.ingredients);

		var query = connection.query('UPDATE recipe SET ? where id= ?', [post,recipeModID],
			function (error, results, fields) {
				if (error) throw error;
				const recipeID = results.insertId;  // ← récupère l’ID auto-incrémenté
				
			let stepPost;
			if(req.body.steps ){
				let step = req.body.steps.filter(item => item !== null && item !== "");
				 stepPost = step.map(txt => [txt, recipeModID]);
				/*  const ing = ingredient.map(txt=> [ txt, recipeID ]);
					const ingPost= measure.map(txt=> [ txt, ing ]);*/
			}
			console.log('recipeid'+recipeModID)
			console.log("ingredient body"+req.body.ingredients);
			console.log("tag body"+req.body.tags);

		let tag;
		if(req.body.tags && req.body.tags!=0){tag = req.body.tags.filter(item => item !== null && item !== "");
		console.log(tag);}
			console.log("tag body :" + req.body.tags + " ,tag : " + tag)

		// On filtre les deux tableaux en même temps :
		let ingPost;
		if(req.body.ingredients){
		let ingredient = req.body.ingredients;
		let measure = req.body.measures;

		let filtered = ingredient
			.map((ing, index) => ({ ingredient: ing, measure: measure[index] }))
			.filter(item => item.ingredient && item.ingredient.trim() !== ""); // garde seulement si ingredient non vide

		// Puis on sépare à nouveau :
		ingredient = filtered.map(item => item.ingredient);
		measure = filtered.map(item => item.measure);

			 ingPost = ingredient.map((ingTexte, index) => {
					const measureTexte = measure[index];      // correspondante
					return [ingTexte, measureTexte, recipeModID];
				});

		console.log("ingPost" + ingPost);
		console.log(ingredient); console.log(measure);
	}
		console.log(req.body.steps  && req.body.steps.length>0);
				if (req.body.steps!=''  && req.body.steps) {
					connection.query('INSERT INTO instructions (instruction, recipeID) VALUES ?', [stepPost], (err2) => {
						console.log("instructions insert");
						if (err2) throw err2;
					});
				}
				
				if (req.body.ingredients && req.body.ingredients!='') {
					connection.query('INSERT IGNORE INTO liste_ingredients ( ingredient, measure, recipeID) VALUES ?', [ingPost], (err3) => {
						console.log("ingredients insert");

						if (err3) throw err3;
					});
				}
				if(req.body.tags && req.body.tags!=""){const tagPost = tag.map(txt => [txt, recipeModID]);
				 
				connection.query('INSERT IGNORE INTO tagslist (tag, recipeID) VALUES ?', [tagPost], (err4) => {
				console.log("tag insert");

					if (err4) throw err4;
				});
					}
					console.log(req.body.ingredients)
					console.log("fin"); // INSERT INTO contact SET `id` = 1, `title` = 'Hello MySQL'
					res.json({check:true})

			});
	});

	}
	else console.log("not connected!");


});



app.listen(3001, '0.0.0.0',  () => {
	console.log(` app listening at http://localhost:3001`);
});


app.post('/signup', (req, res) => {
	
		const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	if (!regex.test(req.body.mail))  {res.json({succeed: false, message : "mail format incorrect"});}

	var query = connection.query(`SELECT pseudo FROM users where pseudo= ?  `
	,[req.body.pseudo], function (error, results, fields) {
	if (results.length> 0 ) {res.json({succeed: false, message : "pseudo already exists"});}
	else{

	const salt = bcrypt.genSaltSync(10);
	const hashmdp = bcrypt.hashSync(req.body.password, salt);


	let post = {
		pseudo: req.body.pseudo,
		mail: req.body.mail,
		mdp: hashmdp,

	};
	var query = connection.query('INSERT IGNORE INTO users SET ?', post, function (error, results, fields) {
		if (error) throw error;

	console.log(query.sql); 

	if(results.affectedRows===0)
	{message="mailExist";
	res.json( {succeed:false,message:'mail already exist'})}
	else{ 
	let subjectMail= "Your account have been created !"
	let textMail= "Hello " + req.body.pseudo + ", your account have been created you can connect now!"
	sendMail(req.body.mail,subjectMail,textMail);
	let message="accountCreated";
	
		res.cookie('pseudo', req.body.pseudo, {
						maxAge: 3600000,   // expire dans 1h
						httpOnly: true,    // inaccessible côté client (document.cookie)
						secure: false,     // true si HTTPS
						
					});

					res.cookie('pseudoID', results.insertId, {
						maxAge: 3600000,   // expire dans 1h
						httpOnly: true,    // inaccessible côté client (document.cookie)
						secure: false,     // true si HTTPS
					});
						res.cookie('userRole', "user", {
						maxAge: 3600000,   // expire dans 1h
						httpOnly: true,    // inaccessible côté client (document.cookie)
						secure: false,     // true si HTTPS
					});
	res.json( {succeed:true,message:'Account have been created, you can connect now!'});
	}
	});
}	
});	

});

app.post('/logout', (req, res) => {
	res.clearCookie('pseudo');
	res.clearCookie('pseudoID');
	res.clearCookie('userRole');
	console.log('Cookie "pseudo" supprimé ✅');
	res.send({succeed:true})
});

app.get('/getPseudo', (req, res) => {
		const pseudo = req.cookies.pseudo||"";
	const pseudoID = req.cookies.pseudoID;
	res.json({pseudo : pseudo,role : req.cookies.userRole });
})

app.post('/signin', (req, res) => {
	console.log(req.body);
	let mail = req.body.mail;
	let mdp = req.body.password;
	const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	if (!regex.test(req.body.mail))  {return res.json({error:"mail wrong"});}

	connection.query('SELECT * FROM users WHERE mail = ?', [mail], function (error, result, fields) {
		if (error) throw error;
		// Neat!

		if (!(result && result.length > 0)) res.json({ succeed : false, message: "Mail doesn't exist" });

			else {
			hash = result[0].mdp;
			console.log(result[0].pseudo + result[0].id + result[0].role);
			let pseudoBDD = result[0].pseudo;
			let pseudoIDBDD = result[0].id;
			let userRole= result[0].role

			bcrypt.compare(mdp, hash, (err, resultCompare) => {
				if (err) {
					// Handle error
					console.error('Error comparing passwords:', err);
					return;
				}

				if (resultCompare) {
					console.log('Passwords match! User authenticated.');
					res.cookie('userRole', userRole, {
						maxAge: 3600000,   // expire dans 1h
						httpOnly: true,    // inaccessible côté client (document.cookie)
						secure: false,     // true si HTTPS
					});

					res.cookie('pseudo', pseudoBDD, {
						maxAge: 3600000,   // expire dans 1h
						httpOnly: true,    // inaccessible côté client (document.cookie)
						secure: false,     // true si HTTPS
					});

					res.cookie('pseudoID', pseudoIDBDD, {
						maxAge: 3600000,   // expire dans 1h
						httpOnly: true,    // inaccessible côté client (document.cookie)
						secure: false,     // true si HTTPS
					});

					//res.redirect('/profil');
					res.json({ succeed : true,pseudo :pseudoBDD, message: "You are connected, redirect in 3s" });
					
				} else {
					// Passwords don't match, authentication failed
					console.log('Passwords do not match! Authentication failed.');
					res.json({ succeed : false, message: "Passwords do not match!" });
				}
			});

		}


		app.get('/profil', (req, res) => {
			// Lire le cookie nommé "pseudo"
			const pseudo = req.cookies.pseudo;

					if (pseudo) {
						console.log(`Bonjour ${pseudo} 👋`);
					} else {
						console.log('Aucun cookie "pseudo" trouvé');
					}

					});
				});
			});

app.get('/getCategory',async(req,res) =>
{	

	try{
		const [category] = await pool.execute('SELECT * FROM category');
		res.json({category:category})
	}
	 catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
})


app.get('/getProfil',async(req,res) => //select user table
{	

	try{
		let pseudoID=parseInt(req.cookies.pseudoID);
		const [user] = await pool.execute('SELECT * FROM users where id=?',[pseudoID]);
		res.json({user:user[0]})
	}
	 catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
})

app.get('/getComments',async(req,res) => //select all comment from this user
{	

	try{
		let pseudoID=parseInt(req.cookies.pseudoID);
		const [comments] = await pool.execute('SELECT commentaires.*,recipe.title FROM commentaires LEFT JOIN recipe  ON recipe.id = commentaires.recipeID  WHERE commentaires.userID = ? ORDER BY commentaires.date DESC ;', [pseudoID]);
		const [notes] = await pool.execute('SELECT *,recipe.title FROM notes LEFT JOIN recipe  ON recipe.id = notes.recipeID where userID=?',[pseudoID]);

		res.json({comments:comments, notes : notes})
	}
	 catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
})

app.get('/getOwnRecipes',async(req,res) => //select recipe created by user
{	

	try{
		let pseudoID=parseInt(req.cookies.pseudoID);
		const [ownRecipes] = await pool.execute('SELECT type, recipe.* FROM recipe_list JOIN recipe ON recipe_list.recipeID=recipe.id  WHERE userID = ?  && type="ownrecipe";', [pseudoID]);

		res.json({ownRecipes:ownRecipes})
	}
	 catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
})


app.get('/getRecipesList',async(req,res) => //select favoris list from user
{	

	try{
		let pseudoID=parseInt(req.cookies.pseudoID);
		const [recipesList] = await pool.execute('SELECT type, recipe.* FROM recipe_list JOIN recipe ON recipe_list.recipeID=recipe.id  WHERE userID = ?  AND type="favoris"', [pseudoID]);

		res.json({recipesList: recipesList})
	}
	 catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
})


app.post('/createRecipe', (req, res) => { //create recipe save on database
	console.log(req.body);

	if (req.cookies.pseudoID) { //create post for recipe table
		let post = {
			title: req.body.title,
			description: req.body.description,
			image: req.body.image,
			totalTime: req.body.totalTime,
			yield: req.body.nbPerson,
			activeTime: req.body.activeTime,
			auteur: req.body.author,
			categoryID: req.body.categoryID,
		};

		var query = connection.query('INSERT INTO recipe SET ?', post,
			function (error, results, fields) {
				if (error) throw error;
				const recipeID = results.insertId;  // ← récupère l’ID auto-incrémenté
				console.log('Dernier recipeID inséré =', recipeID);

		let step = req.body.steps.filter(item => item !== null && item !== ""); // prepare steps data for instructions table(filter empty input)
		let tag = req.body.tags.filter(item => item !== null && item !== ""); // prepare tags data for tagslist table
		console.log(tag);


		let ingredient = req.body.ingredients;
		let measure = req.body.measures;

		// On filtre les deux tableaux en même temps :
		let filtered = ingredient
			.map((ing, index) => ({ ingredient: ing, measure: measure[index] })) //prepare ingredients data to ingredients table
			.filter(item => item.ingredient && item.ingredient.trim() !== ""); // garde seulement si ingredient non vide

		// Puis on sépare à nouveau :
		ingredient = filtered.map(item => item.ingredient);
		measure = filtered.map(item => item.measure);

		console.log(ingredient); console.log(measure);

		const stepPost = step.map(txt => [txt, recipeID]); // data instructions for mysql

		const ingPost = ingredient.map((ingTexte, index) => { // data ingrefients for mysql
			const measureTexte = measure[index];      // correspondante
			return [ingTexte, measureTexte, recipeID];
		});


		listPost = {
			recipeID: recipeID,
			userID: req.cookies.pseudoID,
			type: 'ownrecipe',
		}

		const tagPost = tag.map(txt => [txt, recipeID]);
		console.log(tagPost);

				if (step.length > 0) {
					connection.query('INSERT INTO instructions (instruction, recipeID) VALUES ?', [stepPost], (err2) => {
						console.log("instructions insert");
						if (err2) throw err2;
					});
				}
				if (ingredient.length > 0) {
					connection.query('INSERT INTO liste_ingredients ( ingredient, measure, recipeID) VALUES ?', [ingPost], (err3) => {
						console.log("ingredients insert");

						if (err3) throw err3;
					});
				}

				if(tagPost.length>0){ 
				connection.query('INSERT IGNORE INTO tagslist (tag, recipeID) VALUES ?', [tagPost], (err4) => {
				console.log("tag insert");

					if (err4) console.log(err4);
				});
					}

				connection.query('INSERT IGNORE INTO recipe_list SET ?', listPost, (err4) => {
					console.log("list insert");
					if (err4) throw err4;
				});

			});
		console.log(query.sql); // INSERT INTO contact SET `id` = 1, `title` = 'Hello MySQL'
	}
	else {
		console.log("not connected!");
		res.json({succeed:true, message: "not connected"});}
	res.json({succeed:true});
	//res.redirect('/account')

});



// app.post('/goRecipe', (req, res) => {
// 	console.log("url " + req.body.recipeID);
// 	res.clearCookie('recipeID');
// 	res.cookie('recipeID', req.body.recipeID, {
// 		maxAge: 3600000,   // expire dans 1h
// 		httpOnly: true,    // inaccessible côté client (document.cookie)
// 		secure: false,     // true si HTTPS
// 	});

// 	console.log(" recipe ID = " + req.body.recipeID);
// 	res.redirect('/recipe');
// });

app.post('/addList', (req, res) => { // add recipe to favoris and ownrecipe recipe_list tabme
	//if (!pseudo) res.redirect('/recipe');

	console.log("url " + req.body.recipeID);
	if (req.cookies.pseudoID && req.body.recipeID)
		var query = connection.query('INSERT IGNORE INTO recipe_list(`recipeID`, `userID`, `type`) VALUES (?, ?, ?)'
			, [req.body.recipeID, req.cookies.pseudoID, "favoris"], function (error, results, fields) {
				if (error) {
					console.error('Erreur MySQL:', error.message);
					return;
				}
				let message="List Added";
				if(results.affectedRows===0) message="Already in List";
				console.log("donnée insérée :", results)
				res.json({message:message});
			});

});



//delete own recipe completely on database
app.post('/deleteRecipeList', (req, res) => {
	console.log('données :'+req.body.recipeID+req.body.type+req.cookies.pseudoID);
	if (!req.cookies.pseudoID) res.json({checkUser:false});
	else {
		recipeID=req.body.recipeID;
		console.log(recipeID);
		var query = connection.query(`DELETE FROM recipe_list WHERE recipeID = ? AND userID = ? AND type = ? `
			, [recipeID, req.cookies.pseudoID,req.body.type], function (error, results, fields) {
				if (error) throw error;

				console.log("supprimée :", results)

			});

			if(req.body.type==='ownRecipe')
		{
			var query = connection.query(`DELETE FROM instructions WHERE recipeID= ?;DELETE FROM liste_ingredients WHERE recipeID= ?;
				DELETE FROM tagslist WHERE recipeID= ?;DELETE FROM recipe WHERE id= ?;
				DELETE FROM commentaires WHERE recipeID= ?;DELETE FROM notes WHERE recipeID= ?;`
				, [req.body.recipeID, req.body.recipeID, req.body.recipeID, req.body.recipeID, req.body.recipeID, req.body.recipeID], function (error, results, fields) {
					if (error) console.log(error);

					res.clearCookie('recipeID');
					console.log("supprimée :", results)

				});

		}


	}
						res.json({check:true,checkUser:true});

});

//delete own recipe completely on database
app.post('/deleteRecipe', (req, res) => {
	if (req.cookies.userRole!="admin") res.json({checkUser:false});
	else {
		recipeID=req.body.recipeID;
		var query = connection.query(`DELETE FROM recipe WHERE id = ? `
			, [recipeID], function (error, results, fields) {
				if (error) throw error;

				console.log("supprimée :", results)
	

			});

		var query = connection.query(`DELETE FROM instructions WHERE recipeID= ?;DELETE FROM liste_ingredients WHERE recipeID= ?;
				DELETE FROM tagslist WHERE recipeID= ?;DELETE FROM recipe WHERE id= ?;
				DELETE FROM commentaires WHERE recipeID= ?;DELETE FROM notes WHERE recipeID= ?;`
			, [recipeID, recipeID, recipeID, recipeID, recipeID, recipeID], function (error, results, fields) {
				if (error) console.log(error);

				console.log("supprimée :", results)
				res.clearCookie('recipeID');
				res.json({check:true,checkUser:true});
			});


	}
});


//search a recipe from search bar
app.post('/searchRecipes', (req, res) => {
	let filter = "";
	let textSearch = req.body.textSearch;
	let formSelect = req.body.formSelect ?? 'false';
	if (!req.body.formSelect) {
		textSearch = req.body.textSearch;
		res.cookie('searchKey', req.body.textSearch, {
			maxAge: 3600000,   // expire dans 1h
			httpOnly: true,    // inaccessible côté client (document.cookie)
			secure: false,     // true si HTTPS
		});
	} else {
		textSearch = req.cookies.searchKey;
		//differentes options du sortby form-select
		switch (req.body.searchFilter) {
			case 'title':
				filter = " ORDER BY title ASC";
				break;
			case 'date':
				filter = " ORDER BY date DESC";
				break;
			case 'note':
				filter = " ORDER BY note DESC";
				break;
			default:
				filter = "";
		}
	}
	console.log("textsearch : " + textSearch);

	connection.query(`SELECT recipeID FROM tagslist WHERE tag = ? ;SELECT id FROM category WHERE name = ? ;  `,
		[textSearch, textSearch], function (error, result, fields) {
			if (error) throw error;
			console.log(" searchKey = " + textSearch);
			console.log(result);

			const allRecipeIDs = [...result[0]];
			if (allRecipeIDs.length === 0) allRecipeIDs[0] = '0';
			const recipeIDs = allRecipeIDs.map(r => r.recipeID);
			const cleanRecipeIDs = [...new Set(recipeIDs)];

			let categoryID = result[1]?.[0]?.id || '0';

			connection.query(`SELECT * FROM recipe WHERE title LIKE ?  OR id in (?) OR categoryID=? ${filter} LIMIT 500 `,
				[`%${textSearch}%`, cleanRecipeIDs, categoryID], function (error, result, fields) {
					if (error) throw error;
					console.log(result);
					console.log(req.get('Referer'))
					JSON.stringify(result)
					res.json( {recipes: result});
				});

		});

});


//search a recipe from search bar
app.post('/searchRecipeHome', (req, res) => {
	let filter = "";
	let textSearch = req.body.textSearch;
	
		switch (req.body.searchFilter) {
			case 'title':
				filter = " ORDER BY title ASC";
				break;
			case 'date':
				filter = " ORDER BY date DESC ";
				break;
			case 'note':
				filter = " ORDER BY recipe.note DESC ";
				break;
			default:
				filter = " ";
		}
	//}
	console.log("textsearch : " + textSearch);

	connection.query(`SELECT recipeID FROM tagslist WHERE tag = ? ;SELECT id FROM category WHERE name = ? ;  `,
		[textSearch, textSearch], function (error, result, fields) {

			if (error) throw error;
			console.log(" searchKey = " + textSearch);
			console.log(result);

			const allRecipeIDs = [...result[0]];
			if (allRecipeIDs.length === 0) allRecipeIDs[0] = '0';
			const recipeIDs = allRecipeIDs.map(r => r.recipeID);
			const cleanRecipeIDs = [...new Set(recipeIDs)];

			let categoryID = result[1]?.[0]?.id || '0';

			let recipeList="";
			if(req.cookies.pseudoID){ recipeList=`LEFT JOIN recipe_list on type="favoris"
													AND recipe_list.recipeID=recipe.id AND userID=${req.cookies.pseudoID}`;}
			
			connection.query(`SELECT * FROM recipe ${recipeList} WHERE title LIKE ?   OR id in (?) OR categoryID=?  ${filter} LIMIT 150`,
				[`%${textSearch}%`, cleanRecipeIDs, categoryID], function (error, result, fields) {
					if (error) throw error;
					console.log(" searchKey = " + textSearch," filter : "+filter);
					//console.log(result);
					//console.log(req.get('Referer'))
					if (result) { 
					JSON.stringify(result)
					res.json( {recipes: result});
				 }

			
					
				});

		});

});


app.post('/searchRecipeYT', (req, res) => {
	let textSearch = req.body.textSearch;
	
	connection.query(`SELECT * FROM recipe WHERE description LIKE '%youtube.com%' OR description 
					  LIKE '%youtu.be%' ORDER BY RAND() LIMIT 4 ;`,
		 function (error, result, fields) {
			if (error) throw error;
				
					res.json( {recipes: result});
				 				
				});
			
		});


//add note to BDD from html
app.post('/giveNote', async (req, res) => {
	console.log("note ; " + req.body.note + "id :" + req.cookies.pseudoID + " recipeid" + req.cookies.recipeID);
	let note = parseInt(req.body.note);
	console.log("note" + note);
	try {
		// Connect to the database using promises
		// const pool = await mysql2.createConnection({
		// 	host: process.env.DB_HOST,
		// 	user: process.env.DB_USER,
		// 	password: process.env.DB_PASSWORD,
		// 	database: process.env.DB_NAME,
		// });
		let recipeID = req.cookies.recipeID;

		const [existing] = await pool.execute(
			'SELECT note FROM notes WHERE userID = ? AND recipeID = ?',
			[req.cookies.pseudoID, recipeID]
		);
		let message='';
		console.log(recipeID+'pseudo id'+ req.cookies.pseudoID+ note)
		if (existing.length > 0) {
			// La note existe → on met à jour
			const [insertResult] = await pool.execute('UPDATE notes SET note = ? WHERE userID = ? AND recipeID = ?',
				[note, req.cookies.pseudoID, recipeID]);
			message="noteUpdated";
		} else {
			// La note n'existe pas → on insère
			await pool.execute('INSERT INTO notes (userID, recipeID, note) VALUES (?, ?, ?)',
				[req.cookies.pseudoID, recipeID, note]
			);
			message="noteInserted";

		}



		const [notesRes] = await pool.execute('SELECT SUM(note) AS somme,  COUNT(*) AS nbNotes FROM notes WHERE recipeID = ?',
			[recipeID]);

		noteMoy = notesRes[0].somme / notesRes[0].nbNotes;
		console.log(noteMoy);
		const [insertResult2] = await pool.execute('UPDATE recipe SET note = ? WHERE  id = ?',
			[noteMoy, recipeID]);
			
			res.json({succeed:true})

	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});

app.post('/addComment', async (req, res) => {
	console.log("comm :  " + req.body.comment + "   id :" + req.cookies.pseudoID + "   recipeid" + req.cookies.recipeID);
	let comment = req.body.comment;
	let recipeID = req.cookies.recipeID;
	let pseudoID = req.cookies.pseudoID;
	try {

		const [existing] = await pool.execute('SELECT commentaire FROM commentaires WHERE userID = ? AND recipeID = ?',
			[req.cookies.pseudoID, recipeID]);


		if (existing.length) {
			// La note existe → on met à jour
			const [insertResult] = await pool.execute('UPDATE commentaires SET commentaire = ? WHERE userID = ? AND recipeID = ?',
				[comment, req.cookies.pseudoID, recipeID]);
			console.log('commentaire "' + comment + '" modifié');
		} else {
			// La note n'existe pas → on insère
			await pool.execute(
				'INSERT INTO commentaires (userID, recipeID, commentaire) VALUES (?, ?, ?)',
				[pseudoID, recipeID, comment]);
			console.log('commentaire "' + comment + '" crée');

		}
		res.json({succeed:true});

	
	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});


app.post('/deleteComm', (req, res) => {
	const pseudo = req.cookies.pseudo;
	const recipeID = req.body.recipeID; 
	const userID = req.cookies.pseudoID;
	if (!userID) res.json({checkUser:false});
	else {
		console.log("recipeID to delete " + recipeID);
		var query = connection.query(`DELETE FROM commentaires WHERE recipeID = ? AND userID = ?  `
			, [recipeID, req.cookies.pseudoID], function (error, results, fields) {

				if (error) console.log(error) ;

				console.log("supprimée :", results)
				res.json({checkUser:true,check:true});			});
	}
});

app.post('/deleteCommAdmin', (req, res) => {
	const recipeID = req.body.recipeID; 
	const userID = req.body.pseudoID;
	if (req.cookies.userRole!="admin") res.redirect('/');
	else {
		console.log("recipeID to delete " + recipeID);
		var query = connection.query(`DELETE FROM commentaires WHERE recipeID = ? AND userID = ?  `
			, [recipeID, userID ], function (error, results, fields) {

				if (error) throw error;

				console.log("supprimée :", results);
				res.json({check:true});
			});
	}
});

app.post('/deleteNote',async (req, res) => {
	//const pseudo = req.cookies.pseudo;
	const recipeID = req.body.recipeID; 
	const userID = req.cookies.pseudoID;
	if (!userID) res.json({checkUser:false});
	else {

		try {
			await pool.execute('DELETE FROM notes WHERE recipeID = ? AND userID = ?',
				[recipeID, userID]   );

			const [note] = await pool.execute('SELECT AVG(note) AS averageNote FROM notes WHERE recipeID = ?', [recipeID]);
			console.log(note[0].averageNote);
			await pool.execute('UPDATE recipe SET note=? where id=?', [note[0].averageNote,recipeID]);
			return res.json({ check: true, checkUser: true });

		} catch (err) {
			console.error(err);
			return res.json({ check: false, checkUser: true, error: err.message });
		}		

	
	}
});

// modify pseudo or description or image 
app.post('/modifyProfil', async (req, res) => {
	let pseudo = req.body.pseudo;
	let image = req.body.image;
	let description = req.body.description;
	let pseudoID = req.cookies.pseudoID;
	console.log(pseudo + image + description + pseudoID);
	try {
			//check if pseudo already exist
			const [pseudoCheck] = await pool.execute('SELECT * FROM users WHERE pseudo=?',
			[pseudo]);

			if(pseudoCheck.length>0 && pseudo!=req.cookies.pseudo){ res.json({message:"pseudo already exist"});}

		const [insertResult] = await pool.execute('UPDATE users SET pseudo = ?, image=?,description=? WHERE id=?',
			[pseudo, image, description, pseudoID]);


		console.log('commentaire ' + insertResult + 'modifié');

		res.cookie('pseudo', pseudo, {
			maxAge: 3600000,   // expire dans 1h
			httpOnly: true,    // inaccessible côté client (document.cookie)
			secure: false,     // true si HTTPS
		});

		res.json({message:'Profil udpated'});

	} catch (err) {
		console.error('Erreur MySQL :', err);
		//res.status(500).json('Erreur serveur');
	}
});


app.post('/sendMailContact', (req, res) => {
	let checkMessage="";
	const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	if(!regex.test(req.body.mail))checkMessage="mail incorrect";
	if(req.body.message===""){
		if(req.body.MessageCheck!="") checkMessage+=", "
		checkMessage+="message empty";
	}
	console.log(checkMessage);
	if(checkMessage!="") res.json({check: checkMessage})
	else{ 
	let textSubject = " Contact Message by " + req.body.name;
	let message=req.body.message + "\n\n Writed by " + req.body.name + "\n\n Email : " +req.body.mail;

	checkMessage=sendMail( process.env.DB_SMTP_MAIL  ,textSubject,message);
	res.json({check: "Mail sent!" })


	}
	
});



function sendMail(mail,subject,text)
{
	let checkMessage="";
	const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	if(!regex.test(mail))checkMessage="mail incorrect";
	console.log(checkMessage);
	if(checkMessage!="") return checkMessage;
	else{ 
	let transporter = nodemailer.createTransport({
		service: 'gmail',

		auth: {
			user: process.env.DB_SMTP_MAIL,
			pass: process.env.DB_SMTP_PASSWORD
		}
		
	});

	let mailOptions = {
		from: process.env.DB_SMTP_MAIL,
		to: mail,
		subject: subject+' [RECIPE PROJECT]',
		text: text
	};

	transporter.sendMail(mailOptions, function (error, info) {
		if (error) {
			console.log(error);
			return error;
		} else {
			console.log('Email sent: ' + info.response);
			return "Mail sent!";
		}
	});

	}
}


app.post('/getPasswordMail', (req, res) => {
	let checkMessage="";
	let newPassword= crypto.randomBytes(16).toString('hex'); 

	const salt = bcrypt.genSaltSync(10);
	const hashmdp = bcrypt.hashSync(newPassword, salt);
	let mail= req.body.mail;

	connection.query('UPDATE users SET mdp=? where mail=?', [hashmdp,mail], function (error, result, fields) {
		if (error) throw error;
		// Neat!

		let textSubject="Get your password back from Gokhan Recipes ";
		message =` Bonjour, votre nouveau  mot de passe est ${newPassword}`
		checkMessage=sendMail(req.body.mail,textSubject,message);

		res.json({check:true})

		//if (!pseudo) res.render('login', { user: pseudo, erreur: "mailSent" });

			
			});

});



app.post('/changePassword', async(req, res) => {
	//console.log("changemdp" + req.body.passwordNew + req.body.passwordNew2)
		if(req.body.passwordNew!=req.body.passwordNew2 ) res.json({succeed : false, message: 'retape same password' })
		else if(req.body.passwordNew.length<4) res.json({succeed : false, message: 'minimum 4 characters' })
		else{ 
	try {
	
		let recipeID = req.cookies.recipeID;

	mdp = req.body.passwordCurrent;
	console.log(mdp);
	//check password
	
	const [checkPass] = await pool.execute('SELECT mdp FROM users WHERE id = ? ',[req.cookies.pseudoID]);
	let checkHash=false;
	if (checkPass && checkPass.length > 0) {
			hash = checkPass[0].mdp;
			console.log(checkPass[0].mdp);
			resultCompare = await bcrypt.compare(mdp, hash);
			
	
			if(resultCompare){
			console.log('Passwords match! ');				
			const salt = bcrypt.genSaltSync(10);
			const hashmdp = bcrypt.hashSync(req.body.passwordNew, salt);
			const [result] = await pool.execute('UPDATE users SET mdp=? where id=?',[hashmdp,req.cookies.pseudoID] );		
			console.log("change password!")
			res.json({ succeed : true,message: 'Password have been changed!' })
		}
			else{
			// Passwords don't match, authentication failed
			console.log('Passwords do not match! Authentication failed.');
			res.json({succeed : false, message: 'wrong password' })
			}

			}

	//res.redirect('/contact?form=ok&email='+req.body.email);
	//res.render('contact');
		} catch (err) {
        console.error(err);
        //res.status(500).json('accounts', { user: null, erreur: "serverError" });
    }	

}
});

// --- GOOGLE AUTH ---
app.get("/auth/google",
  passport.authenticate("google", { scope: ["profile", "email"] })
);

app.get("/auth/google/callback",
  passport.authenticate("google", { failureRedirect: "/" }),
  (req, res) => {
    res.redirect("/profile");
  }
);

// --- FACEBOOK AUTH ---
app.get("/auth/facebook",
  passport.authenticate("facebook", { scope: ["email"] })
);

app.get("/auth/facebook/callback",
  passport.authenticate("facebook", { failureRedirect: "/" }),
  (req, res) => {
    res.redirect("/profile");
  }
);

// --- INSTAGRAM AUTH ---
app.get("/auth/instagram",
  passport.authenticate("instagram")
);

app.get("/auth/instagram/callback",
  passport.authenticate("instagram", { failureRedirect: "/" }),
  (req, res) => {
    res.redirect("/profile");
  }
);

// --- auth to BDD ---
app.get("/profile", async(req, res) => {
  if (!req.isAuthenticated())     res.redirect('/'); 



   	try {
			const user = req.user;
			const mail = user.emails?.[0]?.value;
   			console.log(mail);

			const [mailCheck] = await pool.execute('SELECT * FROM users WHERE mail=?',[mail]);

			if(mailCheck.length===0){ 
			const [insertMail] = await pool.execute('INSERT INTO users (mail,pseudo) VALUES (?,"NoName")',[mail]);

			}

			const [userInfo] = await pool.execute('SELECT * FROM users WHERE mail=?',[mail]);

			let pseudo=userInfo[0]?.pseudo;
			let pseudoID=userInfo[0].id;
			let userRole= userInfo[0].role;
			
		console.log('pseudo ' + pseudo);

		res.cookie('pseudo', pseudo, {
			maxAge: 3600000,   // expire dans 1h
			httpOnly: true,    // inaccessible côté client (document.cookie)
			secure: false,     // true si HTTPS
		});

			res.cookie('pseudoID', pseudoID, {
			maxAge: 3600000,   // expire dans 1h
			httpOnly: true,    // inaccessible côté client (document.cookie)
			secure: false,     // true si HTTPS
		});

			res.cookie('userRole', userRole, {
			maxAge: 3600000,   // expire dans 1h
			httpOnly: true,    // inaccessible côté client (document.cookie)
			secure: false,     // true si HTTPS
		});		


    		res.redirect('/'); 



	} catch (err) {
    console.error("Database error:", err);
    //res.status(500).json("Server error");
  }
});






app.get(/.*/, (req, res) => {
    res.sendFile(path.join(reactBuildPath, 'index.html'));
});
</file>

<file path="recipe-reactnode-app/src/App.css">
body{
    font-family: "Montserrat", "Poppins", "Avenir Next", "Helvetica Neue", Arial, sans-serif;
    /*background-color: rgba(0, 0, 0, 0.882)!important;
    color: #fff!important;*/
}
h1{
  font-size: 4rem;
}
/*les classes du nav (marges, display...)*/
.navbar {
    margin: 2rem 1rem;
    padding: 2rem;
    /* padding-top: 1rem; */
    margin-top: 1rem;
}

.rightNav{
  display: flex;
}



.navbar .btnCustom{
  padding: 0em 1rem;
    margin-left: 1rem;
    height: 3rem;
    background-color: orangered;
    border-style: none;
}
.navbar .btnCustom2{
  padding: 0em 1rem;
    margin-left: 1rem;
    height: 3rem;
    border-style: none;
}

      .searchWindow{
      display: none;
      height: 2em;
      width: 20em;
      z-index: 10;
    }


.nav-item{
padding: 0em 1rem;
}


.urlActive{
color:orangered!important;
}

.navbar .urlCustom2{
  display: none;  /* just for mobile*/
margin-top: 0.5rem;
}



.signup-container .container-fluid{
width: 95%;
}

.signup-text{
  width: 40%;
text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}



.clickable{
  cursor: pointer;

}

.clickable:active{
  transform: scale(1.2);
}

 /*classes du footer : logos et tableau*/
    .logos{
      display: flex;
      justify-content: flex-end;

    }
 

    .table-perso{
        width: 100%;
     display: flex;
    }

    .table-perso ul{
      display: flex;
      flex-direction: column;
       width: 100%;

      padding: 0rem;
      font-size: 1.3em;
      font-weight: bold;
      gap :1rem;
}

.table-perso li{
  list-style-type: none;
    text-decoration: none; 
    color: black;  
    text-align: left;

     
    }

  .table-perso a{
    text-decoration: none; 
    color: black;       
    }


    .textTab{
      text-decoration: none;
      color:grey;
    }

/* HOME PAGE */
/*  recipe menu */

        .accordion {
      border: none;
      box-shadow: none;
    }

    .accordion-item {
      border: none;
      background: transparent;
      width: 15rem;
    }

    .accordion-button {
      background: transparent;
      box-shadow: none !important;
      color: #000;
      font-weight: 500;
      padding: 0.75rem 1rem;
      position: relative;
    }

    /* delete default bootstrap arrow*/
    .accordion-button::after {
      display: none;
    }

    /* add + and -*/
    .accordion-button::before {
      content: "+";
      position: absolute;
      right: 1rem;
      font-weight: bold;
      font-size: 1.2rem;
      transition: transform 0.3s, content 0.3s;
    }

    .accordion-button[aria-expanded="true"]::before {
      content: "−";
    }

    .accordion-body {
      padding: 0.5rem 1.5rem;
    }

    

    /* accordion style */
    .accordion-body a {
      display: block;
      color: #333;
      text-decoration: none;
      padding: 0.25rem 0;
    }


    .textSearchMenu{
      cursor: pointer;
      padding: 0;
      margin: 0.5rem 0.3rem;
    }

/*classes pour la recherche et la recipe list*/
.background-perso{
background-color: #0b5dd700; 
/* background-image: url("https://www.themealdb.com/images/media/meals/qptpvt1487339892.jpg"); */
 background-image: url("/background2.webp");
background-size: cover;

text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);

}

/* .recipeSearch{
display: flex;
justify-content: space-around;
margin: 0rem 0 1rem 1rem;
} */

.input-group{
  min-width: 100%;
  width: 100%;
}

.btnSearch{
    cursor: pointer;
}

.btnSearch:active{
    transform: scale(0.9);
}

.searchHome .search-select{
margin-right: 3rem ;
}

/* .recipeSearch form{
width: 50rem;
} */

.recipeGroup{
    display: flex;   
    align-items: top;   
}

.recipe-container{
    display: flex;
    flex-direction: column; 
     align-items:top;
     max-width: 100%;
}

 .form-select{
  background-color: orangered;
  width: 10em;
  color : white;
}

.recipeList{
    margin-right: 6em;
    display: flex;
    flex-direction: row;
    justify-content: space-around;
}

.card{
        height: 240px;        
        position: relative;         
      width: 400px;
    cursor: pointer;
    
}

.fa-star{
  color:#ffe600
}


 .card-img-top {
           height: 240px;                 
      width: 400px;               
      object-fit: cover;            
    }
    
    


    .heart-icon {
      position: absolute;
      top: 1em;
      right: 1em;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 20;
    }

    .heart-icon i {
      color: #dc3545;
      font-size: 1.2rem;
    }



    

    .carousel-indicators [data-bs-target] {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      text-indent: 0;               /* on annule le masquage du texte */
      color: #fff;
      background-color: #0d6efd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin: 0 5px;
      border: none;
    }


    .carousel-indicators .btn{
          cursor: pointer;
          transition: transform 0.2s ease;
         color:#000000;


    }

   
    .carousel-indicators .active {
      color:#34c6ff;
      font-weight: bold;
    }

    .videos-container{
        display: flex;
        justify-content: space-around;
        gap :1em;
    }

    .videoTitle{
    display: flex;
        justify-content: space-between;

    }

    .subscribeSection{
        margin-top: 1rem;
        display: flex;
        justify-content: center;
    }

      .subscribeSection .form-control::placeholder {
    color: white !important;
    }

   .searchbar {
    background-color: #fff9ef;
    }

    .searchbar-group {
    background-color: #fff9ef;
    } 
     

    .subscribeSection .btn{
        height: 3em;
        width: 10em;
        background-color:orange; 
    }


 iframe {
  width: 100%;
  aspect-ratio: 16 / 9;  
  border-radius: 10px;
}

   /*Search Page*/
    
      .recipeList2{
          display: flex;
          flex-direction: row;
          gap: 2em;
          width: 100%;
      }

    .recipeList2 .cardCarousel { 
      margin: 2rem;
    }
    
     .recipeList2 .card-img-top {
      height: 200px;                
      object-fit: cover;            
    }
/* 
    .recipeForm form{
      width: 50%;
    } */

 /*Recipe Page*/

 .recipeTitle{
  max-width: 100%;
 }
 .image-container{
display: flex;
justify-content: center; }

 .recipePhoto{
 width: 30em;
 height: 30em;
 }

 .descriptionLogos{
  justify-content: space-evenly;
 }

 .descriptionRecipe{
  align-items: center;
  max-width: 80%;}

  .makeRecipe-container{
    display: flex;
    flex-direction: row; 

  }
  
  .recipeLeft{
    width: 70%;
  }

 .nbStep{
  width: 6em;
 }

   .recipeRight{
    width: 30%;
  }

  .comments{ 
    width: 75%;
  }

.com-container2{
margin-left: 30%;
width: 100%;
}

.imageComm{
  width: 100px;
  height: 100px;
  object-fit: cover;
}


  .videoSection2{
    background-color: #fff8f8d8;
  }


  .videos-container2{
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;

  }

   .videoSection2 .card {
      width: 18em;              
      object-fit: cover;   
      margin: 1em;         
    }
        .card-title {
        min-height : 2em;  

       }


  .videoSection2 .card-img-top {
      height: 15em;  
      width: 18em;              
      object-fit: cover;     
             
    }

    .videoSection .card {
      width: 20em;              
      object-fit: cover;            
    }

       .videoSection .card-img-top {
      height: 15em;  
      width: 20em;             
      object-fit: cover;            
    } 

     .overflow-x
    {
        flex-wrap: nowrap;       
        overflow-x: auto;      
          overflow-y: hidden;      

        -webkit-overflow-scrolling: touch; 
        touch-action: pan-x;     

        scroll-behavior: smooth; 
    }
    .videos-container .card
    {
        touch-action: manipulation;
        -webkit-user-select: none;
        user-select: none;
    }
    .videos-container .card-title
    {
      height: 5em;
    }

    .form2{
      background-color: rgba(244, 118, 7, 0.96);
      width: auto;
      height: auto;
      color : white;
    }

    /*Contact Page*/

    .contactGroup{
      flex-direction: row;
      width: 100%;
    }

    .contactText{
      width: 50%;
    }

    .contactForm-container{
      width: 49%;
    }

    .messageForm{
      height: 10rem;
    }


    /*Signup window*/

    .signWindow{
      display: none;
      border-radius: 2%;
      position:absolute;
      width: 90%;
      height: 90%;
      top:  7% ;
      left: 5%;
      overflow: hidden;
    }

  
    .overlay{
      position: fixed; 
      top: 0; 
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.541); 
      z-index: 10; 
    }

      .overlay3{
      position: fixed; 
      top: 0; 
      left: 0;
      width: 100vw;
      height: 100vh;
    }

      

    

    .signWindow .btnClose{
      z-index: 10; 
      position:fixed;
      top:  2% ;
      right: 5%;
    }

       .btnClose2{
      position:relative;
      z-index: 10; 
      height: 2em;
      width: 2em;
      left: 92%;
      top: 3em;    }

        /*Signup Page*/

    .signupSection{
      width: 50%;
      padding-top: 10em;
      align-items: center;   }

    .signupSection .btn{
       width: 8rem ; 
     }

    .signupSection .addMargin{
       margin-top: 10rem; 
      margin-bottom: 10rem;  
   }


   /*signup div*/

   .signup{
    position: fixed;
    width: 50%;
    left: 25%;
    top:10%;
    z-index: 20;

   }

   
   .signup2{
    position: relative;
    width: 50%;
    z-index: 20;
   }

        .formAlign{
      display: flex;
      flex-direction: column;  
      justify-content: center;  
      align-items: center;
    }


   .overlay2{

    position: relative;
    display: none;
   }

   .btnAc{
    cursor: pointer;
   }
   .btnAc:active{
    transform: scale(1.2);
   }

   /*account page */

  .cardExt{
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
   }

   .accordion{
    align-items: center;
   }

    .mobile{
    display:none;
   }

   .form-control-big{
    height: 10em;
   }

   iframe {
  background-color: white; /* ou autre couleur */
}
 



@media (hover: hover) {

      .accordion-body a:hover {
      color: #007bff;
    }

    .signup-text a:hover{
    color: blue!important;
    }

      .nav-link:hover{
      color:rgb(0, 94, 255)!important;
    }

      .card:hover {
        transform: translateY(-5px); 
        transform: scale(1.02); 
        box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.175) !important; 
      }

     .carousel-indicators .btn:hover{
      transform: scale(1.2);
    }

        .card:active:not(:has(.heart-icon:hover)){
      transform: scale(0.9);  
    }

        .heart-icon:hover {
      transform: scale(1.1);
    }

       .subscribeSection .btn:hover{
        background-color:yellow;     
    }



}
</file>

</files>
