import{r as c,u as y,c as b,j as e,a as u,R as C,F as R,d as k,T,e as S,W as E,f as I,b as F,g as D}from"./index-DXKGz-5Y.js";import{C as L}from"./cardUser-B3vDnlOh.js";function M({recipeID:t}){const[r,i]=c.useState(""),n=y(),a=b(d=>d.setRecipeID);async function p(){try{const{data:d}=await u.post("https://corentinchan.de/deleteRecipe",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend description :",d),console.log(d.message),d.check&&(n("/recipe"),a(null))}catch(d){console.error("error axios :",d)}}return e.jsxs("div",{className:" w-75 d-flex justify-content-between mt-5 noprint",children:[e.jsxs("p",{className:"mx-3 rounded-pill  p-1",children:["Recipe ID : ",t," "]}),e.jsx("button",{type:"button",onClick:()=>n("/modifyRecipe",{state:{recipeID:t}}),className:" btn-outline-primary bg-primary mx-2 rounded-pill border border-black p-1 ",children:"Modify recipe"}),e.jsx("button",{type:"button",name:"recipeID",value:t,onClick:p,className:" btn-warning bg-danger mx-2 rounded-pill border  border-black p-1",children:"Delete recipe"})]})}function A({recipeID:t,userRole:r,updateForm:i,meal:n,setMeal:a}){const[p,d]=c.useState(""),[s,o]=c.useState(0),[h,l]=c.useState(0),[g,v]=c.useState(!1),N=b(j=>j.user);function f(){async function j(){try{const{data:m}=await u.post("https://corentinchan.de/addList",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend description :",m),console.log(m.message),d(m.message);const w=document.getElementById("message");m.message==="List Added"?w.style.color="green":w.style.color="red"}catch(m){console.error("error axios :",m)}}console.log(t),j()}async function x(){const j=/(https?:\/\/(?:www\.)?(youtube\.com|youtu\.be)\/\S+)/;try{const{data:m}=await u.post("https://corentinchan.de/recipeDescription",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});d(""),a(m.recipe[0]),o(m.nbNotes),l(m.nbRecipes),m.recipe[0]&&(v(j.test(m.recipe[0].description)),console.log("Réponse backend descrption :",m),console.log(m.recipe[0].image))}catch(m){console.error("error axios :",m)}}return c.useEffect(()=>{console.log(t),x()},[t]),c.useEffect(()=>{x()},[i]),e.jsx("div",{className:"recipeTitle row gx-0",children:n&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-lg-flex container ",children:[e.jsx("div",{className:"col-lg-6",children:e.jsx("div",{className:" justify-content-center  image-container",children:e.jsx("img",{src:n.image?n.image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRwAdnj607fkyztZ3TkKVTdEy-FG-tD-gEGJQ&s",className:" tilt1  pt-3 rounded-5 recipePhoto",alt:"image"})})}),e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:" pt-3 descriptionRecipe",children:[e.jsx("h1",{className:"fade-in",children:n.title}),e.jsxs("p",{children:[n.note,"  ",e.jsx("i",{className:"fa-solid fa-star"})," (",s,")"]}),g?e.jsx(e.Fragment,{children:e.jsxs("p",{className:"text-black-50  fs-4",children:[e.jsx("a",{href:n.description,target:"_blank",rel:"noopener noreferrer",children:e.jsx("i",{className:"fa-brands fa-youtube fs-1"})})," "]})}):e.jsxs("p",{children:[" ",n.decription]}),e.jsxs("div",{className:"d-flex text-center  descriptionLogos border-bottom",children:[e.jsxs("div",{className:"logo1  p-3 mx-2  m-lg-3 px-lg-5 text-center border-end",children:[e.jsx("i",{className:"fa-regular fa-clock fs-3 rotatec"}),e.jsx("p",{className:"m-0 p-0",children:n.activeTime}),e.jsx("p",{className:"m-0 p-0 text-black-50 ",id:"activeTime"})]}),e.jsxs("div",{className:"logo2  p-3 mx-2 m-lg-3 px-lg-5 text-center border-end",children:[e.jsx("i",{className:"fa-solid fa-clock-rotate-left fs-3 rotatec"}),e.jsx("p",{className:"m-0 p-0",children:n.totalTime}),e.jsx("p",{className:"m-0 p-0 text-black-50 ",id:"totalTime"})]}),e.jsxs("div",{className:"logo3 p-3 mx-2 m-lg-3 px-lg-5 text-center",children:[e.jsx("i",{className:"fa-solid fa-users fs-3"}),e.jsx("p",{className:"m-0 p-0",children:n.yield}),e.jsx("p",{className:"m-0 p-0 text-black-50",id:"yield",children:" Serves "})]})]}),e.jsxs("div",{className:"d-flex mt-2 bottomDescription align-items-center",children:[e.jsxs("div",{className:"container ",children:[e.jsxs("p",{className:"m-0 p-0",children:["Created by ",e.jsx("span",{className:"text-danger",id:"author",children:n.auteur})," "]}),e.jsxs("p",{className:"m-0 p-0 text-black-50",id:"nbRecipes",children:[" Total recipes : ",h," "]})]}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center  ",children:[N&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-4 ",id:"message",children:p}),e.jsx("i",{className:"fa-regular fa-plus fs-3 mx-3 clickable",onClick:f})," "]}),e.jsx("i",{className:"fa-solid fa-cart-arrow-down fs-3 mx-3 clickable"}),e.jsx("i",{className:"fa-solid fa-print fs-3 mx-3 clickable",id:"print",onClick:window.print})]})]}),r==="admin"&&e.jsx(M,{recipeID:t})]})})]})})})}function P({recipeID:t}){const[r,i]=c.useState([]);return c.useEffect(()=>{async function n(){try{const{data:a}=await u.post("https://corentinchan.de/getSteps",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});i(a.instructions),console.log("Réponse backend :",a)}catch(a){console.error("error axios :",a)}}console.log(t),n()},[t]),e.jsxs("div",{className:"recipeSteps",children:[e.jsx("h2",{className:" mt-5  my-lg-0",children:"How to make it"}),e.jsx("ol",{className:"mt-lg-4 list-group instructionsList",children:r&&r.map((n,a)=>e.jsxs(C.Fragment,{children:[" ",e.jsxs("li",{className:"d-flex border-0",children:[e.jsx("i",{className:"fa-regular fa-circle-check fs-2 me-3"}),e.jsxs("h4",{className:"text-danger pt-1",children:[a+1,".STEP"]}),e.jsx("div",{className:"container-fluid border-top m-3 me-5"})]}),e.jsx("li",{className:"list-group-item border-0 border-bottom-1 mx-5 text-black-50 fs-5",children:n.instruction})]},a))})]})}function z({recipeID:t,udpateForm:r,userRole:i}){const[n,a]=c.useState([]);y();async function p(){try{const{data:s}=await u.post("https://corentinchan.de/getComment",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});a(s.comment),console.log("Réponse backend comm :",s)}catch(s){console.error("error axios :",s)}}c.useEffect(()=>{console.log(t),p()},[t]),c.useEffect(()=>{p()},[r]);async function d(s){s.preventDefault();const o=s.target.recipeID.value,h=s.target.pseudoID.value;try{const{data:l}=await u.post("https://corentinchan.de/deleteCommAdmin",{recipeID:o,pseudoID:h},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend comm :",l),l.check&&p()}catch(l){console.error("error axios :",l)}}return e.jsxs("div",{className:"comments mt-lg-5 pt-5 noprint",id:"commentPart",children:[e.jsx("h3",{children:"Comments"}),n&&n.map((s,o)=>e.jsx("div",{className:o%2?"list-group p-lg-3 com-container2":"list-group p-lg-3",children:e.jsxs("div",{className:o%2?"list-group-item  bg-danger-subtle":"list-group-item ","aria-current":"true",children:[e.jsxs("div",{className:" w-100 justify-content-between",children:[e.jsxs("div",{className:"d-flex ",children:[e.jsx("img",{className:"imageComm fs-1 mx-lg-0 me-2 me-lg-3 py-1   rounded-circle",src:s.image?s.image:"https://picsum.photos/400/250?random=1"}),e.jsxs("div",{className:"d-flex flex-column mt-2 mt-lg-3",children:[e.jsx("h5",{className:`mb-1 ${i==="admin"?"text-info":""}`,children:s.pseudo}),i==="admin"&&e.jsxs("p",{children:["id : ",s.userID," , ",s.mail," "]}),e.jsx("small",{className:"text-black-50",children:s.date}),e.jsxs("div",{children:[" ",e.jsx("span",{className:"",children:s.note&&[...Array(5)].map((h,l)=>s.note>l?e.jsx("i",{className:"fa-solid fa-star"},l):e.jsx("i",{className:"fa-regular fa-star"},l))})]})]})]}),e.jsx("p",{className:"my-1 py-3",children:s.commentaire})]}),i==="admin"&&e.jsxs("form",{class:"justify-content-center",method:"post",onSubmit:d,children:[e.jsx("button",{type:"submit",class:"btn bg-danger text-center rounded-pill border-black border-1",children:"Delete comment"}),e.jsx("input",{hidden:!0,name:"pseudoID",value:s.userID}),e.jsx("input",{hidden:!0,name:"recipeID",value:t})]})]})},s.index))]})}function B({recipeID:t}){const[r,i]=c.useState([]);return c.useEffect(()=>{async function n(){try{const{data:a}=await u.post("https://corentinchan.de/getIngredients",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});i(a.ingredients),console.log("Réponse backend :",a)}catch(a){console.error("error axios :",a)}}console.log(t),n()},[t]),e.jsxs("div",{className:"mt-5 mt-lg-0 recipeIngredients",children:[e.jsx("h2",{children:"Ingredients"}),e.jsx("ul",{className:"list-group ingredientsList",children:r?.map((n,a)=>e.jsxs("li",{className:"list-group-item border-0 border-bottom",children:[n.measure," of ",n.ingredient]},`ingredient-${a}`))})]})}function G({recipeID:t}){const[r,i]=c.useState([]);return c.useEffect(()=>{async function n(){try{const{data:a}=await u.post("https://corentinchan.de/getTags",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});i(a.tags),console.log("Réponse backend tags :",a),console.log(a.tags)}catch(a){console.error("error axios :",a)}}console.log(t),n()},[t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:" pt-3 mt-3",children:[e.jsx("h3",{children:"Tags"}),e.jsx("div",{className:"tags",children:r&&r.map((n,a)=>e.jsx("span",{className:"badge text-bg-primary m-2 fs-5",children:n.tag},a))})]})})}function W({recipeID:t,meal:r}){const i="https://corentinchan.de/recipe?id="+t;return r&&e.jsxs("div",{className:"shareRecipe pt-3 mt-3",children:[e.jsx("h3",{children:"Share recipes"}),e.jsxs("div",{children:[e.jsx(R,{className:"m-2",url:i,quote:r?.title,children:e.jsx(k,{size:32,round:!0})}),e.jsx(T,{className:"m-2",url:i,title:r?.title,children:e.jsx(S,{size:32,round:!0})}),e.jsx(E,{className:"m-2",url:i,title:r?.title,separator:":: ",children:e.jsx(I,{size:32,round:!0})})]})]})}function q({recipeID:t,updateForm:r,setUpdateForm:i}){const[n,a]=c.useState([]);y();const p=s=>{console.log(s.target.value);let o=s.target.value;async function h(){try{const{data:l}=await u.post("https://corentinchan.de/giveNote",{note:o},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend tags :",l),console.log(l.succeed),i(g=>g+1)}catch(l){console.error("error axios :",l)}}console.log(t),h()};c.useEffect(()=>{console.log("updateForm changed:",r)},[r]);function d(s){s.preventDefault();let o=n;async function h(){try{const{data:l}=await u.post("https://corentinchan.de/addComment",{comment:o},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log(l.succeed),i(g=>g+1)}catch(l){console.error("error axios :",l)}}h()}return e.jsx("div",{className:"list-group p-lg-3 noprint",children:e.jsxs("div",{className:"list-group-item","aria-current":"true",children:[e.jsx("div",{className:" d-flex w-100 justify-content-between",children:e.jsxs("div",{className:"d-flex",children:[e.jsx("i",{className:"fa-solid fa-star p-3"}),e.jsxs("select",{onChange:p,className:"form-select form2",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Give a note"}),e.jsx("option",{children:"1"}),e.jsx("option",{children:"2"}),e.jsx("option",{children:"3"}),e.jsx("option",{children:"4"}),e.jsx("option",{children:"5"})]})]})}),e.jsxs("form",{className:"my-1 py-3",onSubmit:d,children:[e.jsxs("div",{className:" ",children:[e.jsx("label",{htmlFor:"comment",children:"Comments:"}),e.jsx("textarea",{className:"form-control",rows:"5",id:"commentForm",name:"text",onChange:s=>a(s.target.value),value:n})]}),e.jsx("button",{type:"submit",className:"btn mt-3 btn-primary ",children:"Submit"})]})]})})}function V({recipeID:t}){const[r,i]=c.useState([]),[n,a]=c.useState(!0),[p,d]=c.useState([]);async function s(){try{const{data:o}=await u.post("https://corentinchan.de/getRecipeReco",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("recipe reco "+o.recipeReco),d(o.recipeReco)}catch(o){console.error("error axios :",o)}}return c.useEffect(()=>{s()},[t]),e.jsxs("div",{className:"videoSection2 bg-light container-fluid py-5   ",children:[e.jsx("div",{className:"videoTitle m-3 m-lg-5 ",children:e.jsx("h2",{children:"Others recipes you may like"})}),e.jsx("div",{className:"videos-container2 m-lg-5",id:"videos-container",children:p.map(o=>e.jsx(L,{title:o.title,img:o.image,id:o.id,author:o.auteur,note:o.note},o.id))})]})}function $({user:t,userRole:r}){const[i]=F(),[n,a]=c.useState(!0),[p,d]=c.useState(0),s=b(x=>x.recipeID),o=b(x=>x.setRecipeID),[h,l]=c.useState(null),[g,v]=c.useState(null),N=D();c.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"}),o(i.get("id")||s)},[N.state]);async function f(){try{const{data:x}=await u.post("https://corentinchan.de/setRecipeID",{recipeID:s},{headers:{"Content-Type":"application/json"},withCredentials:!0});s===null&&o(x.recipeID)}catch(x){console.error("error axios :",x)}}return c.useEffect(()=>{f()},[s]),c.useEffect(()=>{f()},[]),c.useEffect(()=>{console.log("Meal updated:",h)},[h]),e.jsx(e.Fragment,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(A,{recipeID:s,userRole:r,udpateForm:p,meal:h,setMeal:l}),e.jsxs("div",{className:"m-1 p-1 m-lg-5 p-lg-3 makeRecipe-container",children:[e.jsxs("div",{className:"  recipeLeft",children:[e.jsx(P,{recipeID:s}),e.jsx(z,{recipeID:s,udpateForm:p,userRole:r}),t&&e.jsx(q,{recipeID:s,udpateForm:p,setUpdateForm:d})]}),e.jsxs("div",{className:"recipeRight",children:[e.jsx(B,{recipeID:s}),e.jsx(G,{recipeID:s}),e.jsx(W,{recipeID:s,meal:h})]})]}),e.jsx(V,{recipeID:s})]})})}export{$ as default};
