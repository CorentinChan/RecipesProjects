import{r as o,u as N,c as y,j as e,a as g,R,F as C,d as T,T as k,e as S,W as E,f as I,b as F,g as D}from"./index-DRZgVEmj.js";import{C as $}from"./cardUser-BWffetCZ.js";function L({recipeID:n}){const[r,l]=o.useState(""),a=N(),i=y(p=>p.setRecipeID);async function h(){try{const{data:p}=await g.post("https://corentinchan.de/deleteRecipe",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend description :",p),console.log(p.message),p.check&&(a("/recipe"),i(null))}catch(p){console.error("error axios :",p)}}return e.jsxs("div",{className:" w-75 d-flex justify-content-between mt-5 noprint",children:[e.jsxs("p",{className:"mx-3 rounded-pill  p-1",children:["Recipe ID : ",n," "]}),e.jsx("button",{type:"button",onClick:()=>a("/modifyRecipe",{state:{recipeID:n}}),className:" btn-outline-primary bg-primary mx-2 rounded-pill border border-black p-1 ",children:"Modify recipe"}),e.jsx("button",{type:"button",name:"recipeID",value:n,onClick:h,className:" btn-warning bg-danger mx-2 rounded-pill border  border-black p-1",children:"Delete recipe"})]})}function A({recipeID:n,userRole:r,updateForm:l,meal:a,setMeal:i}){const[h,p]=o.useState(""),[t,c]=o.useState(0),[s,d]=o.useState(0),[x,v]=o.useState(!1),b=y(j=>j.user);function f(){async function j(){try{const{data:m}=await g.post("https://corentinchan.de/addList",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend description :",m),console.log(m.message),p(m.message);const w=document.getElementById("message");m.message==="List Added"?w.style.color="green":w.style.color="red"}catch(m){console.error("error axios :",m)}}console.log(n),j()}async function u(){const j=/(https?:\/\/(?:www\.)?(youtube\.com|youtu\.be)\/\S+)/;try{const{data:m}=await g.post("https://corentinchan.de/recipeDescription",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});p(""),i(m.recipe[0]),c(m.nbNotes),d(m.nbRecipes),m.recipe[0]&&(v(j.test(m.recipe[0].description)),console.log("Réponse backend descrption :",m),console.log(m.recipe[0].image))}catch(m){console.error("error axios :",m)}}return o.useEffect(()=>{console.log(n),u()},[n]),o.useEffect(()=>{u()},[l]),e.jsx("div",{className:"recipeTitle row gx-0",children:a&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-lg-flex container ",children:[e.jsx("div",{className:"col-lg-6",children:e.jsx("div",{className:" justify-content-center  image-container",children:e.jsx("img",{src:a.image?a.image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRwAdnj607fkyztZ3TkKVTdEy-FG-tD-gEGJQ&s",className:" tilt1  pt-3 rounded-5 recipePhoto",alt:"image"})})}),e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:" pt-3 descriptionRecipe",children:[e.jsx("h1",{className:"fade-in",children:a.title}),e.jsxs("p",{children:[a.note,"  ",e.jsx("i",{className:"fa-solid fa-star"})," (",t,")"]}),x?e.jsx(e.Fragment,{children:e.jsxs("p",{className:"text-black-50  fs-4",children:[e.jsx("a",{href:a.description,target:"_blank",rel:"noopener noreferrer",children:e.jsx("i",{className:"fa-brands fa-youtube fs-1"})})," "]})}):e.jsxs("p",{children:[" ",a.decription]}),e.jsxs("div",{className:"d-flex text-center  descriptionLogos border-bottom",children:[e.jsxs("div",{className:"logo1  p-3 mx-2  m-lg-3 px-lg-5 text-center border-end",children:[e.jsx("i",{className:"fa-regular fa-clock fs-3 rotatec"}),e.jsx("p",{className:"m-0 p-0",children:a.activeTime}),e.jsx("p",{className:"m-0 p-0 text-black-50 ",id:"activeTime"})]}),e.jsxs("div",{className:"logo2  p-3 mx-2 m-lg-3 px-lg-5 text-center border-end",children:[e.jsx("i",{className:"fa-solid fa-clock-rotate-left fs-3 rotatec"}),e.jsx("p",{className:"m-0 p-0",children:a.totalTime}),e.jsx("p",{className:"m-0 p-0 text-black-50 ",id:"totalTime"})]}),e.jsxs("div",{className:"logo3 p-3 mx-2 m-lg-3 px-lg-5 text-center",children:[e.jsx("i",{className:"fa-solid fa-users fs-3"}),e.jsx("p",{className:"m-0 p-0",children:a.yield}),e.jsx("p",{className:"m-0 p-0 text-black-50",id:"yield",children:" Serves "})]})]}),e.jsxs("div",{className:"d-flex mt-2 bottomDescription align-items-center",children:[e.jsxs("div",{className:"container ",children:[e.jsxs("p",{className:"m-0 p-0",children:["Created by ",e.jsx("span",{className:"text-danger",id:"author",children:a.auteur})," "]}),e.jsxs("p",{className:"m-0 p-0 text-black-50",id:"nbRecipes",children:[" Total recipes : ",s," "]})]}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center  ",children:[b&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-4 ",id:"message",children:h}),e.jsx("i",{className:"fa-regular fa-plus fs-3 mx-3 clickable",onClick:f})," "]}),e.jsx("i",{className:"fa-solid fa-cart-arrow-down fs-3 mx-3 clickable"}),e.jsx("i",{className:"fa-solid fa-print fs-3 mx-3 clickable",id:"print",onClick:window.print})]})]}),r==="admin"&&e.jsx(L,{recipeID:n})]})})]})})})}function M({recipeID:n}){const[r,l]=o.useState([]);return o.useEffect(()=>{async function a(){try{const{data:i}=await g.post("https://corentinchan.de/getSteps",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});l(i.instructions),console.log("Réponse backend :",i)}catch(i){console.error("error axios :",i)}}console.log(n),a()},[n]),e.jsxs("div",{className:"recipeSteps",children:[e.jsx("h2",{className:" mt-5  my-lg-0",children:"How to make it"}),e.jsx("ol",{className:"mt-lg-4 list-group instructionsList",children:r&&r.map((a,i)=>e.jsxs(R.Fragment,{children:[" ",e.jsxs("li",{className:"d-flex border-0",children:[e.jsx("i",{className:"fa-regular fa-circle-check fs-2 me-3"}),e.jsxs("h4",{className:"text-danger pt-1",children:[i+1,".STEP"]}),e.jsx("div",{className:"container-fluid border-top m-3 me-5"})]}),e.jsx("li",{className:"list-group-item border-0 border-bottom-1 mx-5 text-black-50 fs-5",children:a.instruction})]},i))})]})}function P({recipeID:n,udpateForm:r,userRole:l}){const[a,i]=o.useState([]);N();async function h(){try{const{data:t}=await g.post("https://corentinchan.de/getComment",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});i(t.comment),console.log("Réponse backend comm :",t)}catch(t){console.error("error axios :",t)}}o.useEffect(()=>{console.log(n),h()},[n]),o.useEffect(()=>{h()},[r]);async function p(t){t.preventDefault();const c=t.target.recipeID.value,s=t.target.pseudoID.value;try{const{data:d}=await g.post("https://corentinchan.de/deleteCommAdmin",{recipeID:c,pseudoID:s},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend comm :",d),d.check&&h()}catch(d){console.error("error axios :",d)}}return e.jsxs("div",{className:"comments mt-lg-5 pt-5 noprint",id:"commentPart",children:[e.jsx("h3",{children:"Comments"}),a&&a.map((t,c)=>e.jsx("div",{className:c%2?"list-group p-lg-3 com-container2":"list-group p-lg-3",children:e.jsxs("div",{className:c%2?"list-group-item  bg-danger-subtle":"list-group-item ","aria-current":"true",children:[e.jsxs("div",{className:" w-100 justify-content-between",children:[e.jsxs("div",{className:"d-flex ",children:[e.jsx("img",{className:"imageComm fs-1 mx-lg-0 me-2 me-lg-3 py-1   rounded-circle",src:t.image?t.image:"https://picsum.photos/400/250?random=1"}),e.jsxs("div",{className:"d-flex flex-column mt-2 mt-lg-3",children:[e.jsx("h5",{className:`mb-1 ${l==="admin"?"text-info":""}`,children:t.pseudo}),l==="admin"&&e.jsxs("p",{children:["id : ",t.userID," , ",t.mail," "]}),e.jsx("small",{className:"text-black-50",children:t.date}),e.jsxs("div",{children:[" ",e.jsx("span",{className:"",children:t.note&&[...Array(5)].map((s,d)=>t.note>d?e.jsx("i",{className:"fa-solid fa-star"},d):e.jsx("i",{className:"fa-regular fa-star"},d))})]})]})]}),e.jsx("p",{className:"my-1 py-3",children:t.commentaire})]}),l==="admin"&&e.jsxs("form",{class:"justify-content-center",method:"post",onSubmit:p,children:[e.jsx("button",{type:"submit",class:"btn bg-danger text-center rounded-pill border-black border-1",children:"Delete comment"}),e.jsx("input",{hidden:!0,name:"pseudoID",value:t.userID}),e.jsx("input",{hidden:!0,name:"recipeID",value:n})]})]})},t.index))]})}function z({recipeID:n}){const[r,l]=o.useState([]);return o.useEffect(()=>{async function a(){try{const{data:i}=await g.post("https://corentinchan.de/getIngredients",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});l(i.ingredients),console.log("Réponse backend :",i)}catch(i){console.error("error axios :",i)}}console.log(n),a()},[n]),e.jsxs("div",{className:"mt-5 mt-lg-0 recipeIngredients",children:[e.jsx("h2",{children:"Ingredients"}),e.jsx("ul",{className:"list-group ingredientsList",children:r?.map((a,i)=>e.jsxs("li",{className:"list-group-item border-0 border-bottom",children:[a.measure," of ",a.ingredient]},`ingredient-${i}`))})]})}function B({recipeID:n}){const[r,l]=o.useState([]);return o.useEffect(()=>{async function a(){try{const{data:i}=await g.post("https://corentinchan.de/getTags",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});l(i.tags),console.log("Réponse backend tags :",i),console.log(i.tags)}catch(i){console.error("error axios :",i)}}console.log(n),a()},[n]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:" pt-3 mt-3",children:[e.jsx("h3",{children:"Tags"}),e.jsx("div",{className:"tags",children:r&&r.map((a,i)=>e.jsx("span",{className:"badge text-bg-primary m-2 fs-5",children:a.tag},i))})]})})}function G({recipeID:n,meal:r}){const l="https://corentinchan.de/recipe?id="+n;return r&&e.jsxs("div",{className:"shareRecipe pt-3 mt-3",children:[e.jsx("h3",{children:"Share recipes"}),e.jsxs("div",{children:[e.jsx(C,{className:"m-2",url:l,quote:r?.title,children:e.jsx(T,{size:32,round:!0})}),e.jsx(k,{className:"m-2",url:l,title:r?.title,children:e.jsx(S,{size:32,round:!0})}),e.jsx(E,{className:"m-2",url:l,title:r?.title,separator:":: ",children:e.jsx(I,{size:32,round:!0})})]})]})}function V({recipeID:n,updateForm:r,setUpdateForm:l}){const[a,i]=o.useState([]);N();const h=t=>{console.log(t.target.value);let c=t.target.value;async function s(){try{const{data:d}=await g.post("https://corentinchan.de/giveNote",{note:c},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("Réponse backend tags :",d),console.log(d.succeed),l(x=>x+1)}catch(d){console.error("error axios :",d)}}console.log(n),s()};o.useEffect(()=>{console.log("updateForm changed:",r)},[r]);function p(t){t.preventDefault();let c=a;async function s(){try{const{data:d}=await g.post("https://corentinchan.de/addComment",{comment:c},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log(d.succeed),l(x=>x+1)}catch(d){console.error("error axios :",d)}}s()}return e.jsx("div",{className:"list-group p-lg-3 noprint",children:e.jsxs("div",{className:"list-group-item","aria-current":"true",children:[e.jsx("div",{className:" d-flex w-100 justify-content-between",children:e.jsxs("div",{className:"d-flex",children:[e.jsx("i",{className:"fa-solid fa-star p-3"}),e.jsxs("select",{onChange:h,className:"form-select form2",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Give a note"}),e.jsx("option",{children:"1"}),e.jsx("option",{children:"2"}),e.jsx("option",{children:"3"}),e.jsx("option",{children:"4"}),e.jsx("option",{children:"5"})]})]})}),e.jsxs("form",{className:"my-1 py-3",onSubmit:p,children:[e.jsxs("div",{className:" ",children:[e.jsx("label",{htmlFor:"comment",children:"Comments:"}),e.jsx("textarea",{className:"form-control",rows:"5",id:"commentForm",name:"text",onChange:t=>i(t.target.value),value:a})]}),e.jsx("button",{type:"submit",className:"btn mt-3 btn-primary ",children:"Submit"})]})]})})}function W({recipeID:n}){const[r,l]=o.useState([]),[a,i]=o.useState(!0),[h,p]=o.useState([]);async function t(){try{const{data:c}=await g.post("https://corentinchan.de/getRecipeReco",{recipeID:n},{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log("recipe reco "+c.recipeReco),p(c.recipeReco)}catch(c){console.error("error axios :",c)}}return o.useEffect(()=>{t()},[n]),e.jsxs("div",{className:"videoSection2 bg-light container-fluid py-5   ",children:[e.jsx("div",{className:"videoTitle m-3 m-lg-5 ",children:e.jsx("h2",{children:"Others recipes you may like"})}),e.jsx("div",{className:"videos-container2 m-lg-5",id:"videos-container",children:h.map(c=>e.jsx($,{title:c.title,img:c.image,id:c.id,author:c.auteur,note:c.note},c.id))})]})}function J({user:n,userRole:r}){const[l]=F(),[a,i]=o.useState(!0),[h,p]=o.useState(0),t=y(u=>u.recipeID),c=y(u=>u.setRecipeID),[s,d]=o.useState(null),[x,v]=o.useState(null),b=D();o.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"}),c(l.get("id")||t)},[b.state]);async function f(){try{const{data:u}=await g.post("https://corentinchan.de/setRecipeID",{recipeID:t},{headers:{"Content-Type":"application/json"},withCredentials:!0});t===null&&c(u.recipeID)}catch(u){console.error("error axios :",u)}}return o.useEffect(()=>{f()},[t]),o.useEffect(()=>{f()},[]),o.useEffect(()=>{console.log("Meal updated:",s)},[s]),e.jsxs(e.Fragment,{children:[e.jsxs("main",{children:[e.jsxs("title",{children:["Recipe ",s?.title||"Recipe"," | App Recipe"]}),e.jsx("meta",{name:"description",content:s?.description?.trim()||`Detailed recipe of ${s?.title||"Recipe"} on App Recipe.`}),e.jsx("meta",{name:"keywords",content:`${s?.title||""}, recipe, cooking, ${s?.category||""}`}),s?.image&&e.jsxs(e.Fragment,{children:[e.jsx("meta",{property:"og:image",content:s.image}),e.jsx("meta",{property:"og:image:alt",content:`Photo of ${s.title}`}),e.jsx("meta",{property:"og:image:type",content:"image/jpeg"}),e.jsx("meta",{property:"og:image:width",content:"1200"}),e.jsx("meta",{property:"og:image:height",content:"630"})]}),e.jsx("meta",{property:"og:title",content:`Detailed recipe: ${s?.title||""}`}),e.jsx("meta",{property:"og:description",content:s?.description?.trim()||`Recipe: ${s?.title||""}`}),e.jsx("meta",{property:"og:type",content:"article"}),e.jsx("meta",{property:"og:url",content:window.location.href}),e.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org/","@type":"Recipe",name:s?.title||"Recipe",image:s?.image?[s.image]:void 0,description:s?.description?.trim()||`Recipe: ${s?.title||"Recipe"}`,datePublished:s?.date,author:{"@type":"Person",name:s?.auteur||"Unknown"},recipeCategory:s?.categoryID?`Category ${s.categoryID}`:void 0,totalTime:s?.totalTime?`${s.totalTime} minutes`:void 0,prepTime:s?.activeTime?`${s.activeTime} minutes`:void 0,recipeYield:s?.yield||void 0,aggregateRating:s?.note?{"@type":"AggregateRating",ratingValue:s.note,reviewCount:1}:void 0})})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(A,{recipeID:t,userRole:r,udpateForm:h,meal:s,setMeal:d}),e.jsxs("div",{className:"m-1 p-1 m-lg-5 p-lg-3 makeRecipe-container",children:[e.jsxs("div",{className:"  recipeLeft",children:[e.jsx(M,{recipeID:t}),e.jsx(P,{recipeID:t,udpateForm:h,userRole:r}),n&&e.jsx(V,{recipeID:t,udpateForm:h,setUpdateForm:p})]}),e.jsxs("div",{className:"recipeRight",children:[e.jsx(z,{recipeID:t}),e.jsx(B,{recipeID:t}),e.jsx(G,{recipeID:t,meal:s})]})]}),e.jsx(W,{recipeID:t})]})]})}export{J as default};
